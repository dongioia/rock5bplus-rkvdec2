From mboxrd@z Thu Jan  1 00:00:00 1970
Received: from mx0a-0031df01.pphosted.com (mx0a-0031df01.pphosted.com [205.220.168.131])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by smtp.subspace.kernel.org (Postfix) with ESMTPS id CE8F02E2821
	for <linux-sunxi@lists.linux.dev>; Sat, 16 Aug 2025 12:41:14 +0000 (UTC)
Authentication-Results: smtp.subspace.kernel.org; arc=none smtp.client-ip=205.220.168.131
ARC-Seal: i=1; a=rsa-sha256; d=subspace.kernel.org; s=arc-20240116;
	t=1755348076; cv=none; b=uQXobFJND09gExwVmEd0B2XwEDiCW171qcWr0VXJBVXEXbRDi1HfOG+WK16CofM74Pwyn4ibxT9uR3bblNiEaEsWMfiCxhrWSko2gzQLExhVKT8bEoBF521u7OUUadlIguLaZbZ+CEPqrL6jh7kG+2duYK7QhZgj0NFGSCmFUPk=
ARC-Message-Signature: i=1; a=rsa-sha256; d=subspace.kernel.org;
	s=arc-20240116; t=1755348076; c=relaxed/simple;
	bh=DmbRKJHk5oRAB/lPzIwmmFkOQ5dwAtGETzJHeLHHKjI=;
	h=From:Date:Subject:MIME-Version:Content-Type:Message-Id:References:
	 In-Reply-To:To:Cc; b=pmaxCXV9yugoib5HjDKSPRTZHTIvDNDcQjtGAvJ6iJe4l9hR6VisbWd8Ovn39airZ4H8kMUuj8yjSkGH3fYs83Li59O0p0h/zyszAfDvwFQ9qhRLKlqHqYIMP3aqKuyzUkYekx3HI2UxGFFyjT4yPHMkGt8s/h1I/mlbmYStj3E=
ARC-Authentication-Results: i=1; smtp.subspace.kernel.org; dmarc=pass (p=reject dis=none) header.from=oss.qualcomm.com; spf=pass smtp.mailfrom=oss.qualcomm.com; dkim=pass (2048-bit key) header.d=qualcomm.com header.i=@qualcomm.com header.b=XmaFgEny; arc=none smtp.client-ip=205.220.168.131
Authentication-Results: smtp.subspace.kernel.org; dmarc=pass (p=reject dis=none) header.from=oss.qualcomm.com
Authentication-Results: smtp.subspace.kernel.org; spf=pass smtp.mailfrom=oss.qualcomm.com
Authentication-Results: smtp.subspace.kernel.org;
	dkim=pass (2048-bit key) header.d=qualcomm.com header.i=@qualcomm.com header.b="XmaFgEny"
Received: from pps.filterd (m0279863.ppops.net [127.0.0.1])
	by mx0a-0031df01.pphosted.com (8.18.1.2/8.18.1.2) with ESMTP id 57G3ZTY3006416
	for <linux-sunxi@lists.linux.dev>; Sat, 16 Aug 2025 12:41:14 GMT
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=qualcomm.com; h=
	cc:content-transfer-encoding:content-type:date:from:in-reply-to
	:message-id:mime-version:references:subject:to; s=qcppdkim1; bh=
	g+DN1RQ5iWFy37PJYH5vMr1yt3EhNBuEfrKEgtBjJ44=; b=XmaFgEnygI3wpB6k
	X8YbBP1SJiQ/xkDQkntP14wZ+7biVKQCkNA8IH0We4vdv2/GfwwPzIpsz6fz6ETB
	+O03PMpJ1aMKPGxyCwCW0rd2V5VSoh0mwxrMU3Es4j/hVkSdmoA6JKzq5akntWR0
	OHQUWL6c6JJDrO0EpkdWcViUAgSfX8seGvV9ymg6B0IsCAPDZPMS8/HMkeIxX4zE
	B/LUL6hW/Axr6Dpc6aVb82/4eDVSEICbiyQYqXw6l1H357E/zV6Z4kX+sCeDg98i
	NNSLf1TCdsLsPVHC0lBmMHrHgpSt0GZFhsy7Ingh/1DSQ2zj/TkAHK5Cp6cwyhbU
	8sgcpg==
Received: from mail-qv1-f70.google.com (mail-qv1-f70.google.com [209.85.219.70])
	by mx0a-0031df01.pphosted.com (PPS) with ESMTPS id 48jj740ma2-1
	(version=TLSv1.2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128 verify=NOT)
	for <linux-sunxi@lists.linux.dev>; Sat, 16 Aug 2025 12:41:14 +0000 (GMT)
Received: by mail-qv1-f70.google.com with SMTP id 6a1803df08f44-70a9f55eb56so62135896d6.2
        for <linux-sunxi@lists.linux.dev>; Sat, 16 Aug 2025 05:41:13 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20230601; t=1755348073; x=1755952873;
        h=cc:to:in-reply-to:references:message-id:content-transfer-encoding
         :mime-version:subject:date:from:x-gm-message-state:from:to:cc
         :subject:date:message-id:reply-to;
        bh=g+DN1RQ5iWFy37PJYH5vMr1yt3EhNBuEfrKEgtBjJ44=;
        b=STLfvTtNkW6fQM+cOmY9X4+u5qEjrMrXQRl9iLKnaJCQ/M+OAmoGsiLdAmmlddmyPd
         xfWkQcG9ySOKHM3jQ+OplQ9nZaehrUVzttjMecWbCjHciuTp5JCsISMli/rPj81ezioH
         VNOArpoqCjOnQni2kGqSE/RhtQJ7LdEWf8gchBAKqZqDAw+BkFvdKgOobCbRPL7NqYGO
         PM/d4sUILrXE8iiotvGO3xcLfvSZt6uxqPZS33oDUb1wpdBTYA+ohko8kk/KEGhaZh6a
         OLeaC6UPo7IfHNI+6eRgVZg5AGwyojgmlVMYq9vnJRj9xdEGj7YIzL501lPgT/Y7VE2S
         o/7g==
X-Forwarded-Encrypted: i=1; AJvYcCV8ZlcOFv2KjEaqkL33LFa1wBqpNle2NXKwNhFRtR9WEmDOYAzjA6kTrUqDECUe+jxNxDLYe5IdexnObA==@lists.linux.dev
X-Gm-Message-State: AOJu0Yx+V80dALSsRbuoW2bkk0D4ftdWNicmVyRJ4NxfrIpIMcP2VxBd
	4Y8NsAa1Wd+FI6u46sr3YdRHnuC0dv7asBr5+toNXkZbMOGTBtHgOlab9biwtTkrDwTyI9++L59
	Y3bpkRyMpyyufr4iNHlR3hfCxKBhmUOzwsV8toliVQxnHl54MD7k9KiMitu8dgyYmFA==
X-Gm-Gg: ASbGnctam5fdaCOH3bl0lCRtCJmjPNEz3wq9iHsFfGQd87RXtR08r375D7CnurBNLsM
	Q6s1C49Bb4Alnemmaoyhfo9POHjP5YDvoMTcF4FY9d4erzwX0tjeQJzVXiOpm8X+lxPif/VmbTW
	IZuDBeo521MJt4mfNxztio1IlgZ1YbjsAQ2Pl9XJBFdGs36dchH8gq2+Mp/UE3ICiBDHhsB0dFZ
	I/rm+BPF8JqdPw09qhg0+hGyOEPHD1xNfb+vBKO4pi8m07uDXaG3kuGbho98iSvfVSPelvQb46m
	nOWoJS26kIYthHT6EoJDE6711/49JyrgOx8fOjAtId+ZI6T0zxM8WwMs7EyQL8joiajkz3lFVAa
	5gcNGvG/h6GZvzMTYXw1T926+bKybvtdHFnI01o9VIemouLG1DwZx
X-Received: by 2002:ad4:5945:0:b0:707:77be:fc76 with SMTP id 6a1803df08f44-70ba7cae369mr76312246d6.51.1755348072689;
        Sat, 16 Aug 2025 05:41:12 -0700 (PDT)
X-Google-Smtp-Source: AGHT+IFAdZSpkUqvcLouYBz/hMv6ITX2aCNjDHlkgL/LzL/FzF+yIDQWC2R9yzAGQtiDF+Yu7M/Svg==
X-Received: by 2002:ad4:5945:0:b0:707:77be:fc76 with SMTP id 6a1803df08f44-70ba7cae369mr76311876d6.51.1755348072153;
        Sat, 16 Aug 2025 05:41:12 -0700 (PDT)
Received: from umbar.lan (2001-14ba-a0c3-3a00-264b-feff-fe8b-be8a.rev.dnainternet.fi. [2001:14ba:a0c3:3a00:264b:feff:fe8b:be8a])
        by smtp.gmail.com with ESMTPSA id 2adb3069b0e04-55cef3cca21sm856554e87.104.2025.08.16.05.41.08
        (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
        Sat, 16 Aug 2025 05:41:09 -0700 (PDT)
From: Dmitry Baryshkov <dmitry.baryshkov@oss.qualcomm.com>
Date: Sat, 16 Aug 2025 15:41:03 +0300
Subject: [PATCH 3/7] drm/bridge: ite-it6232: declare supported infoframes
Precedence: bulk
X-Mailing-List: linux-sunxi@lists.linux.dev
List-Id: <linux-sunxi.lists.linux.dev>
List-Subscribe: <mailto:linux-sunxi+subscribe@lists.linux.dev>
List-Unsubscribe: <mailto:linux-sunxi+unsubscribe@lists.linux.dev>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: 7bit
Message-Id: <20250816-drm-limit-infoframes-v1-3-6dc17d5f07e9@oss.qualcomm.com>
References: <20250816-drm-limit-infoframes-v1-0-6dc17d5f07e9@oss.qualcomm.com>
In-Reply-To: <20250816-drm-limit-infoframes-v1-0-6dc17d5f07e9@oss.qualcomm.com>
To: Andrzej Hajda <andrzej.hajda@intel.com>,
        Neil Armstrong <neil.armstrong@linaro.org>,
        Robert Foss <rfoss@kernel.org>,
        Laurent Pinchart <Laurent.pinchart@ideasonboard.com>,
        Jonas Karlman <jonas@kwiboo.se>,
        Jernej Skrabec <jernej.skrabec@gmail.com>,
        Maarten Lankhorst <maarten.lankhorst@linux.intel.com>,
        Maxime Ripard <mripard@kernel.org>,
        Thomas Zimmermann <tzimmermann@suse.de>,
        David Airlie <airlied@gmail.com>, Simona Vetter <simona@ffwll.ch>,
        Sandy Huang <hjc@rock-chips.com>,
        =?utf-8?q?Heiko_St=C3=BCbner?= <heiko@sntech.de>,
        Andy Yan <andy.yan@rock-chips.com>, Chen-Yu Tsai <wens@csie.org>,
        Samuel Holland <samuel@sholland.org>,
        Dave Stevenson <dave.stevenson@raspberrypi.com>,
        =?utf-8?q?Ma=C3=ADra_Canal?= <mcanal@igalia.com>,
        Raspberry Pi Kernel Maintenance <kernel-list@raspberrypi.com>,
        Liu Ying <victor.liu@nxp.com>,
        Rob Clark <robin.clark@oss.qualcomm.com>,
        Dmitry Baryshkov <lumag@kernel.org>,
        Abhinav Kumar <abhinav.kumar@linux.dev>,
        Jessica Zhang <jessica.zhang@oss.qualcomm.com>,
        Sean Paul <sean@poorly.run>,
        Marijn Suijten <marijn.suijten@somainline.org>
Cc: dri-devel@lists.freedesktop.org, linux-kernel@vger.kernel.org,
        linux-arm-kernel@lists.infradead.org,
        linux-rockchip@lists.infradead.org, linux-sunxi@lists.linux.dev,
        linux-arm-msm@vger.kernel.org, freedreno@lists.freedesktop.org
X-Mailer: b4 0.14.2
X-Developer-Signature: v=1; a=openpgp-sha256; l=830;
 i=dmitry.baryshkov@oss.qualcomm.com; h=from:subject:message-id;
 bh=DmbRKJHk5oRAB/lPzIwmmFkOQ5dwAtGETzJHeLHHKjI=;
 b=owEBbQGS/pANAwAKAYs8ij4CKSjVAcsmYgBooHxfulVQQEIFrGQv7TVF5i0bGwohs7DjMO5Bi
 27ClR21i3OJATMEAAEKAB0WIQRMcISVXLJjVvC4lX+LPIo+Aiko1QUCaKB8XwAKCRCLPIo+Aiko
 1XCZB/4qvtEP/SQNDva3+3vq4krCw9kSzxLGdjGdVw/tgMeW5/3T6SWI0ZXg5Kzt/5ni4P7yvSm
 EDPaT/urG5eS2xX8/WOivyKKxBeSYQv3VWhHqlDBqoOQJW5OkQLPfMBQbHZtIgKoQ7aJCHwTn9d
 HWLCGARgFjYGvtmShrBjydeV4yWinl2EO2WNM0jpELO52mnDHDl/KzegdqSjmhF3DRoNQy600wy
 5K0K6W6ZUvgE865jSkXskg/ayPbsbVVzkYfiqktz3u+K+JXAD4Xf46u7sWS0OI7QNuwI3m5tySd
 nDDSA+Hy4cpHKnNMgVm/ZTHa+IeV4jqqUxQWFvasdgj3YQju
X-Developer-Key: i=dmitry.baryshkov@oss.qualcomm.com; a=openpgp;
 fpr=8F88381DD5C873E4AE487DA5199BF1243632046A
X-Proofpoint-GUID: eApQdr78U02qCyF31C-OZN9per3YoMz4
X-Proofpoint-ORIG-GUID: eApQdr78U02qCyF31C-OZN9per3YoMz4
X-Proofpoint-Spam-Details-Enc: AW1haW4tMjUwODE2MDAzMyBTYWx0ZWRfX5pg+rW/uA4FZ
 A4lFo36tqEEA7ulsYnDP5wJy6o8V+MK/ugFDeQ9Z6ijXZvUOE7RGzc/+88mOqPxgOVaf+X+jH/y
 Wvj1GYr1UvzmsMQewj+zygv7TQfr+xeNdFShVBzRRJf6JF/GSF499kRpgt9Yi7P7/h2bE54/JsC
 cL/xCqRpy7AyNNhAUFqKVseUhvuMz2A83li3+dMN+8vQ2pwfusU085Csh07MDU7zxUwc53W8iOH
 gA62LN/pJ/MpHzexbLAh8b6uZHQ6UxPHK9ssZYC2i4igqFuOnS4BbFOcpvwlUCPIVFiiEK1ag/A
 hYM9eT/mjIFCvwInqbcsD9M8pln2l3QtK626lAhPhX4BEKxrclvigejXm4tofXdiFRCCDcae6DQ
 sMDzHVaf
X-Authority-Analysis: v=2.4 cv=MJtgmNZl c=1 sm=1 tr=0 ts=68a07c6a cx=c_pps
 a=oc9J++0uMp73DTRD5QyR2A==:117 a=xqWC_Br6kY4A:10 a=IkcTkHD0fZMA:10
 a=2OwXVqhp2XgA:10 a=EUspDBNiAAAA:8 a=0nAs0j3DZZh6uBALfPUA:9 a=QEXdDO2ut3YA:10
 a=iYH6xdkBrDN1Jqds4HTS:22
X-Proofpoint-Virus-Version: vendor=baseguard
 engine=ICAP:2.0.293,Aquarius:18.0.1099,Hydra:6.1.9,FMLib:17.12.80.40
 definitions=2025-08-16_04,2025-08-14_01,2025-03-28_01
X-Proofpoint-Spam-Details: rule=outbound_notspam policy=outbound score=0
 malwarescore=0 spamscore=0 bulkscore=0 adultscore=0 suspectscore=0
 phishscore=0 clxscore=1015 impostorscore=0 priorityscore=1501
 classifier=typeunknown authscore=0 authtc= authcc= route=outbound adjust=0
 reason=mlx scancount=1 engine=8.19.0-2507300000 definitions=main-2508160033

Declare which infoframes are supported via the .hdmi_write_infoframe()
interface.

Signed-off-by: Dmitry Baryshkov <dmitry.baryshkov@oss.qualcomm.com>
---
 drivers/gpu/drm/bridge/ite-it6263.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/drivers/gpu/drm/bridge/ite-it6263.c b/drivers/gpu/drm/bridge/ite-it6263.c
index cf813672b4ffb8ab5c524c6414ee7b414cebc018..b1956891a8388401c13cd2fc5c78f0779063adf4 100644
--- a/drivers/gpu/drm/bridge/ite-it6263.c
+++ b/drivers/gpu/drm/bridge/ite-it6263.c
@@ -875,6 +875,7 @@ static int it6263_probe(struct i2c_client *client)
 	it->bridge.type = DRM_MODE_CONNECTOR_HDMIA;
 	it->bridge.vendor = "ITE";
 	it->bridge.product = "IT6263";
+	it->bridge.supported_infoframes = DRM_CONNECTOR_INFOFRAME_AVI;
 
 	return devm_drm_bridge_add(dev, &it->bridge);
 }

-- 
2.47.2


From mboxrd@z Thu Jan  1 00:00:00 1970
Received: from mx0a-0031df01.pphosted.com (mx0a-0031df01.pphosted.com [205.220.168.131])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by smtp.subspace.kernel.org (Postfix) with ESMTPS id 756FB2E4252
	for <linux-sunxi@lists.linux.dev>; Sat, 16 Aug 2025 12:41:17 +0000 (UTC)
Authentication-Results: smtp.subspace.kernel.org; arc=none smtp.client-ip=205.220.168.131
ARC-Seal: i=1; a=rsa-sha256; d=subspace.kernel.org; s=arc-20240116;
	t=1755348080; cv=none; b=C94D+Q2hf1x19I72NLQ4TeCtIkhTUb6q432gOeI7xL78nVgVDjoxG4Lr4qiKMXZHM0Wy3wKsRu457EPyMqPmMAwQrkcU3S01TXsTfuYGHjqU4GbC2s14jNl2UfiXCniNa7fietMq/iIfSIzJpuEOtOJEE3BkXi2mmLrlVD6JA6E=
ARC-Message-Signature: i=1; a=rsa-sha256; d=subspace.kernel.org;
	s=arc-20240116; t=1755348080; c=relaxed/simple;
	bh=M1Oso041hLRSQwTPqGh7bGs7LIRCGyRBW2ycbXLCh80=;
	h=From:Date:Subject:MIME-Version:Content-Type:Message-Id:References:
	 In-Reply-To:To:Cc; b=afI2GFtyngF5WtM0oyxnSwzLjmSRMFIzS9uupDhOxLc9HJKy//KrXxxMX0ZwWLjnE6qY6Nu523cIjFjjmYXLgwjRGOzJVdndpOxLPspQBFkLLAXpZ52Mo40w6VGJRtfhhv8KiWHOV3fqrfjOoEiY+Yj3PR6Bnh3+ztMULO6Vf8I=
ARC-Authentication-Results: i=1; smtp.subspace.kernel.org; dmarc=pass (p=reject dis=none) header.from=oss.qualcomm.com; spf=pass smtp.mailfrom=oss.qualcomm.com; dkim=pass (2048-bit key) header.d=qualcomm.com header.i=@qualcomm.com header.b=XRmYW1zH; arc=none smtp.client-ip=205.220.168.131
Authentication-Results: smtp.subspace.kernel.org; dmarc=pass (p=reject dis=none) header.from=oss.qualcomm.com
Authentication-Results: smtp.subspace.kernel.org; spf=pass smtp.mailfrom=oss.qualcomm.com
Authentication-Results: smtp.subspace.kernel.org;
	dkim=pass (2048-bit key) header.d=qualcomm.com header.i=@qualcomm.com header.b="XRmYW1zH"
Received: from pps.filterd (m0279864.ppops.net [127.0.0.1])
	by mx0a-0031df01.pphosted.com (8.18.1.2/8.18.1.2) with ESMTP id 57G6oN57031805
	for <linux-sunxi@lists.linux.dev>; Sat, 16 Aug 2025 12:41:11 GMT
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=qualcomm.com; h=
	cc:content-transfer-encoding:content-type:date:from:in-reply-to
	:message-id:mime-version:references:subject:to; s=qcppdkim1; bh=
	1gFPmXWSueTddtYIhYSEFEG9PUYrsVzLpIWEMClRrIQ=; b=XRmYW1zHg1AqO3JF
	5zv7HsUkJYGje5OX+OvGtE8R1KEux3YoFGw7ZM9ArrvStCVYHrdlE1M0yycMhMnD
	vidsYzcNcLSVc3zwnvq6p2/Cy1+n9hb3QQoQv6VBOR4rMh60IDKZcYtV0dX0avfv
	/7y5jO/9/U1knExd/nWKdBJW/bj5d2xM9KPyxWQDYNlpFCS5Dicag2t6Tlmafkr/
	01IfmGp7QtLl3te29EpcoCV+XoNwiSH/7smvC6WGTUjIMeq1GBiW6i7HvP6JOUNM
	EIdVyJeh3MxghZuO1duxUr5Pi8DA6cvQRi9gce1mP9B0mr0ubVE5rG41/zTcMnym
	jVe7WQ==
Received: from mail-qt1-f199.google.com (mail-qt1-f199.google.com [209.85.160.199])
	by mx0a-0031df01.pphosted.com (PPS) with ESMTPS id 48jk5m8hw1-1
	(version=TLSv1.2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128 verify=NOT)
	for <linux-sunxi@lists.linux.dev>; Sat, 16 Aug 2025 12:41:10 +0000 (GMT)
Received: by mail-qt1-f199.google.com with SMTP id d75a77b69052e-4b109a92dddso79816071cf.1
        for <linux-sunxi@lists.linux.dev>; Sat, 16 Aug 2025 05:41:10 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20230601; t=1755348068; x=1755952868;
        h=cc:to:in-reply-to:references:message-id:content-transfer-encoding
         :mime-version:subject:date:from:x-gm-message-state:from:to:cc
         :subject:date:message-id:reply-to;
        bh=1gFPmXWSueTddtYIhYSEFEG9PUYrsVzLpIWEMClRrIQ=;
        b=lC11AWrJPjPWSwgsVuQRuhEeIVkhBWtJjWSTgTcpB0T0qaj0mYoaGndRINbh5oPoHV
         HzYdMKZpGZpOoKcFwH30UVR5N7G9XT2W01SPP9+EBDBh7Ubt4RS0lcNsfTqEWy9Tf+9G
         cRt7YK/pSNTxjjv7sCkQjeTbnJQPgRgheL1v+BTcZB40JvTXIE9lOyL6y892cQK4ChBS
         et90v4n1mbAFRkPY+Rx5c/GowpQaLegv/QyfCHFM5OgSa1UliM5M18lht6Cat6QmgWcU
         YtZbC6ldD4QlqSwBCC38q4jNsUe6iBYkcMm3RQPijFIftCnckSDvr7rKr356RkAxA4CB
         vvNA==
X-Forwarded-Encrypted: i=1; AJvYcCXAQDMg1sPzwbPhQwEeyL0IcWhZhnfAorneT3gC5HNc60n32zWQZWGvI1a8eFy/hTnw/4JyiLf41V0XSw==@lists.linux.dev
X-Gm-Message-State: AOJu0YxvZMZmRfUoidITPvQ3CK3uAfmeCeN3X1AUmAPDdGZnALdDAOIF
	OdiSgUQi/T/CwBVsIsXf/eqoU71xXSI9YOGV2BuZxjlVa/fD0yC+cK4hiy82EWXKZsC6INeJBTg
	+Zfc1P29WLJ3dSjUPJx1mvcT+ECTeU3Z5PERIXK7I/bLlDJoDNTm4goUWYeT3pM8GfA==
X-Gm-Gg: ASbGncuMqlDcC5rEzNtkiD1K2zdXoIrkIlwtVakH6fa80BKVzlYDQ2ZJ5pzUuOaYddz
	o41Pk2udykTr94TpcgukK0wca1KATVoq2Ec1mazLZZ8LzDfMcWyPLBYU68G0iOX4+Dfe/CaPmrY
	OIPLCywFFFurjtT4iA6SvO9EznG1wESmriIJkQjhnTrJDb+lsOwVwTClKSA5480iUspY1LNqbUO
	KbHGs21BG400vriCle+WYhNhA0BLVMxCNKYzZCoGehu6XFpppXaFNLEjJ5+DM9s1YYGjAujRFpP
	AsJDljclh+g76nBNnsr+DEWSpY3DUkGFaLBIsXA3ajlvRyXmTiy44CvNK3Hn2EeNjZCxEPqozBT
	Oatr9F6lRqh0hdWYP3driRYiQz5mvc/YeQgjYUl+0FVuRyOGLqURY
X-Received: by 2002:a05:622a:2ca:b0:4b0:81d0:c119 with SMTP id d75a77b69052e-4b11e27e77fmr80636271cf.38.1755348067887;
        Sat, 16 Aug 2025 05:41:07 -0700 (PDT)
X-Google-Smtp-Source: AGHT+IGdqT8OUvSv7EHxhPLdcfSwidIxeo8nxtBOuDhQpm2piGYWb8xjZTqJkxgnLrCNt8at0b8r9A==
X-Received: by 2002:a05:622a:2ca:b0:4b0:81d0:c119 with SMTP id d75a77b69052e-4b11e27e77fmr80635701cf.38.1755348067323;
        Sat, 16 Aug 2025 05:41:07 -0700 (PDT)
Received: from umbar.lan (2001-14ba-a0c3-3a00-264b-feff-fe8b-be8a.rev.dnainternet.fi. [2001:14ba:a0c3:3a00:264b:feff:fe8b:be8a])
        by smtp.gmail.com with ESMTPSA id 2adb3069b0e04-55cef3cca21sm856554e87.104.2025.08.16.05.41.05
        (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
        Sat, 16 Aug 2025 05:41:06 -0700 (PDT)
From: Dmitry Baryshkov <dmitry.baryshkov@oss.qualcomm.com>
Date: Sat, 16 Aug 2025 15:41:01 +0300
Subject: [PATCH 1/7] drm/connector: let drivers declare infoframes as
 unsupported
Precedence: bulk
X-Mailing-List: linux-sunxi@lists.linux.dev
List-Id: <linux-sunxi.lists.linux.dev>
List-Subscribe: <mailto:linux-sunxi+subscribe@lists.linux.dev>
List-Unsubscribe: <mailto:linux-sunxi+unsubscribe@lists.linux.dev>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: 7bit
Message-Id: <20250816-drm-limit-infoframes-v1-1-6dc17d5f07e9@oss.qualcomm.com>
References: <20250816-drm-limit-infoframes-v1-0-6dc17d5f07e9@oss.qualcomm.com>
In-Reply-To: <20250816-drm-limit-infoframes-v1-0-6dc17d5f07e9@oss.qualcomm.com>
To: Andrzej Hajda <andrzej.hajda@intel.com>,
        Neil Armstrong <neil.armstrong@linaro.org>,
        Robert Foss <rfoss@kernel.org>,
        Laurent Pinchart <Laurent.pinchart@ideasonboard.com>,
        Jonas Karlman <jonas@kwiboo.se>,
        Jernej Skrabec <jernej.skrabec@gmail.com>,
        Maarten Lankhorst <maarten.lankhorst@linux.intel.com>,
        Maxime Ripard <mripard@kernel.org>,
        Thomas Zimmermann <tzimmermann@suse.de>,
        David Airlie <airlied@gmail.com>, Simona Vetter <simona@ffwll.ch>,
        Sandy Huang <hjc@rock-chips.com>,
        =?utf-8?q?Heiko_St=C3=BCbner?= <heiko@sntech.de>,
        Andy Yan <andy.yan@rock-chips.com>, Chen-Yu Tsai <wens@csie.org>,
        Samuel Holland <samuel@sholland.org>,
        Dave Stevenson <dave.stevenson@raspberrypi.com>,
        =?utf-8?q?Ma=C3=ADra_Canal?= <mcanal@igalia.com>,
        Raspberry Pi Kernel Maintenance <kernel-list@raspberrypi.com>,
        Liu Ying <victor.liu@nxp.com>,
        Rob Clark <robin.clark@oss.qualcomm.com>,
        Dmitry Baryshkov <lumag@kernel.org>,
        Abhinav Kumar <abhinav.kumar@linux.dev>,
        Jessica Zhang <jessica.zhang@oss.qualcomm.com>,
        Sean Paul <sean@poorly.run>,
        Marijn Suijten <marijn.suijten@somainline.org>
Cc: dri-devel@lists.freedesktop.org, linux-kernel@vger.kernel.org,
        linux-arm-kernel@lists.infradead.org,
        linux-rockchip@lists.infradead.org, linux-sunxi@lists.linux.dev,
        linux-arm-msm@vger.kernel.org, freedreno@lists.freedesktop.org
X-Mailer: b4 0.14.2
X-Developer-Signature: v=1; a=openpgp-sha256; l=21968;
 i=dmitry.baryshkov@oss.qualcomm.com; h=from:subject:message-id;
 bh=M1Oso041hLRSQwTPqGh7bGs7LIRCGyRBW2ycbXLCh80=;
 b=owEBbQGS/pANAwAKAYs8ij4CKSjVAcsmYgBooHxfwp6a3pEb0+ur/XQsVy2kQiBGKJidUiZI4
 YmWNB1OBF2JATMEAAEKAB0WIQRMcISVXLJjVvC4lX+LPIo+Aiko1QUCaKB8XwAKCRCLPIo+Aiko
 1bbHB/4vtifsBWS6FvOBbT1buEUUwO/uk1NzNNanoWsWIDISOpScdFUImer587CFn/xa/faMBH+
 Z60/MZZCbwP9wwG3M7m1qfgDNy3F2xGocM5RhEv/qGpSGKSSGhcP/sime6V2LBvl44GSI1wH57q
 muBeClvuONXT5mSehLxUGZhojD4ElmSbUYt7PQ+6z8vsTmwF01lE7wumgd+z25NP6VwYGdw8g9r
 gnNCchCR+Zq0G16145tSzg8eHVVY+XPlsybTL6/J7LRJepli1qpdl6aGJxxdfe4AfDyHKK3QE/M
 C/sBJHJQLhhWOgcVZmiaWWpppEYmYZCEmxjQd3cpvUg5H/7E
X-Developer-Key: i=dmitry.baryshkov@oss.qualcomm.com; a=openpgp;
 fpr=8F88381DD5C873E4AE487DA5199BF1243632046A
X-Authority-Analysis: v=2.4 cv=Sdn3duRu c=1 sm=1 tr=0 ts=68a07c67 cx=c_pps
 a=WeENfcodrlLV9YRTxbY/uA==:117 a=xqWC_Br6kY4A:10 a=IkcTkHD0fZMA:10
 a=2OwXVqhp2XgA:10 a=EUspDBNiAAAA:8 a=EjBJG3Ffxhrz6juHXs8A:9 a=QEXdDO2ut3YA:10
 a=kacYvNCVWA4VmyqE58fU:22
X-Proofpoint-ORIG-GUID: Gly38cs3n_6udcd_tVTcD_kXqrNRVTxf
X-Proofpoint-GUID: Gly38cs3n_6udcd_tVTcD_kXqrNRVTxf
X-Proofpoint-Spam-Details-Enc: AW1haW4tMjUwODE2MDA0MiBTYWx0ZWRfXz0UvKkgcXVwf
 hbaMztzqeqrBi4vdt2evN5W9ZzfIt7JZ98bCMPSpMJAXC/r1Ppk3Ggei/5NVH+HIRU9zciwN/po
 twDx+15N39t4oxZNn89ED00DHWLb8WTKnpDfYHkNZAR8vSbnzFy5XrYa69mSglk8zj/veIp40rP
 SdJNsRRM/c79l1Q9y2JsQ0JbmFI0MFms6uvc2VcjiVvIDRSqc/UM8V4mbNUB+QoMGaBp0UO7OYL
 M47u62hEIDvwKAaXnpKkh9vS4FsS+pg/WPLJ3U0I97o/wphPLLTF+X4/A7c6LM+ZDAJLoquc8qL
 E7aUc3zdXBAYimbPktTOjv2SNg1dtOFUXJQzqrcHkwHNTyESewCemWIll+9UGGDT1LalvSpKlt+
 GiUoF2AL
X-Proofpoint-Virus-Version: vendor=baseguard
 engine=ICAP:2.0.293,Aquarius:18.0.1099,Hydra:6.1.9,FMLib:17.12.80.40
 definitions=2025-08-16_04,2025-08-14_01,2025-03-28_01
X-Proofpoint-Spam-Details: rule=outbound_notspam policy=outbound score=0
 impostorscore=0 clxscore=1015 suspectscore=0 priorityscore=1501 spamscore=0
 adultscore=0 malwarescore=0 bulkscore=0 phishscore=0 classifier=typeunknown
 authscore=0 authtc= authcc= route=outbound adjust=0 reason=mlx scancount=1
 engine=8.19.0-2507300000 definitions=main-2508160042

Currently DRM framework expects that the HDMI connector driver supports
all infoframe types: it generates the data as required and calls into
the driver to program all of them, letting the driver to soft-fail if
the infoframe is unsupported. This has a major drawback on userspace
API: the framework also registers debugfs files for all Infoframe types,
possibly surprising the users when infoframe is visible in the debugfs
file, but it is not visible on the wire.

Let drivers declare that they support only a subset of infoframes,
creating a more consistent interface.

Signed-off-by: Dmitry Baryshkov <dmitry.baryshkov@oss.qualcomm.com>
---
 drivers/gpu/drm/display/drm_bridge_connector.c     |  6 +++
 drivers/gpu/drm/display/drm_hdmi_state_helper.c    | 43 +++++++++++++++++++++-
 drivers/gpu/drm/drm_connector.c                    |  4 ++
 drivers/gpu/drm/drm_debugfs.c                      | 16 +++++---
 drivers/gpu/drm/rockchip/inno_hdmi.c               |  1 +
 drivers/gpu/drm/sun4i/sun4i_hdmi_enc.c             |  1 +
 drivers/gpu/drm/tests/drm_connector_test.c         | 28 ++++++++++++++
 drivers/gpu/drm/tests/drm_hdmi_state_helper_test.c |  8 ++++
 drivers/gpu/drm/vc4/vc4_hdmi.c                     |  4 ++
 include/drm/drm_bridge.h                           |  7 ++++
 include/drm/drm_connector.h                        | 23 ++++++++++++
 11 files changed, 134 insertions(+), 7 deletions(-)

diff --git a/drivers/gpu/drm/display/drm_bridge_connector.c b/drivers/gpu/drm/display/drm_bridge_connector.c
index 8c915427d0538435661d771940efe38b462027a1..b94458d5faa9ae283889fc79496ae323bb4dc88c 100644
--- a/drivers/gpu/drm/display/drm_bridge_connector.c
+++ b/drivers/gpu/drm/display/drm_bridge_connector.c
@@ -781,6 +781,12 @@ struct drm_connector *drm_bridge_connector_init(struct drm_device *drm,
 					       &drm_bridge_connector_hdmi_funcs,
 					       connector_type, ddc,
 					       supported_formats,
+					       bridge->supported_infoframes ? :
+					       DRM_CONNECTOR_INFOFRAME_AUDIO |
+					       DRM_CONNECTOR_INFOFRAME_AVI |
+					       DRM_CONNECTOR_INFOFRAME_DRM |
+					       DRM_CONNECTOR_INFOFRAME_SPD |
+					       DRM_CONNECTOR_INFOFRAME_VENDOR,
 					       max_bpc);
 		if (ret)
 			return ERR_PTR(ret);
diff --git a/drivers/gpu/drm/display/drm_hdmi_state_helper.c b/drivers/gpu/drm/display/drm_hdmi_state_helper.c
index a561f124be99a0cd4259dbacf5f5f6651ff8a0ea..fb8b9e3769cb74345f9c6ef6f6ca441a373141c1 100644
--- a/drivers/gpu/drm/display/drm_hdmi_state_helper.c
+++ b/drivers/gpu/drm/display/drm_hdmi_state_helper.c
@@ -687,6 +687,10 @@ static int hdmi_generate_avi_infoframe(const struct drm_connector *connector,
 
 	infoframe->set = false;
 
+	if (!drm_hdmi_connector_supports_infoframe(connector,
+						   HDMI_INFOFRAME_TYPE_AVI))
+		return 0;
+
 	ret = drm_hdmi_avi_infoframe_from_display_mode(frame, connector, mode);
 	if (ret)
 		return ret;
@@ -718,6 +722,10 @@ static int hdmi_generate_spd_infoframe(const struct drm_connector *connector,
 
 	infoframe->set = false;
 
+	if (!drm_hdmi_connector_supports_infoframe(connector,
+						   HDMI_INFOFRAME_TYPE_SPD))
+		return 0;
+
 	ret = hdmi_spd_infoframe_init(frame,
 				      connector->hdmi.vendor,
 				      connector->hdmi.product);
@@ -742,6 +750,10 @@ static int hdmi_generate_hdr_infoframe(const struct drm_connector *connector,
 
 	infoframe->set = false;
 
+	if (!drm_hdmi_connector_supports_infoframe(connector,
+						   HDMI_INFOFRAME_TYPE_DRM))
+		return 0;
+
 	if (connector->max_bpc < 10)
 		return 0;
 
@@ -771,6 +783,10 @@ static int hdmi_generate_hdmi_vendor_infoframe(const struct drm_connector *conne
 
 	infoframe->set = false;
 
+	if (!drm_hdmi_connector_supports_infoframe(connector,
+						   HDMI_INFOFRAME_TYPE_VENDOR))
+		return 0;
+
 	if (!info->has_hdmi_infoframe)
 		return 0;
 
@@ -905,6 +921,11 @@ static int clear_device_infoframe(struct drm_connector *connector,
 		return 0;
 	}
 
+	if (!drm_hdmi_connector_supports_infoframe(connector, type)) {
+		drm_dbg_kms(dev, "Infoframe %d not supported, bailing.\n", type);
+		return 0;
+	}
+
 	ret = funcs->clear_infoframe(connector, type);
 	if (ret) {
 		drm_dbg_kms(dev, "Call failed: %d\n", ret);
@@ -932,21 +953,27 @@ static int write_device_infoframe(struct drm_connector *connector,
 	const struct drm_connector_hdmi_funcs *funcs = connector->hdmi.funcs;
 	struct drm_device *dev = connector->dev;
 	u8 buffer[HDMI_INFOFRAME_SIZE(MAX)];
+	enum hdmi_infoframe_type type = frame->any.type;
 	int ret;
 	int len;
 
-	drm_dbg_kms(dev, "Writing infoframe type %x\n", frame->any.type);
+	drm_dbg_kms(dev, "Writing infoframe type %x\n", type);
 
 	if (!funcs || !funcs->write_infoframe) {
 		drm_dbg_kms(dev, "Function not implemented, bailing.\n");
 		return -EINVAL;
 	}
 
+	if (!drm_hdmi_connector_supports_infoframe(connector, type)) {
+		drm_dbg_kms(dev, "Infoframe %d not supported, bailing.\n", type);
+		return 0;
+	}
+
 	len = hdmi_infoframe_pack(frame, buffer, sizeof(buffer));
 	if (len < 0)
 		return len;
 
-	ret = funcs->write_infoframe(connector, frame->any.type, buffer, len);
+	ret = funcs->write_infoframe(connector, type, buffer, len);
 	if (ret) {
 		drm_dbg_kms(dev, "Call failed: %d\n", ret);
 		return ret;
@@ -1067,6 +1094,12 @@ drm_atomic_helper_connector_hdmi_update_audio_infoframe(struct drm_connector *co
 	struct drm_display_info *info = &connector->display_info;
 	int ret;
 
+	if (!drm_hdmi_connector_supports_infoframe(connector,
+						   HDMI_INFOFRAME_TYPE_AUDIO)) {
+		drm_dbg_kms(connector->dev, "Audio Infoframe not supported, bailing.\n");
+		return -EOPNOTSUPP;
+	}
+
 	if (!info->is_hdmi)
 		return 0;
 
@@ -1102,6 +1135,12 @@ drm_atomic_helper_connector_hdmi_clear_audio_infoframe(struct drm_connector *con
 	struct drm_display_info *info = &connector->display_info;
 	int ret;
 
+	if (!drm_hdmi_connector_supports_infoframe(connector,
+						   HDMI_INFOFRAME_TYPE_AUDIO)) {
+		drm_dbg_kms(connector->dev, "Audio Infoframe not supported, bailing.\n");
+		return -EOPNOTSUPP;
+	}
+
 	if (!info->is_hdmi)
 		return 0;
 
diff --git a/drivers/gpu/drm/drm_connector.c b/drivers/gpu/drm/drm_connector.c
index 272d6254ea4784e97ca894ec4d463beebf9fdbf0..e753de9fc80a26c30b9674c96083328711f32960 100644
--- a/drivers/gpu/drm/drm_connector.c
+++ b/drivers/gpu/drm/drm_connector.c
@@ -553,6 +553,7 @@ EXPORT_SYMBOL(drmm_connector_init);
  * @connector_type: user visible type of the connector
  * @ddc: optional pointer to the associated ddc adapter
  * @supported_formats: Bitmask of @hdmi_colorspace listing supported output formats
+ * @supported_infoframes: Bitmask of @DRM_CONNECTOR_INFOFRAME listing supported Infoframes
  * @max_bpc: Maximum bits per char the HDMI connector supports
  *
  * Initialises a preallocated HDMI connector. Connectors can be
@@ -576,6 +577,7 @@ int drmm_connector_hdmi_init(struct drm_device *dev,
 			     int connector_type,
 			     struct i2c_adapter *ddc,
 			     unsigned long supported_formats,
+			     unsigned long supported_infoframes,
 			     unsigned int max_bpc)
 {
 	int ret;
@@ -623,6 +625,8 @@ int drmm_connector_hdmi_init(struct drm_device *dev,
 
 	connector->hdmi.funcs = hdmi_funcs;
 
+	connector->hdmi.supported_infoframes = supported_infoframes;
+
 	return 0;
 }
 EXPORT_SYMBOL(drmm_connector_hdmi_init);
diff --git a/drivers/gpu/drm/drm_debugfs.c b/drivers/gpu/drm/drm_debugfs.c
index 365cf337529fa2a88b69516d57360d212419c126..248cb9ea1d8781674160cd8d454113c9422ec691 100644
--- a/drivers/gpu/drm/drm_debugfs.c
+++ b/drivers/gpu/drm/drm_debugfs.c
@@ -672,6 +672,9 @@ static int create_hdmi_audio_infoframe_file(struct drm_connector *connector,
 {
 	struct dentry *file;
 
+	if (!drm_hdmi_connector_supports_infoframe(connector, HDMI_INFOFRAME_TYPE_AUDIO))
+		return 0;
+
 	file = debugfs_create_file("audio", 0400, parent, connector, &audio_infoframe_fops);
 	if (IS_ERR(file))
 		return PTR_ERR(file);
@@ -679,7 +682,7 @@ static int create_hdmi_audio_infoframe_file(struct drm_connector *connector,
 	return 0;
 }
 
-#define DEFINE_INFOFRAME_FILE(_f) \
+#define DEFINE_INFOFRAME_FILE(_f, _F) \
 static ssize_t _f##_read_infoframe(struct file *filp, \
 				   char __user *ubuf, \
 				   size_t count,      \
@@ -726,6 +729,9 @@ static int create_hdmi_## _f ## _infoframe_file(struct drm_connector *connector,
 { \
 	struct dentry *file; \
 	\
+	if (!drm_hdmi_connector_supports_infoframe(connector, HDMI_INFOFRAME_TYPE_ ## _F)) \
+		return 0; \
+	\
 	file = debugfs_create_file(#_f, 0400, parent, connector, &_f ## _infoframe_fops); \
 	if (IS_ERR(file)) \
 		return PTR_ERR(file); \
@@ -733,10 +739,10 @@ static int create_hdmi_## _f ## _infoframe_file(struct drm_connector *connector,
 	return 0; \
 }
 
-DEFINE_INFOFRAME_FILE(avi);
-DEFINE_INFOFRAME_FILE(hdmi);
-DEFINE_INFOFRAME_FILE(hdr_drm);
-DEFINE_INFOFRAME_FILE(spd);
+DEFINE_INFOFRAME_FILE(avi, AVI);
+DEFINE_INFOFRAME_FILE(hdmi, VENDOR);
+DEFINE_INFOFRAME_FILE(hdr_drm, DRM);
+DEFINE_INFOFRAME_FILE(spd, SPD);
 
 static int create_hdmi_infoframe_files(struct drm_connector *connector,
 				       struct dentry *parent)
diff --git a/drivers/gpu/drm/rockchip/inno_hdmi.c b/drivers/gpu/drm/rockchip/inno_hdmi.c
index 1ab3ad4bde9ea7305021186ea221d2ff9057fdbb..65eed5ae23194200c145cb174acff4f252b3ef1f 100644
--- a/drivers/gpu/drm/rockchip/inno_hdmi.c
+++ b/drivers/gpu/drm/rockchip/inno_hdmi.c
@@ -1065,6 +1065,7 @@ static int inno_hdmi_register(struct drm_device *drm, struct inno_hdmi *hdmi)
 				 DRM_MODE_CONNECTOR_HDMIA,
 				 hdmi->ddc,
 				 BIT(HDMI_COLORSPACE_RGB),
+				 DRM_CONNECTOR_INFOFRAME_AVI,
 				 8);
 
 	drm_connector_attach_encoder(&hdmi->connector, encoder);
diff --git a/drivers/gpu/drm/sun4i/sun4i_hdmi_enc.c b/drivers/gpu/drm/sun4i/sun4i_hdmi_enc.c
index ab0938ba61f7d75dd0bec473807a04a20e1cffbd..0b931da4ea2d4eb58a6224476059b9205e8626b4 100644
--- a/drivers/gpu/drm/sun4i/sun4i_hdmi_enc.c
+++ b/drivers/gpu/drm/sun4i/sun4i_hdmi_enc.c
@@ -640,6 +640,7 @@ static int sun4i_hdmi_bind(struct device *dev, struct device *master,
 				       DRM_MODE_CONNECTOR_HDMIA,
 				       hdmi->ddc_i2c,
 				       BIT(HDMI_COLORSPACE_RGB),
+				       DRM_CONNECTOR_INFOFRAME_AVI,
 				       8);
 	if (ret) {
 		dev_err(dev,
diff --git a/drivers/gpu/drm/tests/drm_connector_test.c b/drivers/gpu/drm/tests/drm_connector_test.c
index 22e2d959eb31459f9981fef488228904d67cb6f9..fd28ed2bf8bcecabaabc67f2f8f5ccc1f42525d3 100644
--- a/drivers/gpu/drm/tests/drm_connector_test.c
+++ b/drivers/gpu/drm/tests/drm_connector_test.c
@@ -641,6 +641,13 @@ static struct kunit_suite drm_connector_dynamic_register_test_suite = {
 	.test_cases = drm_connector_dynamic_register_tests,
 };
 
+#define DRM_CONNECTOR_ALL_INFOFRAMES \
+	(DRM_CONNECTOR_INFOFRAME_AUDIO | \
+	 DRM_CONNECTOR_INFOFRAME_AVI | \
+	 DRM_CONNECTOR_INFOFRAME_DRM | \
+	 DRM_CONNECTOR_INFOFRAME_SPD | \
+	 DRM_CONNECTOR_INFOFRAME_VENDOR)
+
 /*
  * Test that the registration of a bog standard connector works as
  * expected and doesn't report any error.
@@ -657,6 +664,7 @@ static void drm_test_connector_hdmi_init_valid(struct kunit *test)
 				       DRM_MODE_CONNECTOR_HDMIA,
 				       &priv->ddc,
 				       BIT(HDMI_COLORSPACE_RGB),
+				       DRM_CONNECTOR_ALL_INFOFRAMES,
 				       8);
 	KUNIT_EXPECT_EQ(test, ret, 0);
 }
@@ -677,6 +685,7 @@ static void drm_test_connector_hdmi_init_null_ddc(struct kunit *test)
 				       DRM_MODE_CONNECTOR_HDMIA,
 				       NULL,
 				       BIT(HDMI_COLORSPACE_RGB),
+				       DRM_CONNECTOR_ALL_INFOFRAMES,
 				       8);
 	KUNIT_EXPECT_EQ(test, ret, 0);
 }
@@ -697,6 +706,7 @@ static void drm_test_connector_hdmi_init_null_vendor(struct kunit *test)
 				       DRM_MODE_CONNECTOR_HDMIA,
 				       &priv->ddc,
 				       BIT(HDMI_COLORSPACE_RGB),
+				       DRM_CONNECTOR_ALL_INFOFRAMES,
 				       8);
 	KUNIT_EXPECT_LT(test, ret, 0);
 }
@@ -717,6 +727,7 @@ static void drm_test_connector_hdmi_init_null_product(struct kunit *test)
 				       DRM_MODE_CONNECTOR_HDMIA,
 				       &priv->ddc,
 				       BIT(HDMI_COLORSPACE_RGB),
+				       DRM_CONNECTOR_ALL_INFOFRAMES,
 				       8);
 	KUNIT_EXPECT_LT(test, ret, 0);
 }
@@ -743,6 +754,7 @@ static void drm_test_connector_hdmi_init_product_valid(struct kunit *test)
 				       DRM_MODE_CONNECTOR_HDMIA,
 				       &priv->ddc,
 				       BIT(HDMI_COLORSPACE_RGB),
+				       DRM_CONNECTOR_ALL_INFOFRAMES,
 				       8);
 	KUNIT_EXPECT_EQ(test, ret, 0);
 	KUNIT_EXPECT_MEMEQ(test,
@@ -776,6 +788,7 @@ static void drm_test_connector_hdmi_init_product_length_exact(struct kunit *test
 				       DRM_MODE_CONNECTOR_HDMIA,
 				       &priv->ddc,
 				       BIT(HDMI_COLORSPACE_RGB),
+				       DRM_CONNECTOR_ALL_INFOFRAMES,
 				       8);
 	KUNIT_EXPECT_EQ(test, ret, 0);
 	KUNIT_EXPECT_MEMEQ(test,
@@ -803,6 +816,7 @@ static void drm_test_connector_hdmi_init_product_length_too_long(struct kunit *t
 				       DRM_MODE_CONNECTOR_HDMIA,
 				       &priv->ddc,
 				       BIT(HDMI_COLORSPACE_RGB),
+				       DRM_CONNECTOR_ALL_INFOFRAMES,
 				       8);
 	KUNIT_EXPECT_LT(test, ret, 0);
 }
@@ -829,6 +843,7 @@ static void drm_test_connector_hdmi_init_vendor_valid(struct kunit *test)
 				       DRM_MODE_CONNECTOR_HDMIA,
 				       &priv->ddc,
 				       BIT(HDMI_COLORSPACE_RGB),
+				       DRM_CONNECTOR_ALL_INFOFRAMES,
 				       8);
 	KUNIT_EXPECT_EQ(test, ret, 0);
 	KUNIT_EXPECT_MEMEQ(test,
@@ -861,6 +876,7 @@ static void drm_test_connector_hdmi_init_vendor_length_exact(struct kunit *test)
 				       DRM_MODE_CONNECTOR_HDMIA,
 				       &priv->ddc,
 				       BIT(HDMI_COLORSPACE_RGB),
+				       DRM_CONNECTOR_ALL_INFOFRAMES,
 				       8);
 	KUNIT_EXPECT_EQ(test, ret, 0);
 	KUNIT_EXPECT_MEMEQ(test,
@@ -888,6 +904,7 @@ static void drm_test_connector_hdmi_init_vendor_length_too_long(struct kunit *te
 				       DRM_MODE_CONNECTOR_HDMIA,
 				       &priv->ddc,
 				       BIT(HDMI_COLORSPACE_RGB),
+				       DRM_CONNECTOR_ALL_INFOFRAMES,
 				       8);
 	KUNIT_EXPECT_LT(test, ret, 0);
 }
@@ -908,6 +925,7 @@ static void drm_test_connector_hdmi_init_bpc_invalid(struct kunit *test)
 				       DRM_MODE_CONNECTOR_HDMIA,
 				       &priv->ddc,
 				       BIT(HDMI_COLORSPACE_RGB),
+				       DRM_CONNECTOR_ALL_INFOFRAMES,
 				       9);
 	KUNIT_EXPECT_LT(test, ret, 0);
 }
@@ -928,6 +946,7 @@ static void drm_test_connector_hdmi_init_bpc_null(struct kunit *test)
 				       DRM_MODE_CONNECTOR_HDMIA,
 				       &priv->ddc,
 				       BIT(HDMI_COLORSPACE_RGB),
+				       DRM_CONNECTOR_ALL_INFOFRAMES,
 				       0);
 	KUNIT_EXPECT_LT(test, ret, 0);
 }
@@ -953,6 +972,7 @@ static void drm_test_connector_hdmi_init_bpc_8(struct kunit *test)
 				       DRM_MODE_CONNECTOR_HDMIA,
 				       &priv->ddc,
 				       BIT(HDMI_COLORSPACE_RGB),
+				       DRM_CONNECTOR_ALL_INFOFRAMES,
 				       8);
 	KUNIT_EXPECT_EQ(test, ret, 0);
 
@@ -994,6 +1014,7 @@ static void drm_test_connector_hdmi_init_bpc_10(struct kunit *test)
 				       DRM_MODE_CONNECTOR_HDMIA,
 				       &priv->ddc,
 				       BIT(HDMI_COLORSPACE_RGB),
+				       DRM_CONNECTOR_ALL_INFOFRAMES,
 				       10);
 	KUNIT_EXPECT_EQ(test, ret, 0);
 
@@ -1035,6 +1056,7 @@ static void drm_test_connector_hdmi_init_bpc_12(struct kunit *test)
 				       DRM_MODE_CONNECTOR_HDMIA,
 				       &priv->ddc,
 				       BIT(HDMI_COLORSPACE_RGB),
+				       DRM_CONNECTOR_ALL_INFOFRAMES,
 				       12);
 	KUNIT_EXPECT_EQ(test, ret, 0);
 
@@ -1071,6 +1093,7 @@ static void drm_test_connector_hdmi_init_formats_empty(struct kunit *test)
 				       DRM_MODE_CONNECTOR_HDMIA,
 				       &priv->ddc,
 				       0,
+				       DRM_CONNECTOR_ALL_INFOFRAMES,
 				       8);
 	KUNIT_EXPECT_LT(test, ret, 0);
 }
@@ -1091,6 +1114,7 @@ static void drm_test_connector_hdmi_init_formats_no_rgb(struct kunit *test)
 				       DRM_MODE_CONNECTOR_HDMIA,
 				       &priv->ddc,
 				       BIT(HDMI_COLORSPACE_YUV422),
+				       DRM_CONNECTOR_ALL_INFOFRAMES,
 				       8);
 	KUNIT_EXPECT_LT(test, ret, 0);
 }
@@ -1149,6 +1173,7 @@ static void drm_test_connector_hdmi_init_formats_yuv420_allowed(struct kunit *te
 				       DRM_MODE_CONNECTOR_HDMIA,
 				       &priv->ddc,
 				       params->supported_formats,
+				       DRM_CONNECTOR_ALL_INFOFRAMES,
 				       8);
 	KUNIT_EXPECT_EQ(test, ret, params->expected_result);
 }
@@ -1170,6 +1195,7 @@ static void drm_test_connector_hdmi_init_type_valid(struct kunit *test)
 				       connector_type,
 				       &priv->ddc,
 				       BIT(HDMI_COLORSPACE_RGB),
+				       DRM_CONNECTOR_ALL_INFOFRAMES,
 				       8);
 	KUNIT_EXPECT_EQ(test, ret, 0);
 }
@@ -1205,6 +1231,7 @@ static void drm_test_connector_hdmi_init_type_invalid(struct kunit *test)
 				       connector_type,
 				       &priv->ddc,
 				       BIT(HDMI_COLORSPACE_RGB),
+				       DRM_CONNECTOR_ALL_INFOFRAMES,
 				       8);
 	KUNIT_EXPECT_LT(test, ret, 0);
 }
@@ -1482,6 +1509,7 @@ static void drm_test_drm_connector_attach_broadcast_rgb_property_hdmi_connector(
 				       DRM_MODE_CONNECTOR_HDMIA,
 				       &priv->ddc,
 				       BIT(HDMI_COLORSPACE_RGB),
+				       DRM_CONNECTOR_ALL_INFOFRAMES,
 				       8);
 	KUNIT_EXPECT_EQ(test, ret, 0);
 
diff --git a/drivers/gpu/drm/tests/drm_hdmi_state_helper_test.c b/drivers/gpu/drm/tests/drm_hdmi_state_helper_test.c
index 8bd412735000cb18e66aeca21433b2ebbefe2b44..2901fcb6b12ee318a4a9c727a62d5290d7c9aa84 100644
--- a/drivers/gpu/drm/tests/drm_hdmi_state_helper_test.c
+++ b/drivers/gpu/drm/tests/drm_hdmi_state_helper_test.c
@@ -138,6 +138,13 @@ static const struct drm_connector_funcs dummy_connector_funcs = {
 	.reset			= dummy_hdmi_connector_reset,
 };
 
+#define DRM_CONNECTOR_ALL_INFOFRAMES \
+	(DRM_CONNECTOR_INFOFRAME_AUDIO | \
+	 DRM_CONNECTOR_INFOFRAME_AVI | \
+	 DRM_CONNECTOR_INFOFRAME_DRM | \
+	 DRM_CONNECTOR_INFOFRAME_SPD | \
+	 DRM_CONNECTOR_INFOFRAME_VENDOR)
+
 static
 struct drm_atomic_helper_connector_hdmi_priv *
 __connector_hdmi_init(struct kunit *test,
@@ -192,6 +199,7 @@ __connector_hdmi_init(struct kunit *test,
 				       DRM_MODE_CONNECTOR_HDMIA,
 				       NULL,
 				       formats,
+				       DRM_CONNECTOR_ALL_INFOFRAMES,
 				       max_bpc);
 	KUNIT_ASSERT_EQ(test, ret, 0);
 
diff --git a/drivers/gpu/drm/vc4/vc4_hdmi.c b/drivers/gpu/drm/vc4/vc4_hdmi.c
index 07c91b450f93ab9e795d040d6f60f485ac71cfe8..f7024fd554e04dbfa38d24f775ec5993ac8db335 100644
--- a/drivers/gpu/drm/vc4/vc4_hdmi.c
+++ b/drivers/gpu/drm/vc4/vc4_hdmi.c
@@ -556,6 +556,10 @@ static int vc4_hdmi_connector_init(struct drm_device *dev,
 				       BIT(HDMI_COLORSPACE_RGB) |
 				       BIT(HDMI_COLORSPACE_YUV422) |
 				       BIT(HDMI_COLORSPACE_YUV444),
+				       DRM_CONNECTOR_INFOFRAME_AVI |
+				       DRM_CONNECTOR_INFOFRAME_DRM |
+				       DRM_CONNECTOR_INFOFRAME_SPD |
+				       DRM_CONNECTOR_INFOFRAME_VENDOR,
 				       max_bpc);
 	if (ret)
 		return ret;
diff --git a/include/drm/drm_bridge.h b/include/drm/drm_bridge.h
index 620e119cc24c3491c2be5f08efaf51dfa8f708b3..529dcaca1d7924da12d9587170f96ec6a00ad126 100644
--- a/include/drm/drm_bridge.h
+++ b/include/drm/drm_bridge.h
@@ -1153,6 +1153,13 @@ struct drm_bridge {
 	 */
 	unsigned int max_bpc;
 
+	/**
+	 * @supported_infoframes: Bitmask of DRM_CONNECTOR_INFOFRAME values,
+	 * listing supported infoframes. This is only relevant if
+	 * @DRM_BRIDGE_OP_HDMI is set.
+	 */
+	unsigned int supported_infoframes;
+
 	/**
 	 * @hdmi_cec_dev: device to be used as a containing device for CEC
 	 * functions.
diff --git a/include/drm/drm_connector.h b/include/drm/drm_connector.h
index 8f34f4b8183d83dccd3e820a444fbf74fb6c16f2..5b4bc1d7d566d28f90f0aa342a1258685dda6bd0 100644
--- a/include/drm/drm_connector.h
+++ b/include/drm/drm_connector.h
@@ -1839,6 +1839,12 @@ struct drm_connector_hdmi {
 	 */
 	unsigned long supported_formats;
 
+	/**
+	 * @supported_infoframes: Bitmask of infoframe types supported by the
+	 * controller. See @DRM_CONNECTOR_INFOFRAME.
+	 */
+	unsigned long supported_infoframes;
+
 	/**
 	 * @funcs: HDMI connector Control Functions
 	 */
@@ -2336,6 +2342,7 @@ int drmm_connector_hdmi_init(struct drm_device *dev,
 			     int connector_type,
 			     struct i2c_adapter *ddc,
 			     unsigned long supported_formats,
+			     unsigned long supported_infoframes,
 			     unsigned int max_bpc);
 void drm_connector_attach_edid_property(struct drm_connector *connector);
 int drm_connector_register(struct drm_connector *connector);
@@ -2488,6 +2495,22 @@ void drm_connector_attach_privacy_screen_provider(
 	struct drm_connector *connector, struct drm_privacy_screen *priv);
 void drm_connector_update_privacy_screen(const struct drm_connector_state *connector_state);
 
+#define DRM_CONNECTOR_INFOFRAME(type)	\
+	BIT(type - 0x80)
+
+#define DRM_CONNECTOR_INFOFRAME_AUDIO DRM_CONNECTOR_INFOFRAME(HDMI_INFOFRAME_TYPE_AUDIO)
+#define DRM_CONNECTOR_INFOFRAME_AVI DRM_CONNECTOR_INFOFRAME(HDMI_INFOFRAME_TYPE_AVI)
+#define DRM_CONNECTOR_INFOFRAME_DRM DRM_CONNECTOR_INFOFRAME(HDMI_INFOFRAME_TYPE_DRM)
+#define DRM_CONNECTOR_INFOFRAME_SPD DRM_CONNECTOR_INFOFRAME(HDMI_INFOFRAME_TYPE_SPD)
+#define DRM_CONNECTOR_INFOFRAME_VENDOR DRM_CONNECTOR_INFOFRAME(HDMI_INFOFRAME_TYPE_VENDOR)
+
+static inline bool
+drm_hdmi_connector_supports_infoframe(const struct drm_connector *connector,
+				      enum hdmi_infoframe_type type)
+{
+	return connector->hdmi.supported_infoframes & DRM_CONNECTOR_INFOFRAME(type);
+}
+
 /**
  * struct drm_tile_group - Tile group metadata
  * @refcount: reference count

-- 
2.47.2


From mboxrd@z Thu Jan  1 00:00:00 1970
Received: from DU2PR03CU002.outbound.protection.outlook.com (mail-northeuropeazon11011068.outbound.protection.outlook.com [52.101.65.68])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by smtp.subspace.kernel.org (Postfix) with ESMTPS id DA672272E5E
	for <linux-sunxi@lists.linux.dev>; Tue, 19 Aug 2025 09:41:12 +0000 (UTC)
Authentication-Results: smtp.subspace.kernel.org; arc=fail smtp.client-ip=52.101.65.68
ARC-Seal: i=2; a=rsa-sha256; d=subspace.kernel.org; s=arc-20240116;
	t=1755596475; cv=fail; b=IbA1nZsX8mzpHmiC+sso1Y7+kImlem9II5oyeBXUxk5srzrVmrehPxLipSl8Hdi3nf5Fs9lTExkOHx3UJkI5pjKoi5nSJhrwy97cyieUt+unIMW9PoHCbQHH4/Qi7/BtjlJh9cyr+QQe3GxA+JmDnuVxMNJ4D44Rq2jw2SmxFOQ=
ARC-Message-Signature: i=2; a=rsa-sha256; d=subspace.kernel.org;
	s=arc-20240116; t=1755596475; c=relaxed/simple;
	bh=pL3s0OQ20craHEVpaIYgsLLqSCTx2sMOMpmM2EkovFc=;
	h=Message-ID:Date:Subject:To:Cc:References:From:In-Reply-To:
	 Content-Type:MIME-Version; b=UB/3fDptOtlKEPGClEFsSCpuV6QiGDAVaJfmjqqGSZkrvvMa8+JB9autaiF71J84MS9juUNuceFfTTiGQx2iQdAjhbG8lzZilCSlYneLArwLhJK93SPwpjldDBEZ7vB6dCOd78D5aeh5uknqO3ZcExy4DESLalvaLUTPJ/3Qyh8=
ARC-Authentication-Results: i=2; smtp.subspace.kernel.org; dmarc=pass (p=none dis=none) header.from=nxp.com; spf=pass smtp.mailfrom=nxp.com; dkim=pass (2048-bit key) header.d=nxp.com header.i=@nxp.com header.b=cq6bb0fQ; arc=fail smtp.client-ip=52.101.65.68
Authentication-Results: smtp.subspace.kernel.org; dmarc=pass (p=none dis=none) header.from=nxp.com
Authentication-Results: smtp.subspace.kernel.org; spf=pass smtp.mailfrom=nxp.com
Authentication-Results: smtp.subspace.kernel.org;
	dkim=pass (2048-bit key) header.d=nxp.com header.i=@nxp.com header.b="cq6bb0fQ"
ARC-Seal: i=1; a=rsa-sha256; s=arcselector10001; d=microsoft.com; cv=none;
 b=ymgvOJwvEoZExC4zIwL4pnFAohRpJAvzGNUL1+LvahPkKzelkB6ocr0AVd7oMpRC6xgb+5jnj/wTa5OoLSQs5sjhnt9IDUPTp9YMDgMtaB0HJOmQMWrlv0uIiqV3Egl2ucN9Rhy1wTafEHOdLvAHISs+Edhu02UxWlGnI87NVJce1KIoTcnMlcXerO2Xi2uUvGG6Y6JZ3epQi202Vaom+bkWZdHw3ZWSN1IrsIl+JdtJnrMJfC9mcH+ohliaIEhT71vn/0oL9lEji2eB6rwCBj9sdV69fzThBr3roNjrPwZ4RBGp6hNg/FCEoxPWwFoO/eyCo0GdYedhV0YjpAM4RQ==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com;
 s=arcselector10001;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-AntiSpam-MessageData-ChunkCount:X-MS-Exchange-AntiSpam-MessageData-0:X-MS-Exchange-AntiSpam-MessageData-1;
 bh=Zd4S4Oyj7LzsY4k5ljBsjV9vJhP6PpWiL3MzNxBuDQ4=;
 b=i37keZWmbRJijvIJrw+ne21HG49VogUiSPAl94F1yVKtVRO0VYfZaWDXIB8F/Wjnf+DO7BIJA/P/pGdxPA6dVhzmhsze7EBmUcPSibBP36uyLBfR4QKFNVm97XDKdKm2U3p/D5poL4bM/YaydV1JrzoUjMbPGMyZ21OvKZLYPuzXc4GbSdlWtAvriiud3VpYb4mUm8CrHzul61G7MaFVDYnMFKVNrItkIOSZzCiexCTMRzkDaW490ML5mjFp28GwCvImn6kvBBSiATB/Lo/ogc2385CFSioOTVY3wcjpZwrr5oc2sFua0B7QOVqB+V25X67TJjgWgW61DOBJJoTlVw==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=nxp.com; dmarc=pass action=none header.from=nxp.com; dkim=pass
 header.d=nxp.com; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=nxp.com; s=selector1;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=Zd4S4Oyj7LzsY4k5ljBsjV9vJhP6PpWiL3MzNxBuDQ4=;
 b=cq6bb0fQkNwoOCxCpcKsFC70tv8SLT+XzHEU1QEs83/28VW8GRrr80Yg5eVwFPVZ3nmsYE/V/eFGV2I7OXe0mb0SszcHay+8x8Mzq1mwPTufVLVr2I8uui9PDh7+GO1weWDkk9HqCUUb9zETK6jog/HS8Xh365NT+X3hjhr+EcthtfOEf9VjxDEKe+dlOVJn5F9PQiLXZVXvtJ0KmAU+d4U/M8Pxp1n3kCp2tXfqDCW35IT5bFM7UlJVv7+jJroH97WrIETxQVB2IyG4rtZTSH2Dwy6ynsMD6fDvSoPf3Zv1S5VntOzAKhVIn7VYE0HghsVrLDQTussBX4I8UnM7yw==
Authentication-Results: dkim=none (message not signed)
 header.d=none;dmarc=none action=none header.from=nxp.com;
Received: from AM7PR04MB7046.eurprd04.prod.outlook.com (2603:10a6:20b:113::22)
 by PAXPR04MB9059.eurprd04.prod.outlook.com (2603:10a6:102:220::15) with
 Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.9052.12; Tue, 19 Aug
 2025 09:41:09 +0000
Received: from AM7PR04MB7046.eurprd04.prod.outlook.com
 ([fe80::d1ce:ea15:6648:6f90]) by AM7PR04MB7046.eurprd04.prod.outlook.com
 ([fe80::d1ce:ea15:6648:6f90%5]) with mapi id 15.20.9052.011; Tue, 19 Aug 2025
 09:41:09 +0000
Message-ID: <e9f2c06d-07ee-4f69-887c-caf5efb59f7f@nxp.com>
Date: Tue, 19 Aug 2025 17:42:39 +0800
User-Agent: Mozilla Thunderbird
Subject: Re: [PATCH 1/7] drm/connector: let drivers declare infoframes as
 unsupported
To: Dmitry Baryshkov <dmitry.baryshkov@oss.qualcomm.com>,
 Andrzej Hajda <andrzej.hajda@intel.com>,
 Neil Armstrong <neil.armstrong@linaro.org>, Robert Foss <rfoss@kernel.org>,
 Laurent Pinchart <Laurent.pinchart@ideasonboard.com>,
 Jonas Karlman <jonas@kwiboo.se>, Jernej Skrabec <jernej.skrabec@gmail.com>,
 Maarten Lankhorst <maarten.lankhorst@linux.intel.com>,
 Maxime Ripard <mripard@kernel.org>, Thomas Zimmermann <tzimmermann@suse.de>,
 David Airlie <airlied@gmail.com>, Simona Vetter <simona@ffwll.ch>,
 Sandy Huang <hjc@rock-chips.com>, =?UTF-8?Q?Heiko_St=C3=BCbner?=
 <heiko@sntech.de>, Andy Yan <andy.yan@rock-chips.com>,
 Chen-Yu Tsai <wens@csie.org>, Samuel Holland <samuel@sholland.org>,
 Dave Stevenson <dave.stevenson@raspberrypi.com>,
 =?UTF-8?Q?Ma=C3=ADra_Canal?= <mcanal@igalia.com>,
 Raspberry Pi Kernel Maintenance <kernel-list@raspberrypi.com>,
 Rob Clark <robin.clark@oss.qualcomm.com>, Dmitry Baryshkov
 <lumag@kernel.org>, Abhinav Kumar <abhinav.kumar@linux.dev>,
 Jessica Zhang <jessica.zhang@oss.qualcomm.com>, Sean Paul <sean@poorly.run>,
 Marijn Suijten <marijn.suijten@somainline.org>
Cc: dri-devel@lists.freedesktop.org, linux-kernel@vger.kernel.org,
 linux-arm-kernel@lists.infradead.org, linux-rockchip@lists.infradead.org,
 linux-sunxi@lists.linux.dev, linux-arm-msm@vger.kernel.org,
 freedreno@lists.freedesktop.org
References: <20250816-drm-limit-infoframes-v1-0-6dc17d5f07e9@oss.qualcomm.com>
 <20250816-drm-limit-infoframes-v1-1-6dc17d5f07e9@oss.qualcomm.com>
From: Liu Ying <victor.liu@nxp.com>
Content-Language: en-US
In-Reply-To: <20250816-drm-limit-infoframes-v1-1-6dc17d5f07e9@oss.qualcomm.com>
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
X-ClientProxiedBy: SI2PR02CA0008.apcprd02.prod.outlook.com
 (2603:1096:4:194::12) To AM7PR04MB7046.eurprd04.prod.outlook.com
 (2603:10a6:20b:113::22)
Precedence: bulk
X-Mailing-List: linux-sunxi@lists.linux.dev
List-Id: <linux-sunxi.lists.linux.dev>
List-Subscribe: <mailto:linux-sunxi+subscribe@lists.linux.dev>
List-Unsubscribe: <mailto:linux-sunxi+unsubscribe@lists.linux.dev>
MIME-Version: 1.0
X-MS-PublicTrafficType: Email
X-MS-TrafficTypeDiagnostic: AM7PR04MB7046:EE_|PAXPR04MB9059:EE_
X-MS-Office365-Filtering-Correlation-Id: 00aac185-6cc9-4f23-5b99-08dddf048684
X-LD-Processed: 686ea1d3-bc2b-4c6f-a92c-d99c5c301635,ExtAddr
X-MS-Exchange-SenderADCheck: 1
X-MS-Exchange-AntiSpam-Relay: 0
X-Microsoft-Antispam: 
 BCL:0;ARA:13230040|376014|7416014|1800799024|19092799006|366016|7053199007|921020;
X-Microsoft-Antispam-Message-Info: 
 =?utf-8?B?NWoxcE05Rk1MbU4yaG9kOTZxaW91dWlpcHdpTnVNTUk0WnM2eVpSbWlNNXRp?=
 =?utf-8?B?SUU3Y2RwNHZlMlZVTTd0SHhpMnhlWFMxQXN5WWNTYmdLZmpRNWtmcTFhYUIz?=
 =?utf-8?B?OEhENlVvWm5HOGZYVWMwcjFRV1B2c3B4cS9NR1l1QTVHejNVTksvR3ZKQ1BL?=
 =?utf-8?B?amZtRlIrTGd5QkZ5WUl2OEhEQnVVU3pwRUJ5anFtQ1BOMzNhaFdudVZHampP?=
 =?utf-8?B?d0s3bUU1MlVUd3RwVjlZSDUrQjFKaXNIdENqeHJ2MzEwWXdMWWtTOG1nc2hn?=
 =?utf-8?B?RGhTWEd5bXRtNlE1SjVZU1NWTHFHZ1gycENGOHdpcEl4NUcxV3B2UmNXSCtT?=
 =?utf-8?B?aDBZVlhhVEZETXp4SXhDVXhDMEdmZ0t3OUwzT1ZQN2NiZmtreFdzakRDU0ll?=
 =?utf-8?B?SVpza2wyVzNNeWZoY0FnR3RYVHFVTjk2eUtxOUphWUQ5d0pUWWtjOXk0OHZS?=
 =?utf-8?B?WlJwVzg2YzR4YW5GSmxJQlNYa0dOa0FpVCtSWkNkbWdEY0ZmZWJkY0hKZ0p6?=
 =?utf-8?B?UmluYzExQUIwajh3bW9ES3pxU01RcXhQUjJjYTdnbWdJdDVES2hzMUxjZ0FR?=
 =?utf-8?B?TWxEVkpnMTNGN254OFNTS1Q5Z1huQlRIaDVEaWtKd1dsMnF0RjhyeXZsVlIx?=
 =?utf-8?B?Vi85RGQ5R1lwVkxCekFPci9oSzJTbEhuN0JlZ25xNTR2MFJ5aEEyTnZ5RzFu?=
 =?utf-8?B?dGgzVXAwVFFrR253aGZCQVBJYm05alJLRGp0V1U2OUgxaER0NWpZcEh6MU5y?=
 =?utf-8?B?YlhlYnl3RFpyK2xjbHgrcGN1VWczazRaT0d3RG5DY3pobkhzUWMrUHlrZld5?=
 =?utf-8?B?dkl4dlBZUGRPdEZRblA2eWw1WHZ6T3NMbWFEMDFyV3NwLzhrNUxPdVZ1WmNo?=
 =?utf-8?B?T0xpNE43WU5HR2pxQ1kwVEVSSXplTDhYNFZxQU9FQm0zcUZoVi92M1AvVG8r?=
 =?utf-8?B?QVJLVFVxRnBKNCtONUFQUjJxYTFlZ0gvNUxvZm1JTDlSanQ4cGc4YkZheWVO?=
 =?utf-8?B?eUQwMkFXbU11ZndlSGZoVzB0N0lRZFl6eldzeitlbTAwcSs4MEI0VExKVUpq?=
 =?utf-8?B?OERZNmRVRjNDOW9aVHFtYTE3Nit0Zkp5TnhhOWNYQS9wYzRSQnpvWWkvMHo0?=
 =?utf-8?B?TWdjaFRDc1VPamorK09hUzJJRy9mVWJLRkM5SnloR2VvblpyTkp0eEZoZmZw?=
 =?utf-8?B?TG15UzZmY2ZyUHdiK1kxb3dQUndkWS9LYklZbGJTQWNrZ25MZGwycVV4OFlj?=
 =?utf-8?B?eUNjYU9PV3p2ZVBQOE9BVFczWTBNelc1UzJYWlYrVW4vNWZ3Z3Y3Qi9NREU4?=
 =?utf-8?B?amlLd0lVVGNyeXE5QW1mZS9SMnZxb0o0Q2JPNXA4YThna05NQTg1VWNOV1pY?=
 =?utf-8?B?Mk0xZEttdzZweDF3cDVpWVdYQ2I3c0hBSjB3SnN3LzNZS1Z5VVpaenE1TWJ2?=
 =?utf-8?B?R250Q2tRSEovSER6UlI0bkhTMk40U0QzeS9Bbi9Uek4xN1RsTVdoWjI5cGl3?=
 =?utf-8?B?QU1ISXNrUnUySDNpaE44dk50Z1V5UG5QV0YvVzNZQXNZMkZDSjNBbXkwNEpI?=
 =?utf-8?B?L1BqaXZHbzdRTTNvcTdlOC95N1l5R0V5d3lzV3VhR05LdEVVNHdkdmVtcmdC?=
 =?utf-8?B?QW5kTUFLaTFkMmhDdjYrWWxsUnQxbXF1UW5EQnFrVkg0Z3R3ZCtoRHBDU0p2?=
 =?utf-8?B?L1FkSUYzbXJXYVZWYVNyeHY1MnVMMzdNYXZxVFF0eVcxeTEyNHhVTnpwRThU?=
 =?utf-8?B?RFBRbHJtYWpkTVZRTmJpZ3A5NHJTdG8vWkJYaUlNM0ZSTVVWckFrZkp3Q0cz?=
 =?utf-8?B?UW1UVjdibTA3Y3VjRndyR0ZyVWE5Q0kxNkl6dHR1K2ErVkR0UVhOalhQR09m?=
 =?utf-8?B?UUNGeGdRYzV4ZUhxQm1XMXB5eGp6S1dkWlgzWmMxQ2tZN1RoWkx2R2dVM2Iw?=
 =?utf-8?B?U21uVUJsVW9UNjVQR1RxQ0txY3cvelpFcDI4czdHVWZsa29PWUJBd1lGbmMx?=
 =?utf-8?B?UmJNWjQzU1NnPT0=?=
X-Forefront-Antispam-Report: 
 CIP:255.255.255.255;CTRY:;LANG:en;SCL:1;SRV:;IPV:NLI;SFV:NSPM;H:AM7PR04MB7046.eurprd04.prod.outlook.com;PTR:;CAT:NONE;SFS:(13230040)(376014)(7416014)(1800799024)(19092799006)(366016)(7053199007)(921020);DIR:OUT;SFP:1101;
X-MS-Exchange-AntiSpam-MessageData-ChunkCount: 1
X-MS-Exchange-AntiSpam-MessageData-0: 
 =?utf-8?B?dERyeStLVG5TMktrZVdWWnF4NkZzSnRrbS9rZDI3anZuR1dlQk1oekwvNXVo?=
 =?utf-8?B?RksycWpTZmsvaDlHaHFhNG9nY2c0WkFibXpGQXZtUGR1cVRva1RkdGkrWVJk?=
 =?utf-8?B?aXlpRkI3SjNQdHJWekpOMmJ4QTNTTXJUN0NJYzM0ZU81MkY1NzNqRHIvWUQ5?=
 =?utf-8?B?MURDY2p6MFdjMXRwalJqMmo1VXFzMHZnWnNUTkJnTUtkTzg1eVdrb3EvdlJH?=
 =?utf-8?B?QWlGTWNjMGt0cTFRbTZwKy8rdlNFVDJrRC9EVWowSXUydDJ2VzQ0MkZhbTVH?=
 =?utf-8?B?VFdNZlR4K0MrUE1LcGc4N1AreVR6WTJIekt6MnlsbnF0R0MyZkQ1czdnWTNR?=
 =?utf-8?B?ck1SWmN6dXBJYStNMm1QYjByWm9IdkF3ajRQM1BndUJuRzAwVTdObjEvbDUy?=
 =?utf-8?B?bHJaenUzaTJVQlgvbXNrTDhGZi9WSHNDeTFUbjBnMWRiTGt6R2ZQZ2hValNu?=
 =?utf-8?B?VklCbHNXL3FEbHZkbk13SkdzKzJyTXExS2dyOU0rcjZuVXBKYnM3bXE2ekdU?=
 =?utf-8?B?LzRjWUhNbXBsUWoxQWlCb1lwdGFkM1NUc05XTDBXNG5MdTBMRkh4TG1vTFpV?=
 =?utf-8?B?RTBVdFZjUU9DWTl3M0J0VHlvSEwxMWV5Nzg3OUxFcndDQkZ3WW5DYWF4aGp1?=
 =?utf-8?B?MFRQa1FzdVlHYkQrc0xQK1FEZ2VFUGh5cG04Vm9vQk1lUUF0VW5DS1YvVDM1?=
 =?utf-8?B?NkdjNVpCSC9HUnVxRHR1NFpmd1EzbkpFSXhRSWpTRDZkdHNLTHV0QzliQ1VL?=
 =?utf-8?B?VkQ1M2ZDcFNlOGJDeTBacVRIWEJkZ3RycHNHRW50enBXVUwxTGkzTXdJbDhu?=
 =?utf-8?B?RGExT3ZRS2RsSm90RytJOHUvNU9kb0xwTC9kSjkxQmJYemplczRKRnh2anJk?=
 =?utf-8?B?eG4xS050ckdjSUM0cHNMU0R6b3JOTXZsK3N5dnFwMzlDbGNSVHpWMnRtNTI5?=
 =?utf-8?B?dmJ3OWREM3VXb3l1Q2hpL3NBbFl3YjFOd01hMkZWOTdFL2FCNGxwUDlWRzJm?=
 =?utf-8?B?eEZrRW5rN05RSmZ6cllhcVZuU25BRXJJekFPMjBXS2NDUzlVbDdBRVhkZmIr?=
 =?utf-8?B?c01vWjdlVDMzNXpyb0dHcGIxMmhWMXZqNE1JUjZ0MmZJY1JUVGVrN0VxTEEw?=
 =?utf-8?B?NzZ2VW1ocFVZWmZDSFZiZFBjOTZ6S0JpZHZXNG52ZEdveGlDaW4xUlJxTlZR?=
 =?utf-8?B?S2VmU2lzdnUwbnRUYU1CV2hXOGMwZE1INW4xRGJmeTFXenBaTzhrRTJWRGc1?=
 =?utf-8?B?TklqUnNRb0dUQklQNDhWMG5SQnNpbFNHVVZyQWVYN1UvNTVjWHF3VEI2RzVH?=
 =?utf-8?B?ZHFzTUFocUp3RlZNS2cwS1FSR3N4U0xXYjhPY2VycWEwSHBNbVdOTExjdlNl?=
 =?utf-8?B?MTBuTUpnNi80SzB4MHVacGgvUFJKeG82aFA3M0FCb2h2YVY2VUlsM2MvSzhN?=
 =?utf-8?B?Uy9WTVpBTXFoOUk0bGEyV1JFcGpFaEtFZ3hCLzU5cGl1NGwyejVBZStCbHRj?=
 =?utf-8?B?YWE4MXUwSTNBaXM5T3JOZUpJWlBIMjFGb3gwcmFDVEl6STVlWlh4RVZYRnNP?=
 =?utf-8?B?emMxUHpsMTdMVkM3dTVqWm1oalhwOUxmcEpNWXo5TlNSMDExNnNNWVQ5cjhD?=
 =?utf-8?B?N2RRTk5tTTMzVnR6NzNtY0F1dVg5MmFTbkdEY3FBRVN1aS9wMVZOQ3BuOGRi?=
 =?utf-8?B?YUo0b2RaVjNRVk01ZUFUV1g4V24yT1QyR2tQQzUvY0x0MytzOG13NkZkSEla?=
 =?utf-8?B?SUFmbVNldHhCanpvTnNBaHZscUVUWThmZmQ5dkoxd05MNkhOTjJaVWJFMi9t?=
 =?utf-8?B?Vm9EckpiUGo2V1pLQThEWVU1cDJlck44Z2NqZXU0Umc3YXZtRVp1cWRsaXdo?=
 =?utf-8?B?MVVYa1hFMnhIcWRaTkV0WVU1dWozL2t2d1l2TUsycFNhNW45b2RYZDMzVTFQ?=
 =?utf-8?B?RWdIVEwwdk9JY1A5dDlTam9MYXE2TkRTemxyWlM2UjBSSmcxaXRiR1ltd1pm?=
 =?utf-8?B?Yjg2MUtUamNxSFhMUktvS0VPMVNmcEpQUlpZdnI4bnZoc0VzeDVpQXZjb1lr?=
 =?utf-8?B?SFFqS3hoMW0zZFRmTHFoaDJpSlNwN3g4UlVCRnNTRlpQTUkrcFdFUVhyRGFy?=
 =?utf-8?Q?TXJ0OnlIYRqp33MvBSwBrPGPx?=
X-OriginatorOrg: nxp.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 00aac185-6cc9-4f23-5b99-08dddf048684
X-MS-Exchange-CrossTenant-AuthSource: AM7PR04MB7046.eurprd04.prod.outlook.com
X-MS-Exchange-CrossTenant-AuthAs: Internal
X-MS-Exchange-CrossTenant-OriginalArrivalTime: 19 Aug 2025 09:41:09.0393
 (UTC)
X-MS-Exchange-CrossTenant-FromEntityHeader: Hosted
X-MS-Exchange-CrossTenant-Id: 686ea1d3-bc2b-4c6f-a92c-d99c5c301635
X-MS-Exchange-CrossTenant-MailboxType: HOSTED
X-MS-Exchange-CrossTenant-UserPrincipalName: 7zctb+XMUc2OInlSemQJ1jtRSEbDhC+eqK/608MFQyEPWXXomrdLrAzs+ByRS8KwzZsI0VPCSV8/a4xm/5qAuQ==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: PAXPR04MB9059

Hi Dmitry,

On 08/16/2025, Dmitry Baryshkov wrote:
> Currently DRM framework expects that the HDMI connector driver supports
> all infoframe types: it generates the data as required and calls into
> the driver to program all of them, letting the driver to soft-fail if
> the infoframe is unsupported. This has a major drawback on userspace
> API: the framework also registers debugfs files for all Infoframe types,
> possibly surprising the users when infoframe is visible in the debugfs
> file, but it is not visible on the wire.
> 
> Let drivers declare that they support only a subset of infoframes,
> creating a more consistent interface.
> 
> Signed-off-by: Dmitry Baryshkov <dmitry.baryshkov@oss.qualcomm.com>
> ---
>  drivers/gpu/drm/display/drm_bridge_connector.c     |  6 +++
>  drivers/gpu/drm/display/drm_hdmi_state_helper.c    | 43 +++++++++++++++++++++-
>  drivers/gpu/drm/drm_connector.c                    |  4 ++
>  drivers/gpu/drm/drm_debugfs.c                      | 16 +++++---
>  drivers/gpu/drm/rockchip/inno_hdmi.c               |  1 +
>  drivers/gpu/drm/sun4i/sun4i_hdmi_enc.c             |  1 +
>  drivers/gpu/drm/tests/drm_connector_test.c         | 28 ++++++++++++++
>  drivers/gpu/drm/tests/drm_hdmi_state_helper_test.c |  8 ++++
>  drivers/gpu/drm/vc4/vc4_hdmi.c                     |  4 ++
>  include/drm/drm_bridge.h                           |  7 ++++
>  include/drm/drm_connector.h                        | 23 ++++++++++++
>  11 files changed, 134 insertions(+), 7 deletions(-)
> 
> diff --git a/drivers/gpu/drm/display/drm_bridge_connector.c b/drivers/gpu/drm/display/drm_bridge_connector.c
> index 8c915427d0538435661d771940efe38b462027a1..b94458d5faa9ae283889fc79496ae323bb4dc88c 100644
> --- a/drivers/gpu/drm/display/drm_bridge_connector.c
> +++ b/drivers/gpu/drm/display/drm_bridge_connector.c
> @@ -781,6 +781,12 @@ struct drm_connector *drm_bridge_connector_init(struct drm_device *drm,
>  					       &drm_bridge_connector_hdmi_funcs,
>  					       connector_type, ddc,
>  					       supported_formats,
> +					       bridge->supported_infoframes ? :
> +					       DRM_CONNECTOR_INFOFRAME_AUDIO |
> +					       DRM_CONNECTOR_INFOFRAME_AVI |
> +					       DRM_CONNECTOR_INFOFRAME_DRM |
> +					       DRM_CONNECTOR_INFOFRAME_SPD |
> +					       DRM_CONNECTOR_INFOFRAME_VENDOR,

The mask is DRM_CONNECTOR_ALL_INFOFRAMES as defined in drm_connector_test.c
and drm_hdmi_state_helper_test.c.  Can it be defined in drm_connector.h and
used here?

>  					       max_bpc);
>  		if (ret)
>  			return ERR_PTR(ret);
> diff --git a/drivers/gpu/drm/display/drm_hdmi_state_helper.c b/drivers/gpu/drm/display/drm_hdmi_state_helper.c
> index a561f124be99a0cd4259dbacf5f5f6651ff8a0ea..fb8b9e3769cb74345f9c6ef6f6ca441a373141c1 100644
> --- a/drivers/gpu/drm/display/drm_hdmi_state_helper.c
> +++ b/drivers/gpu/drm/display/drm_hdmi_state_helper.c
> @@ -687,6 +687,10 @@ static int hdmi_generate_avi_infoframe(const struct drm_connector *connector,
>  
>  	infoframe->set = false;
>  
> +	if (!drm_hdmi_connector_supports_infoframe(connector,
> +						   HDMI_INFOFRAME_TYPE_AVI))

Nit: The above two lines fit into a single line.  The same applies to similar
lines added in this file.

> +		return 0;
> +
>  	ret = drm_hdmi_avi_infoframe_from_display_mode(frame, connector, mode);
>  	if (ret)
>  		return ret;
> @@ -718,6 +722,10 @@ static int hdmi_generate_spd_infoframe(const struct drm_connector *connector,
>  
>  	infoframe->set = false;
>  
> +	if (!drm_hdmi_connector_supports_infoframe(connector,
> +						   HDMI_INFOFRAME_TYPE_SPD))
> +		return 0;
> +
>  	ret = hdmi_spd_infoframe_init(frame,
>  				      connector->hdmi.vendor,
>  				      connector->hdmi.product);
> @@ -742,6 +750,10 @@ static int hdmi_generate_hdr_infoframe(const struct drm_connector *connector,
>  
>  	infoframe->set = false;
>  
> +	if (!drm_hdmi_connector_supports_infoframe(connector,
> +						   HDMI_INFOFRAME_TYPE_DRM))
> +		return 0;
> +
>  	if (connector->max_bpc < 10)
>  		return 0;
>  
> @@ -771,6 +783,10 @@ static int hdmi_generate_hdmi_vendor_infoframe(const struct drm_connector *conne
>  
>  	infoframe->set = false;
>  
> +	if (!drm_hdmi_connector_supports_infoframe(connector,
> +						   HDMI_INFOFRAME_TYPE_VENDOR))
> +		return 0;
> +
>  	if (!info->has_hdmi_infoframe)
>  		return 0;
>  
> @@ -905,6 +921,11 @@ static int clear_device_infoframe(struct drm_connector *connector,
>  		return 0;
>  	}
>  
> +	if (!drm_hdmi_connector_supports_infoframe(connector, type)) {
> +		drm_dbg_kms(dev, "Infoframe %d not supported, bailing.\n", type);

%d should be 0x%02x as type's value is 0x8*?

> +		return 0;
> +	}
> +
>  	ret = funcs->clear_infoframe(connector, type);
>  	if (ret) {
>  		drm_dbg_kms(dev, "Call failed: %d\n", ret);
> @@ -932,21 +953,27 @@ static int write_device_infoframe(struct drm_connector *connector,
>  	const struct drm_connector_hdmi_funcs *funcs = connector->hdmi.funcs;
>  	struct drm_device *dev = connector->dev;
>  	u8 buffer[HDMI_INFOFRAME_SIZE(MAX)];
> +	enum hdmi_infoframe_type type = frame->any.type;

Nit: follow reverse x'mas tree fashion.

>  	int ret;
>  	int len;
>  
> -	drm_dbg_kms(dev, "Writing infoframe type %x\n", frame->any.type);
> +	drm_dbg_kms(dev, "Writing infoframe type %x\n", type);
>  
>  	if (!funcs || !funcs->write_infoframe) {
>  		drm_dbg_kms(dev, "Function not implemented, bailing.\n");
>  		return -EINVAL;
>  	}
>  
> +	if (!drm_hdmi_connector_supports_infoframe(connector, type)) {
> +		drm_dbg_kms(dev, "Infoframe %d not supported, bailing.\n", type);
> +		return 0;
> +	}
> +
>  	len = hdmi_infoframe_pack(frame, buffer, sizeof(buffer));
>  	if (len < 0)
>  		return len;
>  
> -	ret = funcs->write_infoframe(connector, frame->any.type, buffer, len);
> +	ret = funcs->write_infoframe(connector, type, buffer, len);
>  	if (ret) {
>  		drm_dbg_kms(dev, "Call failed: %d\n", ret);
>  		return ret;
> @@ -1067,6 +1094,12 @@ drm_atomic_helper_connector_hdmi_update_audio_infoframe(struct drm_connector *co
>  	struct drm_display_info *info = &connector->display_info;
>  	int ret;
>  
> +	if (!drm_hdmi_connector_supports_infoframe(connector,
> +						   HDMI_INFOFRAME_TYPE_AUDIO)) {
> +		drm_dbg_kms(connector->dev, "Audio Infoframe not supported, bailing.\n");

Maybe, print out error message instead of using drm_dbg_kms() since bridge
should always set HDMI_INFOFRAME_TYPE_AUDIO if it calls this function?

> +		return -EOPNOTSUPP;
> +	}
> +
>  	if (!info->is_hdmi)
>  		return 0;
>  
> @@ -1102,6 +1135,12 @@ drm_atomic_helper_connector_hdmi_clear_audio_infoframe(struct drm_connector *con
>  	struct drm_display_info *info = &connector->display_info;
>  	int ret;
>  
> +	if (!drm_hdmi_connector_supports_infoframe(connector,
> +						   HDMI_INFOFRAME_TYPE_AUDIO)) {
> +		drm_dbg_kms(connector->dev, "Audio Infoframe not supported, bailing.\n");

Ditto.

> +		return -EOPNOTSUPP;
> +	}
> +
>  	if (!info->is_hdmi)
>  		return 0;
>  
> diff --git a/drivers/gpu/drm/drm_connector.c b/drivers/gpu/drm/drm_connector.c
> index 272d6254ea4784e97ca894ec4d463beebf9fdbf0..e753de9fc80a26c30b9674c96083328711f32960 100644
> --- a/drivers/gpu/drm/drm_connector.c
> +++ b/drivers/gpu/drm/drm_connector.c
> @@ -553,6 +553,7 @@ EXPORT_SYMBOL(drmm_connector_init);
>   * @connector_type: user visible type of the connector
>   * @ddc: optional pointer to the associated ddc adapter
>   * @supported_formats: Bitmask of @hdmi_colorspace listing supported output formats
> + * @supported_infoframes: Bitmask of @DRM_CONNECTOR_INFOFRAME listing supported Infoframes
>   * @max_bpc: Maximum bits per char the HDMI connector supports
>   *
>   * Initialises a preallocated HDMI connector. Connectors can be
> @@ -576,6 +577,7 @@ int drmm_connector_hdmi_init(struct drm_device *dev,
>  			     int connector_type,
>  			     struct i2c_adapter *ddc,
>  			     unsigned long supported_formats,
> +			     unsigned long supported_infoframes,
>  			     unsigned int max_bpc)
>  {
>  	int ret;
> @@ -623,6 +625,8 @@ int drmm_connector_hdmi_init(struct drm_device *dev,
>  
>  	connector->hdmi.funcs = hdmi_funcs;
>  
> +	connector->hdmi.supported_infoframes = supported_infoframes;
> +
>  	return 0;
>  }
>  EXPORT_SYMBOL(drmm_connector_hdmi_init);
> diff --git a/drivers/gpu/drm/drm_debugfs.c b/drivers/gpu/drm/drm_debugfs.c
> index 365cf337529fa2a88b69516d57360d212419c126..248cb9ea1d8781674160cd8d454113c9422ec691 100644
> --- a/drivers/gpu/drm/drm_debugfs.c
> +++ b/drivers/gpu/drm/drm_debugfs.c
> @@ -672,6 +672,9 @@ static int create_hdmi_audio_infoframe_file(struct drm_connector *connector,
>  {
>  	struct dentry *file;
>  
> +	if (!drm_hdmi_connector_supports_infoframe(connector, HDMI_INFOFRAME_TYPE_AUDIO))
> +		return 0;
> +
>  	file = debugfs_create_file("audio", 0400, parent, connector, &audio_infoframe_fops);
>  	if (IS_ERR(file))
>  		return PTR_ERR(file);
> @@ -679,7 +682,7 @@ static int create_hdmi_audio_infoframe_file(struct drm_connector *connector,
>  	return 0;
>  }
>  
> -#define DEFINE_INFOFRAME_FILE(_f) \
> +#define DEFINE_INFOFRAME_FILE(_f, _F) \
>  static ssize_t _f##_read_infoframe(struct file *filp, \
>  				   char __user *ubuf, \
>  				   size_t count,      \
> @@ -726,6 +729,9 @@ static int create_hdmi_## _f ## _infoframe_file(struct drm_connector *connector,
>  { \
>  	struct dentry *file; \
>  	\
> +	if (!drm_hdmi_connector_supports_infoframe(connector, HDMI_INFOFRAME_TYPE_ ## _F)) \
> +		return 0; \
> +	\
>  	file = debugfs_create_file(#_f, 0400, parent, connector, &_f ## _infoframe_fops); \
>  	if (IS_ERR(file)) \
>  		return PTR_ERR(file); \
> @@ -733,10 +739,10 @@ static int create_hdmi_## _f ## _infoframe_file(struct drm_connector *connector,
>  	return 0; \
>  }
>  
> -DEFINE_INFOFRAME_FILE(avi);
> -DEFINE_INFOFRAME_FILE(hdmi);
> -DEFINE_INFOFRAME_FILE(hdr_drm);
> -DEFINE_INFOFRAME_FILE(spd);
> +DEFINE_INFOFRAME_FILE(avi, AVI);
> +DEFINE_INFOFRAME_FILE(hdmi, VENDOR);
> +DEFINE_INFOFRAME_FILE(hdr_drm, DRM);
> +DEFINE_INFOFRAME_FILE(spd, SPD);
>  
>  static int create_hdmi_infoframe_files(struct drm_connector *connector,
>  				       struct dentry *parent)
> diff --git a/drivers/gpu/drm/rockchip/inno_hdmi.c b/drivers/gpu/drm/rockchip/inno_hdmi.c
> index 1ab3ad4bde9ea7305021186ea221d2ff9057fdbb..65eed5ae23194200c145cb174acff4f252b3ef1f 100644
> --- a/drivers/gpu/drm/rockchip/inno_hdmi.c
> +++ b/drivers/gpu/drm/rockchip/inno_hdmi.c
> @@ -1065,6 +1065,7 @@ static int inno_hdmi_register(struct drm_device *drm, struct inno_hdmi *hdmi)
>  				 DRM_MODE_CONNECTOR_HDMIA,
>  				 hdmi->ddc,
>  				 BIT(HDMI_COLORSPACE_RGB),
> +				 DRM_CONNECTOR_INFOFRAME_AVI,
>  				 8);
>  
>  	drm_connector_attach_encoder(&hdmi->connector, encoder);
> diff --git a/drivers/gpu/drm/sun4i/sun4i_hdmi_enc.c b/drivers/gpu/drm/sun4i/sun4i_hdmi_enc.c
> index ab0938ba61f7d75dd0bec473807a04a20e1cffbd..0b931da4ea2d4eb58a6224476059b9205e8626b4 100644
> --- a/drivers/gpu/drm/sun4i/sun4i_hdmi_enc.c
> +++ b/drivers/gpu/drm/sun4i/sun4i_hdmi_enc.c
> @@ -640,6 +640,7 @@ static int sun4i_hdmi_bind(struct device *dev, struct device *master,
>  				       DRM_MODE_CONNECTOR_HDMIA,
>  				       hdmi->ddc_i2c,
>  				       BIT(HDMI_COLORSPACE_RGB),
> +				       DRM_CONNECTOR_INFOFRAME_AVI,
>  				       8);
>  	if (ret) {
>  		dev_err(dev,
> diff --git a/drivers/gpu/drm/tests/drm_connector_test.c b/drivers/gpu/drm/tests/drm_connector_test.c
> index 22e2d959eb31459f9981fef488228904d67cb6f9..fd28ed2bf8bcecabaabc67f2f8f5ccc1f42525d3 100644
> --- a/drivers/gpu/drm/tests/drm_connector_test.c
> +++ b/drivers/gpu/drm/tests/drm_connector_test.c
> @@ -641,6 +641,13 @@ static struct kunit_suite drm_connector_dynamic_register_test_suite = {
>  	.test_cases = drm_connector_dynamic_register_tests,
>  };
>  
> +#define DRM_CONNECTOR_ALL_INFOFRAMES \
> +	(DRM_CONNECTOR_INFOFRAME_AUDIO | \
> +	 DRM_CONNECTOR_INFOFRAME_AVI | \
> +	 DRM_CONNECTOR_INFOFRAME_DRM | \
> +	 DRM_CONNECTOR_INFOFRAME_SPD | \
> +	 DRM_CONNECTOR_INFOFRAME_VENDOR)
> +
>  /*
>   * Test that the registration of a bog standard connector works as
>   * expected and doesn't report any error.
> @@ -657,6 +664,7 @@ static void drm_test_connector_hdmi_init_valid(struct kunit *test)
>  				       DRM_MODE_CONNECTOR_HDMIA,
>  				       &priv->ddc,
>  				       BIT(HDMI_COLORSPACE_RGB),
> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>  				       8);
>  	KUNIT_EXPECT_EQ(test, ret, 0);
>  }
> @@ -677,6 +685,7 @@ static void drm_test_connector_hdmi_init_null_ddc(struct kunit *test)
>  				       DRM_MODE_CONNECTOR_HDMIA,
>  				       NULL,
>  				       BIT(HDMI_COLORSPACE_RGB),
> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>  				       8);
>  	KUNIT_EXPECT_EQ(test, ret, 0);
>  }
> @@ -697,6 +706,7 @@ static void drm_test_connector_hdmi_init_null_vendor(struct kunit *test)
>  				       DRM_MODE_CONNECTOR_HDMIA,
>  				       &priv->ddc,
>  				       BIT(HDMI_COLORSPACE_RGB),
> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>  				       8);
>  	KUNIT_EXPECT_LT(test, ret, 0);
>  }
> @@ -717,6 +727,7 @@ static void drm_test_connector_hdmi_init_null_product(struct kunit *test)
>  				       DRM_MODE_CONNECTOR_HDMIA,
>  				       &priv->ddc,
>  				       BIT(HDMI_COLORSPACE_RGB),
> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>  				       8);
>  	KUNIT_EXPECT_LT(test, ret, 0);
>  }
> @@ -743,6 +754,7 @@ static void drm_test_connector_hdmi_init_product_valid(struct kunit *test)
>  				       DRM_MODE_CONNECTOR_HDMIA,
>  				       &priv->ddc,
>  				       BIT(HDMI_COLORSPACE_RGB),
> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>  				       8);
>  	KUNIT_EXPECT_EQ(test, ret, 0);
>  	KUNIT_EXPECT_MEMEQ(test,
> @@ -776,6 +788,7 @@ static void drm_test_connector_hdmi_init_product_length_exact(struct kunit *test
>  				       DRM_MODE_CONNECTOR_HDMIA,
>  				       &priv->ddc,
>  				       BIT(HDMI_COLORSPACE_RGB),
> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>  				       8);
>  	KUNIT_EXPECT_EQ(test, ret, 0);
>  	KUNIT_EXPECT_MEMEQ(test,
> @@ -803,6 +816,7 @@ static void drm_test_connector_hdmi_init_product_length_too_long(struct kunit *t
>  				       DRM_MODE_CONNECTOR_HDMIA,
>  				       &priv->ddc,
>  				       BIT(HDMI_COLORSPACE_RGB),
> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>  				       8);
>  	KUNIT_EXPECT_LT(test, ret, 0);
>  }
> @@ -829,6 +843,7 @@ static void drm_test_connector_hdmi_init_vendor_valid(struct kunit *test)
>  				       DRM_MODE_CONNECTOR_HDMIA,
>  				       &priv->ddc,
>  				       BIT(HDMI_COLORSPACE_RGB),
> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>  				       8);
>  	KUNIT_EXPECT_EQ(test, ret, 0);
>  	KUNIT_EXPECT_MEMEQ(test,
> @@ -861,6 +876,7 @@ static void drm_test_connector_hdmi_init_vendor_length_exact(struct kunit *test)
>  				       DRM_MODE_CONNECTOR_HDMIA,
>  				       &priv->ddc,
>  				       BIT(HDMI_COLORSPACE_RGB),
> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>  				       8);
>  	KUNIT_EXPECT_EQ(test, ret, 0);
>  	KUNIT_EXPECT_MEMEQ(test,
> @@ -888,6 +904,7 @@ static void drm_test_connector_hdmi_init_vendor_length_too_long(struct kunit *te
>  				       DRM_MODE_CONNECTOR_HDMIA,
>  				       &priv->ddc,
>  				       BIT(HDMI_COLORSPACE_RGB),
> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>  				       8);
>  	KUNIT_EXPECT_LT(test, ret, 0);
>  }
> @@ -908,6 +925,7 @@ static void drm_test_connector_hdmi_init_bpc_invalid(struct kunit *test)
>  				       DRM_MODE_CONNECTOR_HDMIA,
>  				       &priv->ddc,
>  				       BIT(HDMI_COLORSPACE_RGB),
> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>  				       9);
>  	KUNIT_EXPECT_LT(test, ret, 0);
>  }
> @@ -928,6 +946,7 @@ static void drm_test_connector_hdmi_init_bpc_null(struct kunit *test)
>  				       DRM_MODE_CONNECTOR_HDMIA,
>  				       &priv->ddc,
>  				       BIT(HDMI_COLORSPACE_RGB),
> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>  				       0);
>  	KUNIT_EXPECT_LT(test, ret, 0);
>  }
> @@ -953,6 +972,7 @@ static void drm_test_connector_hdmi_init_bpc_8(struct kunit *test)
>  				       DRM_MODE_CONNECTOR_HDMIA,
>  				       &priv->ddc,
>  				       BIT(HDMI_COLORSPACE_RGB),
> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>  				       8);
>  	KUNIT_EXPECT_EQ(test, ret, 0);
>  
> @@ -994,6 +1014,7 @@ static void drm_test_connector_hdmi_init_bpc_10(struct kunit *test)
>  				       DRM_MODE_CONNECTOR_HDMIA,
>  				       &priv->ddc,
>  				       BIT(HDMI_COLORSPACE_RGB),
> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>  				       10);
>  	KUNIT_EXPECT_EQ(test, ret, 0);
>  
> @@ -1035,6 +1056,7 @@ static void drm_test_connector_hdmi_init_bpc_12(struct kunit *test)
>  				       DRM_MODE_CONNECTOR_HDMIA,
>  				       &priv->ddc,
>  				       BIT(HDMI_COLORSPACE_RGB),
> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>  				       12);
>  	KUNIT_EXPECT_EQ(test, ret, 0);
>  
> @@ -1071,6 +1093,7 @@ static void drm_test_connector_hdmi_init_formats_empty(struct kunit *test)
>  				       DRM_MODE_CONNECTOR_HDMIA,
>  				       &priv->ddc,
>  				       0,
> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>  				       8);
>  	KUNIT_EXPECT_LT(test, ret, 0);
>  }
> @@ -1091,6 +1114,7 @@ static void drm_test_connector_hdmi_init_formats_no_rgb(struct kunit *test)
>  				       DRM_MODE_CONNECTOR_HDMIA,
>  				       &priv->ddc,
>  				       BIT(HDMI_COLORSPACE_YUV422),
> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>  				       8);
>  	KUNIT_EXPECT_LT(test, ret, 0);
>  }
> @@ -1149,6 +1173,7 @@ static void drm_test_connector_hdmi_init_formats_yuv420_allowed(struct kunit *te
>  				       DRM_MODE_CONNECTOR_HDMIA,
>  				       &priv->ddc,
>  				       params->supported_formats,
> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>  				       8);
>  	KUNIT_EXPECT_EQ(test, ret, params->expected_result);
>  }
> @@ -1170,6 +1195,7 @@ static void drm_test_connector_hdmi_init_type_valid(struct kunit *test)
>  				       connector_type,
>  				       &priv->ddc,
>  				       BIT(HDMI_COLORSPACE_RGB),
> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>  				       8);
>  	KUNIT_EXPECT_EQ(test, ret, 0);
>  }
> @@ -1205,6 +1231,7 @@ static void drm_test_connector_hdmi_init_type_invalid(struct kunit *test)
>  				       connector_type,
>  				       &priv->ddc,
>  				       BIT(HDMI_COLORSPACE_RGB),
> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>  				       8);
>  	KUNIT_EXPECT_LT(test, ret, 0);
>  }
> @@ -1482,6 +1509,7 @@ static void drm_test_drm_connector_attach_broadcast_rgb_property_hdmi_connector(
>  				       DRM_MODE_CONNECTOR_HDMIA,
>  				       &priv->ddc,
>  				       BIT(HDMI_COLORSPACE_RGB),
> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>  				       8);
>  	KUNIT_EXPECT_EQ(test, ret, 0);
>  
> diff --git a/drivers/gpu/drm/tests/drm_hdmi_state_helper_test.c b/drivers/gpu/drm/tests/drm_hdmi_state_helper_test.c
> index 8bd412735000cb18e66aeca21433b2ebbefe2b44..2901fcb6b12ee318a4a9c727a62d5290d7c9aa84 100644
> --- a/drivers/gpu/drm/tests/drm_hdmi_state_helper_test.c
> +++ b/drivers/gpu/drm/tests/drm_hdmi_state_helper_test.c
> @@ -138,6 +138,13 @@ static const struct drm_connector_funcs dummy_connector_funcs = {
>  	.reset			= dummy_hdmi_connector_reset,
>  };
>  
> +#define DRM_CONNECTOR_ALL_INFOFRAMES \
> +	(DRM_CONNECTOR_INFOFRAME_AUDIO | \
> +	 DRM_CONNECTOR_INFOFRAME_AVI | \
> +	 DRM_CONNECTOR_INFOFRAME_DRM | \
> +	 DRM_CONNECTOR_INFOFRAME_SPD | \
> +	 DRM_CONNECTOR_INFOFRAME_VENDOR)
> +
>  static
>  struct drm_atomic_helper_connector_hdmi_priv *
>  __connector_hdmi_init(struct kunit *test,
> @@ -192,6 +199,7 @@ __connector_hdmi_init(struct kunit *test,
>  				       DRM_MODE_CONNECTOR_HDMIA,
>  				       NULL,
>  				       formats,
> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>  				       max_bpc);
>  	KUNIT_ASSERT_EQ(test, ret, 0);
>  
> diff --git a/drivers/gpu/drm/vc4/vc4_hdmi.c b/drivers/gpu/drm/vc4/vc4_hdmi.c
> index 07c91b450f93ab9e795d040d6f60f485ac71cfe8..f7024fd554e04dbfa38d24f775ec5993ac8db335 100644
> --- a/drivers/gpu/drm/vc4/vc4_hdmi.c
> +++ b/drivers/gpu/drm/vc4/vc4_hdmi.c
> @@ -556,6 +556,10 @@ static int vc4_hdmi_connector_init(struct drm_device *dev,
>  				       BIT(HDMI_COLORSPACE_RGB) |
>  				       BIT(HDMI_COLORSPACE_YUV422) |
>  				       BIT(HDMI_COLORSPACE_YUV444),
> +				       DRM_CONNECTOR_INFOFRAME_AVI |
> +				       DRM_CONNECTOR_INFOFRAME_DRM |
> +				       DRM_CONNECTOR_INFOFRAME_SPD |
> +				       DRM_CONNECTOR_INFOFRAME_VENDOR,

I see vc4_hdmi.c calls drm_connector_hdmi_audio_init() (though calls it
twice...) and hence drm_atomic_helper_connector_hdmi_update_audio_infoframe(),
so this mask should be DRM_CONNECTOR_ALL_INFOFRAMES as vc4 HDMI seems support
audio infoframe?

However, vc4_hdmi_audio_init() could return early with 0 before calling
drm_connector_hdmi_audio_init().

>  				       max_bpc);
>  	if (ret)
>  		return ret;
> diff --git a/include/drm/drm_bridge.h b/include/drm/drm_bridge.h
> index 620e119cc24c3491c2be5f08efaf51dfa8f708b3..529dcaca1d7924da12d9587170f96ec6a00ad126 100644
> --- a/include/drm/drm_bridge.h
> +++ b/include/drm/drm_bridge.h
> @@ -1153,6 +1153,13 @@ struct drm_bridge {
>  	 */
>  	unsigned int max_bpc;
>  
> +	/**
> +	 * @supported_infoframes: Bitmask of DRM_CONNECTOR_INFOFRAME values,
> +	 * listing supported infoframes. This is only relevant if
> +	 * @DRM_BRIDGE_OP_HDMI is set.
> +	 */
> +	unsigned int supported_infoframes;
> +
>  	/**
>  	 * @hdmi_cec_dev: device to be used as a containing device for CEC
>  	 * functions.
> diff --git a/include/drm/drm_connector.h b/include/drm/drm_connector.h
> index 8f34f4b8183d83dccd3e820a444fbf74fb6c16f2..5b4bc1d7d566d28f90f0aa342a1258685dda6bd0 100644
> --- a/include/drm/drm_connector.h
> +++ b/include/drm/drm_connector.h
> @@ -1839,6 +1839,12 @@ struct drm_connector_hdmi {
>  	 */
>  	unsigned long supported_formats;
>  
> +	/**
> +	 * @supported_infoframes: Bitmask of infoframe types supported by the
> +	 * controller. See @DRM_CONNECTOR_INFOFRAME.
> +	 */
> +	unsigned long supported_infoframes;
> +
>  	/**
>  	 * @funcs: HDMI connector Control Functions
>  	 */
> @@ -2336,6 +2342,7 @@ int drmm_connector_hdmi_init(struct drm_device *dev,
>  			     int connector_type,
>  			     struct i2c_adapter *ddc,
>  			     unsigned long supported_formats,
> +			     unsigned long supported_infoframes,
>  			     unsigned int max_bpc);
>  void drm_connector_attach_edid_property(struct drm_connector *connector);
>  int drm_connector_register(struct drm_connector *connector);
> @@ -2488,6 +2495,22 @@ void drm_connector_attach_privacy_screen_provider(
>  	struct drm_connector *connector, struct drm_privacy_screen *priv);
>  void drm_connector_update_privacy_screen(const struct drm_connector_state *connector_state);
>  
> +#define DRM_CONNECTOR_INFOFRAME(type)	\
> +	BIT(type - 0x80)

Nit: the above two lines fit into one single line.  I'd write:

#define DRM_CONNECTOR_INFOFRAME(type)  BIT((type) - 0x80)

> +
> +#define DRM_CONNECTOR_INFOFRAME_AUDIO DRM_CONNECTOR_INFOFRAME(HDMI_INFOFRAME_TYPE_AUDIO)
> +#define DRM_CONNECTOR_INFOFRAME_AVI DRM_CONNECTOR_INFOFRAME(HDMI_INFOFRAME_TYPE_AVI)
> +#define DRM_CONNECTOR_INFOFRAME_DRM DRM_CONNECTOR_INFOFRAME(HDMI_INFOFRAME_TYPE_DRM)
> +#define DRM_CONNECTOR_INFOFRAME_SPD DRM_CONNECTOR_INFOFRAME(HDMI_INFOFRAME_TYPE_SPD)
> +#define DRM_CONNECTOR_INFOFRAME_VENDOR DRM_CONNECTOR_INFOFRAME(HDMI_INFOFRAME_TYPE_VENDOR)

Can you align the above macro definitions vertically?

> +
> +static inline bool
> +drm_hdmi_connector_supports_infoframe(const struct drm_connector *connector,
> +				      enum hdmi_infoframe_type type)
> +{
> +	return connector->hdmi.supported_infoframes & DRM_CONNECTOR_INFOFRAME(type);
> +}
> +
>  /**
>   * struct drm_tile_group - Tile group metadata
>   * @refcount: reference count
> 


-- 
Regards,
Liu Ying

From mboxrd@z Thu Jan  1 00:00:00 1970
Received: from mx0b-0031df01.pphosted.com (mx0b-0031df01.pphosted.com [205.220.180.131])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by smtp.subspace.kernel.org (Postfix) with ESMTPS id B7DE32E1C4C
	for <linux-sunxi@lists.linux.dev>; Sat, 16 Aug 2025 12:41:19 +0000 (UTC)
Authentication-Results: smtp.subspace.kernel.org; arc=none smtp.client-ip=205.220.180.131
ARC-Seal: i=1; a=rsa-sha256; d=subspace.kernel.org; s=arc-20240116;
	t=1755348081; cv=none; b=Ze6dLcmG+5+B4ArWRdt9EmfneTwpfJRA3mx5VjVqXP90aC41kFyvHUnSX3ZPKgqFbAmW94pkMB745Rhvppj7fam2tuysiCFPcW/CnLxH5rSxXcLBT533NupKBUAR9YQlHVh+ndnwq+592c3hr1qmO0JpnwQo1vQQ69zHzZeaIOI=
ARC-Message-Signature: i=1; a=rsa-sha256; d=subspace.kernel.org;
	s=arc-20240116; t=1755348081; c=relaxed/simple;
	bh=7pF6L0JAujP/P/iu+e8rZjaaHJekyZiCiogkcTbsoPg=;
	h=From:Date:Subject:MIME-Version:Content-Type:Message-Id:References:
	 In-Reply-To:To:Cc; b=kBmnpE8VDeX1plrLEebMUQyWzWI/203SaBcyuEtE7lynjuk4/XmN1xFky4FGkPvvsNdeiSYC46mpiTR/+bMWxX78dY7CQXjgl673NbK6j8Tdp9NV7XY+GrxHzlaLWshzY2R3sx4csJO6OKVLqEifIfy/p9RLeLmx0PDkLHNZNcw=
ARC-Authentication-Results: i=1; smtp.subspace.kernel.org; dmarc=pass (p=reject dis=none) header.from=oss.qualcomm.com; spf=pass smtp.mailfrom=oss.qualcomm.com; dkim=pass (2048-bit key) header.d=qualcomm.com header.i=@qualcomm.com header.b=jqLHGpE0; arc=none smtp.client-ip=205.220.180.131
Authentication-Results: smtp.subspace.kernel.org; dmarc=pass (p=reject dis=none) header.from=oss.qualcomm.com
Authentication-Results: smtp.subspace.kernel.org; spf=pass smtp.mailfrom=oss.qualcomm.com
Authentication-Results: smtp.subspace.kernel.org;
	dkim=pass (2048-bit key) header.d=qualcomm.com header.i=@qualcomm.com header.b="jqLHGpE0"
Received: from pps.filterd (m0279871.ppops.net [127.0.0.1])
	by mx0a-0031df01.pphosted.com (8.18.1.2/8.18.1.2) with ESMTP id 57G8D6iv004986
	for <linux-sunxi@lists.linux.dev>; Sat, 16 Aug 2025 12:41:18 GMT
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=qualcomm.com; h=
	cc:content-transfer-encoding:content-type:date:from:in-reply-to
	:message-id:mime-version:references:subject:to; s=qcppdkim1; bh=
	XTXVZvn8yUTRjhlUwhGxkNee4aGkCZL4GH6QswhQXtc=; b=jqLHGpE0SrHzaNJq
	HvY2s9Lj//kd9ayUo5T8OPj3AhPzFYl9txS7IMbRPU6RzZqt7+fOMKaxzl4F0JL3
	Md4gtCfPBc9J/5TRiTPEEM+9mGTQrg/qRYFui3MXwYXZxi3zPK8yoYlCfZb1HEbg
	XtlcCpSqyIK9ffm6ojJhBnZ5mo5CX+YsJNiTP83oDfa0EJQ+gkujL1jHhB/KvTFB
	0+vgn93l7RW6eJDlAObxdXaXQcIRrCfblub6BEsh4qUsvOUhlSJl702OXvDC8O4z
	15EzQytH+vqquTtxAYCXYM/iv1pXpBhw7joL77Ui1p9iv2lFToHf+0EgAxEhtHNA
	+ErGiw==
Received: from mail-qv1-f71.google.com (mail-qv1-f71.google.com [209.85.219.71])
	by mx0a-0031df01.pphosted.com (PPS) with ESMTPS id 48jhjy8p1c-1
	(version=TLSv1.2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128 verify=NOT)
	for <linux-sunxi@lists.linux.dev>; Sat, 16 Aug 2025 12:41:18 +0000 (GMT)
Received: by mail-qv1-f71.google.com with SMTP id 6a1803df08f44-70a9f5b078bso29590616d6.3
        for <linux-sunxi@lists.linux.dev>; Sat, 16 Aug 2025 05:41:18 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20230601; t=1755348078; x=1755952878;
        h=cc:to:in-reply-to:references:message-id:content-transfer-encoding
         :mime-version:subject:date:from:x-gm-message-state:from:to:cc
         :subject:date:message-id:reply-to;
        bh=XTXVZvn8yUTRjhlUwhGxkNee4aGkCZL4GH6QswhQXtc=;
        b=vYw2azouhuO0kFGmcvUSBvSSjxpLdw/7AfKSGOSfAhs9lQJpc1HDkzUJTaXKIMkPoW
         e+9jhN+A6NBeg2MqfLDF0i1QX3IWMzx632q24NUB/WshvIdEn8zV6D6h204h/2M/Wg4k
         vm0OLqNdaq4by2jKz0DdSpI+dGv1DzkLhexQpmQjYxsDP3tNx/mJGVhQr9q61CpCldn0
         NYfz3108v1acZwIIYlRvQw6obxZFM3FbFR4ufjenuyZdAmXnVHB/rNi+TeFUP2o90qO6
         tB/MoK/+IGy3VgRuipPWFIXgZNPuX1qocM6ylSFxDb/md2z/hvolm70yqkE/4y2bCxDz
         b60g==
X-Forwarded-Encrypted: i=1; AJvYcCWiWzYdDQEBNHUza5sRDYj3cp6kGd0EtCLUne5AuY6mkrNIDyTD84eQJfExIFJQWwKN1zGp6EeLnfWQdA==@lists.linux.dev
X-Gm-Message-State: AOJu0Yzx1AFHeezvE/WZRDcr/wPW9gLosDdoL32/Qj+evUHCRSNLlr5B
	c7wMMvurS4pWwPMttFWu6Ac9KC5hPHco94yaI8MgQ/JVaCVpZlGLJMbAvv1wWhg5HNWDma67bfX
	Lbk1VYYwOMg0ZFrLacf5tmXORGwBbfzqTAzqcdO0BolSFHRD6+ZY6mxYDAae2dg1IMw==
X-Gm-Gg: ASbGncs5rLNXEiZkCj2QrQnU1l4tZdnE8+BF51kG5SRGPjtaEYIdnVxuqMVgy2vec8F
	U7E54yyhFg/OqiRiIraV7ux7F7uAP20SU8yCGhpxMHiTAaaXuejdmGiT8x1gqxY0Gk50jTAZ7iG
	rMktYn9z9CnenLEABp52a0ZStLe2qC6isz9yMJJ6AdTuda5qv0rL5E7ND2Eo5u+RcddJVuFI9U4
	bQK89iQH9JcHXzh5QdcBUsYT0dexviQeKSTwMvh+8wCNJi2BL15b4zrRSN7OZwheW8Z7BTKNRCd
	gOrdgjo3ltqFT8iCLWGBGmHpjvo2ws7PX2SmBTzBETHqj5h5Q+pLBq+TVkeUGInow2l01Y3j++X
	kH3a9Nl9jp0G5yhnCtkRXc95gLcY1iMY6fGxocEXoPc/r2TisdqHq
X-Received: by 2002:a05:6214:c43:b0:70b:a22f:cbe5 with SMTP id 6a1803df08f44-70ba7ae7e3bmr68367356d6.11.1755348077619;
        Sat, 16 Aug 2025 05:41:17 -0700 (PDT)
X-Google-Smtp-Source: AGHT+IEKYA0jwLaGI60dgIdc5xLLC6MrgAPeHvs5XeZskw9tq2JN3MW49DplYWInTes5Xz+UumyLaw==
X-Received: by 2002:a05:6214:c43:b0:70b:a22f:cbe5 with SMTP id 6a1803df08f44-70ba7ae7e3bmr68366726d6.11.1755348077082;
        Sat, 16 Aug 2025 05:41:17 -0700 (PDT)
Received: from umbar.lan (2001-14ba-a0c3-3a00-264b-feff-fe8b-be8a.rev.dnainternet.fi. [2001:14ba:a0c3:3a00:264b:feff:fe8b:be8a])
        by smtp.gmail.com with ESMTPSA id 2adb3069b0e04-55cef3cca21sm856554e87.104.2025.08.16.05.41.15
        (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
        Sat, 16 Aug 2025 05:41:16 -0700 (PDT)
From: Dmitry Baryshkov <dmitry.baryshkov@oss.qualcomm.com>
Date: Sat, 16 Aug 2025 15:41:06 +0300
Subject: [PATCH 6/7] drm/msm: hdmi: declare supported infoframes
Precedence: bulk
X-Mailing-List: linux-sunxi@lists.linux.dev
List-Id: <linux-sunxi.lists.linux.dev>
List-Subscribe: <mailto:linux-sunxi+subscribe@lists.linux.dev>
List-Unsubscribe: <mailto:linux-sunxi+unsubscribe@lists.linux.dev>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: 7bit
Message-Id: <20250816-drm-limit-infoframes-v1-6-6dc17d5f07e9@oss.qualcomm.com>
References: <20250816-drm-limit-infoframes-v1-0-6dc17d5f07e9@oss.qualcomm.com>
In-Reply-To: <20250816-drm-limit-infoframes-v1-0-6dc17d5f07e9@oss.qualcomm.com>
To: Andrzej Hajda <andrzej.hajda@intel.com>,
        Neil Armstrong <neil.armstrong@linaro.org>,
        Robert Foss <rfoss@kernel.org>,
        Laurent Pinchart <Laurent.pinchart@ideasonboard.com>,
        Jonas Karlman <jonas@kwiboo.se>,
        Jernej Skrabec <jernej.skrabec@gmail.com>,
        Maarten Lankhorst <maarten.lankhorst@linux.intel.com>,
        Maxime Ripard <mripard@kernel.org>,
        Thomas Zimmermann <tzimmermann@suse.de>,
        David Airlie <airlied@gmail.com>, Simona Vetter <simona@ffwll.ch>,
        Sandy Huang <hjc@rock-chips.com>,
        =?utf-8?q?Heiko_St=C3=BCbner?= <heiko@sntech.de>,
        Andy Yan <andy.yan@rock-chips.com>, Chen-Yu Tsai <wens@csie.org>,
        Samuel Holland <samuel@sholland.org>,
        Dave Stevenson <dave.stevenson@raspberrypi.com>,
        =?utf-8?q?Ma=C3=ADra_Canal?= <mcanal@igalia.com>,
        Raspberry Pi Kernel Maintenance <kernel-list@raspberrypi.com>,
        Liu Ying <victor.liu@nxp.com>,
        Rob Clark <robin.clark@oss.qualcomm.com>,
        Dmitry Baryshkov <lumag@kernel.org>,
        Abhinav Kumar <abhinav.kumar@linux.dev>,
        Jessica Zhang <jessica.zhang@oss.qualcomm.com>,
        Sean Paul <sean@poorly.run>,
        Marijn Suijten <marijn.suijten@somainline.org>
Cc: dri-devel@lists.freedesktop.org, linux-kernel@vger.kernel.org,
        linux-arm-kernel@lists.infradead.org,
        linux-rockchip@lists.infradead.org, linux-sunxi@lists.linux.dev,
        linux-arm-msm@vger.kernel.org, freedreno@lists.freedesktop.org
X-Mailer: b4 0.14.2
X-Developer-Signature: v=1; a=openpgp-sha256; l=980;
 i=dmitry.baryshkov@oss.qualcomm.com; h=from:subject:message-id;
 bh=7pF6L0JAujP/P/iu+e8rZjaaHJekyZiCiogkcTbsoPg=;
 b=owEBbQGS/pANAwAKAYs8ij4CKSjVAcsmYgBooHxffZfdznR46omAz//o0FIm9ItgOJjoSW5dR
 tFCoAWaxwaJATMEAAEKAB0WIQRMcISVXLJjVvC4lX+LPIo+Aiko1QUCaKB8XwAKCRCLPIo+Aiko
 1SJzB/9MbWkK1MsjNZOw3lcgrUqwdBEMotBk7PI88jIMb49m3q6pi1Ic+1OcZvMxbYHJ5ytFdOB
 99dkv7TMYuHpQwf5giIywYfwW0VuZrDAcFtTbCfvYKHASIQirPoDKIEhTcdtUUOtb2/ESl2OGr3
 yx1San5Qryx+TcnSV2oMfEjDBWqbisypv5F1qp6+85hJmN+eLfDeUNpy9whi3ZoY68pGFz7lzsi
 oCs8KusSv648XcZU8I8UwAZJVJBCPgNenSw72lah8u8Xd/o+1ZjHr39EmwY5SvvgFZNkRmzZSBy
 H/EjRxLrBHRVWid9aiI3/8ORFSsfpCh8JNlsgRLNo2FEBcrx
X-Developer-Key: i=dmitry.baryshkov@oss.qualcomm.com; a=openpgp;
 fpr=8F88381DD5C873E4AE487DA5199BF1243632046A
X-Proofpoint-ORIG-GUID: Xe-wzhFRYyKrHwAuq849Ih8OI2Xevn8m
X-Authority-Analysis: v=2.4 cv=ZJHXmW7b c=1 sm=1 tr=0 ts=68a07c6e cx=c_pps
 a=UgVkIMxJMSkC9lv97toC5g==:117 a=xqWC_Br6kY4A:10 a=IkcTkHD0fZMA:10
 a=2OwXVqhp2XgA:10 a=EUspDBNiAAAA:8 a=gXnERKRtccFGBIMzwWQA:9 a=QEXdDO2ut3YA:10
 a=1HOtulTD9v-eNWfpl4qZ:22
X-Proofpoint-GUID: Xe-wzhFRYyKrHwAuq849Ih8OI2Xevn8m
X-Proofpoint-Spam-Details-Enc: AW1haW4tMjUwODE2MDAyOCBTYWx0ZWRfX1+6gF9249VKA
 Tuon1yvbpkxfNe7OoNkcuPKYv3dKCPrz0QQP9aK5ChHgtBjhvuQqxcIiS/Nr2mm6LRFjVMEd45C
 mmx9HSGDZ3zmyC0UKjcAlzA/IE7uedp3nQeiUpKoO7ok9o91Skvq20WT6+bnmogWyzMgSTOgNyS
 OHV8U5D2VkpNBP7qw7dv0fLNTVHTKEygQydWz8FZ52GIZnGsuPWx2IrMawaRmJ8OdRQCisn1+9B
 uikMUQ2lDGpIRL5yURQPJ5PcoL8aIcUv1FS3oREWjjK9F7/CJahacshJkNtSMnmV7yt42VhHeR3
 uqsuxydVX/OqomMMrXuSuyoCVAgCv9htN3RqbGxIaap4plNZXZOpbPLyPpaBYVAXfq3QhK6rQzu
 vh3g8NGq
X-Proofpoint-Virus-Version: vendor=baseguard
 engine=ICAP:2.0.293,Aquarius:18.0.1099,Hydra:6.1.9,FMLib:17.12.80.40
 definitions=2025-08-16_04,2025-08-14_01,2025-03-28_01
X-Proofpoint-Spam-Details: rule=outbound_notspam policy=outbound score=0
 malwarescore=0 adultscore=0 phishscore=0 suspectscore=0 clxscore=1015
 bulkscore=0 spamscore=0 impostorscore=0 priorityscore=1501
 classifier=typeunknown authscore=0 authtc= authcc= route=outbound adjust=0
 reason=mlx scancount=1 engine=8.19.0-2507300000 definitions=main-2508160028

Declare which infoframes are supported via the .hdmi_write_infoframe()
interface.

Signed-off-by: Dmitry Baryshkov <dmitry.baryshkov@oss.qualcomm.com>
---
 drivers/gpu/drm/msm/hdmi/hdmi_bridge.c | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/drivers/gpu/drm/msm/hdmi/hdmi_bridge.c b/drivers/gpu/drm/msm/hdmi/hdmi_bridge.c
index 46fd58646d32fd0611192595826a3aa680bd0d02..aa36d203f38f0f5a197afa8493fafb20cdc43476 100644
--- a/drivers/gpu/drm/msm/hdmi/hdmi_bridge.c
+++ b/drivers/gpu/drm/msm/hdmi/hdmi_bridge.c
@@ -498,6 +498,10 @@ int msm_hdmi_bridge_init(struct hdmi *hdmi)
 	bridge->type = DRM_MODE_CONNECTOR_HDMIA;
 	bridge->vendor = "Qualcomm";
 	bridge->product = "Snapdragon";
+	bridge->supported_infoframes = DRM_CONNECTOR_INFOFRAME_AVI |
+		DRM_CONNECTOR_INFOFRAME_AUDIO |
+		DRM_CONNECTOR_INFOFRAME_SPD |
+		DRM_CONNECTOR_INFOFRAME_VENDOR;
 	bridge->ops = DRM_BRIDGE_OP_HPD |
 		DRM_BRIDGE_OP_DETECT |
 		DRM_BRIDGE_OP_HDMI |

-- 
2.47.2


From mboxrd@z Thu Jan  1 00:00:00 1970
Received: from mx0a-0031df01.pphosted.com (mx0a-0031df01.pphosted.com [205.220.168.131])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by smtp.subspace.kernel.org (Postfix) with ESMTPS id 6186D2E36ED
	for <linux-sunxi@lists.linux.dev>; Sat, 16 Aug 2025 12:41:16 +0000 (UTC)
Authentication-Results: smtp.subspace.kernel.org; arc=none smtp.client-ip=205.220.168.131
ARC-Seal: i=1; a=rsa-sha256; d=subspace.kernel.org; s=arc-20240116;
	t=1755348081; cv=none; b=oxZ3qOJeR6TLr5KNa43STPhIk+gYRaDeNK+dQQEJ17ozb9TJVVsk5zU4KJT97m+Uz3A37CwVqtL83QgMpS5Ek1QOFP6OHDA4bp6D2pSrvLYW7QgyUYn7z+MEwBMz2QGhhSuwyMoWBOoJLZZkcvbS/umj0SGLU1/FkEphYH5qKzE=
ARC-Message-Signature: i=1; a=rsa-sha256; d=subspace.kernel.org;
	s=arc-20240116; t=1755348081; c=relaxed/simple;
	bh=ics5UJu435PTkR3N2XAnDPkmPWB0LL/sCgBg7ErLZlw=;
	h=From:Date:Subject:MIME-Version:Content-Type:Message-Id:References:
	 In-Reply-To:To:Cc; b=JR4lErEWK3NOvtRu/0kbIVxxq5vMn+vRWLPFjYcK5r2ReZEd2D08jvqP1PtWm/nSONbIieQgQwYMmCpKGOYbsLZg2J6nmFGh+YFU91B+4Q2zLngTESv3jbYy3SC1wPWmd8BUkZQn6aOEO4okUgW+85nfvQ9XoNlxabquDWk00aM=
ARC-Authentication-Results: i=1; smtp.subspace.kernel.org; dmarc=pass (p=reject dis=none) header.from=oss.qualcomm.com; spf=pass smtp.mailfrom=oss.qualcomm.com; dkim=pass (2048-bit key) header.d=qualcomm.com header.i=@qualcomm.com header.b=BzF61BOf; arc=none smtp.client-ip=205.220.168.131
Authentication-Results: smtp.subspace.kernel.org; dmarc=pass (p=reject dis=none) header.from=oss.qualcomm.com
Authentication-Results: smtp.subspace.kernel.org; spf=pass smtp.mailfrom=oss.qualcomm.com
Authentication-Results: smtp.subspace.kernel.org;
	dkim=pass (2048-bit key) header.d=qualcomm.com header.i=@qualcomm.com header.b="BzF61BOf"
Received: from pps.filterd (m0279866.ppops.net [127.0.0.1])
	by mx0a-0031df01.pphosted.com (8.18.1.2/8.18.1.2) with ESMTP id 57G4lnQu031013
	for <linux-sunxi@lists.linux.dev>; Sat, 16 Aug 2025 12:41:10 GMT
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=qualcomm.com; h=
	cc:content-transfer-encoding:content-type:date:from:in-reply-to
	:message-id:mime-version:references:subject:to; s=qcppdkim1; bh=
	TBBRBvbZmhS5MEDtIi65bqiX0+TlTd1eeG9t75hRPEA=; b=BzF61BOfHC/Wx1vM
	JMbO+2U9ceQC6hSZZqpe2WMC+JYUUEUgHqmV2su1bxNxoKe47vYUAbfiWfx2acoN
	pZAWVO9TtuTS5hcedjk4ESPa3OPqJqQsWJLC9CKb64lNo8sW2j3qSTCpYDoAInI5
	RTkRAaciWPSackxvFAjSLUACz2fLhcGxoiAcZeGcZuWAxtMtFWl1sTkFIKsdOYEl
	RK2k5a5C4CtUoWYrVc7IoM3RjdE1l9eYP/qtg74Gm6wSsOQ2KV4Qd0nRVL3iUlA+
	iF60U68OWNMLyzMDGvzaU9hJdL7OlT8WU5Tx4BrDyVrdzitRaI6hYqEOs+dAlcu3
	/2476g==
Received: from mail-qt1-f198.google.com (mail-qt1-f198.google.com [209.85.160.198])
	by mx0a-0031df01.pphosted.com (PPS) with ESMTPS id 48jk99ghmu-1
	(version=TLSv1.2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128 verify=NOT)
	for <linux-sunxi@lists.linux.dev>; Sat, 16 Aug 2025 12:41:10 +0000 (GMT)
Received: by mail-qt1-f198.google.com with SMTP id d75a77b69052e-4b109acac47so76958921cf.1
        for <linux-sunxi@lists.linux.dev>; Sat, 16 Aug 2025 05:41:10 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20230601; t=1755348069; x=1755952869;
        h=cc:to:in-reply-to:references:message-id:content-transfer-encoding
         :mime-version:subject:date:from:x-gm-message-state:from:to:cc
         :subject:date:message-id:reply-to;
        bh=TBBRBvbZmhS5MEDtIi65bqiX0+TlTd1eeG9t75hRPEA=;
        b=gttlwkhIkobQIYyq7yTI4jq2ZVN7VimPGBZ+8g9zmlLMqIJ4yfpPh2y20QqPrRCpjq
         MYyzCwXNoFB/c2wLt4ceDnr6Kp8I7eqw7PcNXewA56m4ev2CFmUGeuf84H48lBghH5XF
         0Ckb68B7KKurr2vf+bb/zwAxlZZZy5uvCPLnRaMTwTihUSemoV3S8S6tjPEaUS8HZlqY
         EBVxjPYNvFg+E6CRkUUkNUcu8Vg2SKHqtRiXWxN7gOywdbEUFSnthM19S28lI8FrxiYh
         hoYNvYdMYflpV5e9iIKm12pAoKiuOudDHYkE63O/zCfyEIgztvocUzGvfYi9TsC4u92J
         Wkaw==
X-Forwarded-Encrypted: i=1; AJvYcCWU9GZRlhmCYg/AErLtOiEpJeybp3wd4fyu92Lx719GyjFRrwKaCwVvuBZq96LSjMoJAjHlg0m+TQRQvw==@lists.linux.dev
X-Gm-Message-State: AOJu0Yy5iPnGm47H5s+c3dfvndv+QtX9SEZkEoBZOuQfNF5mF/XACbfU
	0ES7y/1Vmj8yXubKObIROW7eVcrb+6UVuQO3aiU5JfP73JlAeTz2aFX0RaS/pKgqNbsT+5ziam3
	czRpQKXJ91quzLouaR3xE3Itf3SZdXZzIet2jOkqBK95NwKjpm+N+rSsNpXmRZxlBIQ==
X-Gm-Gg: ASbGncvl4eUrehw3ijNUSKdfCA36WmCsgClIvGcFLMpiokxiGqPGd0VS8wvXeJPXO1X
	WZPXr0nLiB3u4W1LGuFU5egt7Y+8+vzwXHR0ZnKd6805Zq9NT8FS7SwSgyhIMRmnMWHWxtmkFsz
	D8zOO6ESqf/amGvGMw/59HFtzD+i1i4sbqdQLurrYnx0FMTAkG1NLzNKShep1HOI0sPcZ480qYu
	sYPq/XWzMlTldXN01Wtz7ZoNgvdu39OCaGTGufAqBBudn0u0X/0zdO4bE/pIGyu09fqn2UPEGDj
	yNwXagGS+M5GciLkiZ1Llr1yI30BS63UQCLSGl7ZJpmWiZ3SDAMGo0tJJg1ucUq1QQ/E3X7lcjV
	WvSQNSW3/SAeMOAnIqgR7QVz+egvr+VLVWdbLGjy6w0Ml19v6Da16
X-Received: by 2002:a05:622a:1108:b0:4b0:ec28:6fee with SMTP id d75a77b69052e-4b11e23aceemr77142671cf.38.1755348069158;
        Sat, 16 Aug 2025 05:41:09 -0700 (PDT)
X-Google-Smtp-Source: AGHT+IEujKVPrwnqPmVwBrT/6yKZDdIPm7Rj84fddbqZ46SbGO9mqJHM95gjJV/0J1FbKa4y9npTlw==
X-Received: by 2002:a05:622a:1108:b0:4b0:ec28:6fee with SMTP id d75a77b69052e-4b11e23aceemr77142321cf.38.1755348068724;
        Sat, 16 Aug 2025 05:41:08 -0700 (PDT)
Received: from umbar.lan (2001-14ba-a0c3-3a00-264b-feff-fe8b-be8a.rev.dnainternet.fi. [2001:14ba:a0c3:3a00:264b:feff:fe8b:be8a])
        by smtp.gmail.com with ESMTPSA id 2adb3069b0e04-55cef3cca21sm856554e87.104.2025.08.16.05.41.07
        (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
        Sat, 16 Aug 2025 05:41:07 -0700 (PDT)
From: Dmitry Baryshkov <dmitry.baryshkov@oss.qualcomm.com>
Date: Sat, 16 Aug 2025 15:41:02 +0300
Subject: [PATCH 2/7] drm/bridge: adv7511: declare supported infoframes
Precedence: bulk
X-Mailing-List: linux-sunxi@lists.linux.dev
List-Id: <linux-sunxi.lists.linux.dev>
List-Subscribe: <mailto:linux-sunxi+subscribe@lists.linux.dev>
List-Unsubscribe: <mailto:linux-sunxi+unsubscribe@lists.linux.dev>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: 7bit
Message-Id: <20250816-drm-limit-infoframes-v1-2-6dc17d5f07e9@oss.qualcomm.com>
References: <20250816-drm-limit-infoframes-v1-0-6dc17d5f07e9@oss.qualcomm.com>
In-Reply-To: <20250816-drm-limit-infoframes-v1-0-6dc17d5f07e9@oss.qualcomm.com>
To: Andrzej Hajda <andrzej.hajda@intel.com>,
        Neil Armstrong <neil.armstrong@linaro.org>,
        Robert Foss <rfoss@kernel.org>,
        Laurent Pinchart <Laurent.pinchart@ideasonboard.com>,
        Jonas Karlman <jonas@kwiboo.se>,
        Jernej Skrabec <jernej.skrabec@gmail.com>,
        Maarten Lankhorst <maarten.lankhorst@linux.intel.com>,
        Maxime Ripard <mripard@kernel.org>,
        Thomas Zimmermann <tzimmermann@suse.de>,
        David Airlie <airlied@gmail.com>, Simona Vetter <simona@ffwll.ch>,
        Sandy Huang <hjc@rock-chips.com>,
        =?utf-8?q?Heiko_St=C3=BCbner?= <heiko@sntech.de>,
        Andy Yan <andy.yan@rock-chips.com>, Chen-Yu Tsai <wens@csie.org>,
        Samuel Holland <samuel@sholland.org>,
        Dave Stevenson <dave.stevenson@raspberrypi.com>,
        =?utf-8?q?Ma=C3=ADra_Canal?= <mcanal@igalia.com>,
        Raspberry Pi Kernel Maintenance <kernel-list@raspberrypi.com>,
        Liu Ying <victor.liu@nxp.com>,
        Rob Clark <robin.clark@oss.qualcomm.com>,
        Dmitry Baryshkov <lumag@kernel.org>,
        Abhinav Kumar <abhinav.kumar@linux.dev>,
        Jessica Zhang <jessica.zhang@oss.qualcomm.com>,
        Sean Paul <sean@poorly.run>,
        Marijn Suijten <marijn.suijten@somainline.org>
Cc: dri-devel@lists.freedesktop.org, linux-kernel@vger.kernel.org,
        linux-arm-kernel@lists.infradead.org,
        linux-rockchip@lists.infradead.org, linux-sunxi@lists.linux.dev,
        linux-arm-msm@vger.kernel.org, freedreno@lists.freedesktop.org
X-Mailer: b4 0.14.2
X-Developer-Signature: v=1; a=openpgp-sha256; l=936;
 i=dmitry.baryshkov@oss.qualcomm.com; h=from:subject:message-id;
 bh=ics5UJu435PTkR3N2XAnDPkmPWB0LL/sCgBg7ErLZlw=;
 b=owEBbQGS/pANAwAKAYs8ij4CKSjVAcsmYgBooHxfM4SU8e3MmGmakUS5mUvOK2lRk5Rg6pgaF
 Culi/ZbaOyJATMEAAEKAB0WIQRMcISVXLJjVvC4lX+LPIo+Aiko1QUCaKB8XwAKCRCLPIo+Aiko
 1WmoB/0R5TBxmhvS4QiRmSEhjsQzSxvsfU1laRFx1oRGjZ1ar4jAOFsu3PQIsiMObIXEZWQYtlt
 Dj93ckAo+pDbud90Fki0EYit+uS7JUpd9EiQbxx96Jg0AkYoYu4KGHxOOUbVAXzULWQ5nEQv1A9
 tUjphXky2tRQvOSKl1/pTUPmRBKOOsESu7sQ6Ies/giG2MuIzwKB5Rx1FdxnfB0kNoxYZG7x/R2
 ETKyAzxVXIvMtGQky1Q8JGRdf90hMN4xz2OPiK4qyyJoz0++r6wWjj1TNzeHLacbKh5IIRzQkje
 GKf1BwdeSqphn8lh67+Vx9V3VP7Kb7S7DfYbHr9aVVy1SIa/
X-Developer-Key: i=dmitry.baryshkov@oss.qualcomm.com; a=openpgp;
 fpr=8F88381DD5C873E4AE487DA5199BF1243632046A
X-Proofpoint-ORIG-GUID: dCNa1E0GRD6_IiCiIrT-mjTYapEeTRmP
X-Proofpoint-Spam-Details-Enc: AW1haW4tMjUwODE2MDA0NSBTYWx0ZWRfX0O5QwnlpwHHb
 1U75lisQGpLY43x/WOabEaDo/mmTW57kYia2KkV1dWANosfhiMe+Vi3Kw177+pkbBIKYRlFUbM9
 +OAWrybYidFIA7JR0rLR2XywtQNCrl4kgPnHhstFP20vvJY/EYZBH15bi/rTvxWhVqKHB6qp6wN
 tezH1Q96tGs0ca1c8gng4udT7vOrzxe3UlTGuMZkMn3e2CEnFb4F2VXxH1xvmZAKwZIh476qiiM
 Z2cgjUcFtr9xK5nP+tMQjozE32m4uGuP4K8fl7yurUkEvbO/w4j7uTOL1ALnWSndpk2g1U0HlEv
 q3G4OwJ12yGAGZ2emMyWbcFKcGp41Y1J2KNoozKGccB4m1HXapAndm2G1EGZZBnn+wZA9/KO+Rz
 5AWHAkgi
X-Authority-Analysis: v=2.4 cv=IIMCChvG c=1 sm=1 tr=0 ts=68a07c66 cx=c_pps
 a=mPf7EqFMSY9/WdsSgAYMbA==:117 a=xqWC_Br6kY4A:10 a=IkcTkHD0fZMA:10
 a=2OwXVqhp2XgA:10 a=EUspDBNiAAAA:8 a=BPUVXzEUzielt3HhGKsA:9 a=QEXdDO2ut3YA:10
 a=dawVfQjAaf238kedN5IG:22
X-Proofpoint-GUID: dCNa1E0GRD6_IiCiIrT-mjTYapEeTRmP
X-Proofpoint-Virus-Version: vendor=baseguard
 engine=ICAP:2.0.293,Aquarius:18.0.1099,Hydra:6.1.9,FMLib:17.12.80.40
 definitions=2025-08-16_04,2025-08-14_01,2025-03-28_01
X-Proofpoint-Spam-Details: rule=outbound_notspam policy=outbound score=0
 priorityscore=1501 spamscore=0 clxscore=1015 impostorscore=0 phishscore=0
 adultscore=0 malwarescore=0 bulkscore=0 suspectscore=0 classifier=typeunknown
 authscore=0 authtc= authcc= route=outbound adjust=0 reason=mlx scancount=1
 engine=8.19.0-2507300000 definitions=main-2508160045

Declare which infoframes are supported via the .hdmi_write_infoframe()
interface. Audio infoframe is handled separately.

Signed-off-by: Dmitry Baryshkov <dmitry.baryshkov@oss.qualcomm.com>
---
 drivers/gpu/drm/bridge/adv7511/adv7511_drv.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/drivers/gpu/drm/bridge/adv7511/adv7511_drv.c b/drivers/gpu/drm/bridge/adv7511/adv7511_drv.c
index 00d6417c177b430cb1a81118800588b90c692018..a9b2757d7a2cda1064cbc564cdded429056dde0a 100644
--- a/drivers/gpu/drm/bridge/adv7511/adv7511_drv.c
+++ b/drivers/gpu/drm/bridge/adv7511/adv7511_drv.c
@@ -1269,6 +1269,7 @@ static int adv7511_probe(struct i2c_client *i2c)
 
 	adv7511->bridge.vendor = "Analog";
 	adv7511->bridge.product = adv7511->info->name;
+	adv7511->bridge.supported_infoframes = DRM_CONNECTOR_INFOFRAME_AVI;
 
 #ifdef CONFIG_DRM_I2C_ADV7511_AUDIO
 	adv7511->bridge.ops |= DRM_BRIDGE_OP_HDMI_AUDIO;

-- 
2.47.2


From mboxrd@z Thu Jan  1 00:00:00 1970
Received: from mx0a-0031df01.pphosted.com (mx0a-0031df01.pphosted.com [205.220.168.131])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by smtp.subspace.kernel.org (Postfix) with ESMTPS id 600B42E36E4
	for <linux-sunxi@lists.linux.dev>; Sat, 16 Aug 2025 12:41:16 +0000 (UTC)
Authentication-Results: smtp.subspace.kernel.org; arc=none smtp.client-ip=205.220.168.131
ARC-Seal: i=1; a=rsa-sha256; d=subspace.kernel.org; s=arc-20240116;
	t=1755348078; cv=none; b=abqwtae4GDujs4SMSWXbubW9AqkcGjyNCvcZ6B5ul0hspo+y6Oza/n8RtX7Rx1YsYoInd6IV4Y5RKHvY4u9gh1AVjvsTym4BM14aug6bTE2W4ziAzPP3KdAIMotSH6uuYH+a/i+1IBxKAGpWdzFgTg7FEEoyKwtqRiYg2Lu7E6U=
ARC-Message-Signature: i=1; a=rsa-sha256; d=subspace.kernel.org;
	s=arc-20240116; t=1755348078; c=relaxed/simple;
	bh=6MDUGd2gCI/EsaEXrxZU0j17Xf9/Klm/EGghvRMYY3A=;
	h=From:Date:Subject:MIME-Version:Content-Type:Message-Id:References:
	 In-Reply-To:To:Cc; b=BUGz2S+XkkFimnFtfRQ4p1lpEjmfBWGA68Kdt9tPw7zZxZT3F5GchUQxiAp8G4q02WlDTU4b8DDUi4sZKPQ4oC9bybxvJJYH+PPjCh1C/gR9LR4WpTHidneFySTcyCDi8ncg7FgjZaz/r1iHsfgmxat9LOqiK98P5IhwDMacAqQ=
ARC-Authentication-Results: i=1; smtp.subspace.kernel.org; dmarc=pass (p=reject dis=none) header.from=oss.qualcomm.com; spf=pass smtp.mailfrom=oss.qualcomm.com; dkim=pass (2048-bit key) header.d=qualcomm.com header.i=@qualcomm.com header.b=VLW2ErZd; arc=none smtp.client-ip=205.220.168.131
Authentication-Results: smtp.subspace.kernel.org; dmarc=pass (p=reject dis=none) header.from=oss.qualcomm.com
Authentication-Results: smtp.subspace.kernel.org; spf=pass smtp.mailfrom=oss.qualcomm.com
Authentication-Results: smtp.subspace.kernel.org;
	dkim=pass (2048-bit key) header.d=qualcomm.com header.i=@qualcomm.com header.b="VLW2ErZd"
Received: from pps.filterd (m0279864.ppops.net [127.0.0.1])
	by mx0a-0031df01.pphosted.com (8.18.1.2/8.18.1.2) with ESMTP id 57G4eaLU030943
	for <linux-sunxi@lists.linux.dev>; Sat, 16 Aug 2025 12:41:15 GMT
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=qualcomm.com; h=
	cc:content-transfer-encoding:content-type:date:from:in-reply-to
	:message-id:mime-version:references:subject:to; s=qcppdkim1; bh=
	bZCDNxT84H8d3+/4n1AbLc028ffeXusnvwh4O3/fxcY=; b=VLW2ErZdpDCW/AKF
	Eb4TUwL8MjplBqe2x3FPHhRyH48tvPOKFwg6snGM0nNz6M7+j5WEc41zOXhU/0Sl
	uyBkKXDVw3BdQoyz0PEzfSjgKJsxV/Zurr0DlFa9070Z8QAnIK+KCxAPuvEt0UlY
	CGp/AnaoxY2nujCPlmjkp6WdqZY39FJa3mY2LCoS3ZeESvZYGPsrdUEdwHVhVlot
	SIPNQ2rScWi73XuMo2bGnNJVaYPcaicVStR8wKdsWTaDwmWErwJN8JNR0mU5YUDi
	9B8PIxKed0FJzbugqGtjwSa9Paw+pM5ln15awOAH+/QDuZ96galVAtxhYmkaYdzq
	G1jgng==
Received: from mail-qt1-f197.google.com (mail-qt1-f197.google.com [209.85.160.197])
	by mx0a-0031df01.pphosted.com (PPS) with ESMTPS id 48jk5m8hwb-1
	(version=TLSv1.2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128 verify=NOT)
	for <linux-sunxi@lists.linux.dev>; Sat, 16 Aug 2025 12:41:15 +0000 (GMT)
Received: by mail-qt1-f197.google.com with SMTP id d75a77b69052e-4b109912dd8so26243551cf.0
        for <linux-sunxi@lists.linux.dev>; Sat, 16 Aug 2025 05:41:15 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20230601; t=1755348074; x=1755952874;
        h=cc:to:in-reply-to:references:message-id:content-transfer-encoding
         :mime-version:subject:date:from:x-gm-message-state:from:to:cc
         :subject:date:message-id:reply-to;
        bh=bZCDNxT84H8d3+/4n1AbLc028ffeXusnvwh4O3/fxcY=;
        b=QxLO1E2Y9eGFQFxepivRPBcl2SjHTgyxeUt2ZG6mIFdcM21wMw84JkSd8AImhAygfh
         TL0qQge0+f1YxoP/ynW4PFhaaDzOPGUDK9UAzROBdztrexdRfFNDs/rQl2wqS6EcyhpT
         aa9w8AesDOnsl5pOnfcTffwbW8fJIBKMX9wm4NKr/c7gFAuKgy9tnkeJZwZOvcw/AXO2
         7sNdQmfnzXF+QfUHD+uAHhCpp820oX3nJIJAMkYmvycgSuhpOZ4Vg3qZ1t1mPeCO3+Ma
         tT1mUjeRZIukOOsp3mWtDXfniPN+Ojt1IpxtDFZBw7kZG6/buPCPPnH87nrWG6HTIiss
         65zA==
X-Forwarded-Encrypted: i=1; AJvYcCX/ifs/HwyO0xSMbo9jaA/sNyOiSAVUJkgoVYxBQ7ilAXUWCe7bNMoCGQw+MhPmktc3ovLh//sb+d4Srw==@lists.linux.dev
X-Gm-Message-State: AOJu0Yzo+ewV/7sPt9zOrfdlOugWd//O+rDZa4o+hu4VDYeYYvVj2VXK
	1Wzvf6I37A7v4PUCMg4REeZ1fLuZaZPLTE6eNuNuCxegeAK4nKQmq/YCR5UN06soCnahUIL3lI0
	08Rs+E9YMt/1GcYnHuxFemixHt54YxWvqeuB0rhEne6ca6GeWj6iaQHVMKSkLqHIfCw==
X-Gm-Gg: ASbGncubZRHb+V0KEysCDE4cvZHWC5CL2QP7d5avvwYDHC2OFwqPKNrFqbwcIPne8jc
	vdOhnr1V1ztxaKqaOPy7JbVVa/qsx+Rrfxz8pPvstzbks5mLeAHepY2tzSCrxx8ZVJsYLEEPKzB
	FI7lfGSSNfGy+BzMuD6KOgRaoOfo4bH1/gk2L2p+7Lv9FHLdwp66HJNjc5k/R+cdOY8a0jpMLpk
	b9mi07AwEtNUGBVs9tZHAxha08I5uFZU7Rvsl7sZH/tZbUy2HtKKMZMf4crJxjaByRm3QjCy3vy
	cLjn0z4hU3GaGcTPmrjtn4pz2s+LeV/GpU03BKo2uzvOr+vku3dlLSoPo660RdokXC59XIeNrnh
	kUKikitfBXyIThHMVhLTtBN2ONlmRpQXTeRtIIx5DxYS2XAFfpTqK
X-Received: by 2002:ac8:5984:0:b0:4ab:5277:a5ab with SMTP id d75a77b69052e-4b11e0c2db9mr68298441cf.6.1755348074358;
        Sat, 16 Aug 2025 05:41:14 -0700 (PDT)
X-Google-Smtp-Source: AGHT+IEq+2D8bA6Exv7xwHUunlo4e1X/zZ2ZI/TlCYJHV66Jzf0On30yfS3pYH+kbbOYRboEDBH3bA==
X-Received: by 2002:ac8:5984:0:b0:4ab:5277:a5ab with SMTP id d75a77b69052e-4b11e0c2db9mr68298071cf.6.1755348073839;
        Sat, 16 Aug 2025 05:41:13 -0700 (PDT)
Received: from umbar.lan (2001-14ba-a0c3-3a00-264b-feff-fe8b-be8a.rev.dnainternet.fi. [2001:14ba:a0c3:3a00:264b:feff:fe8b:be8a])
        by smtp.gmail.com with ESMTPSA id 2adb3069b0e04-55cef3cca21sm856554e87.104.2025.08.16.05.41.12
        (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
        Sat, 16 Aug 2025 05:41:12 -0700 (PDT)
From: Dmitry Baryshkov <dmitry.baryshkov@oss.qualcomm.com>
Date: Sat, 16 Aug 2025 15:41:04 +0300
Subject: [PATCH 4/7] drm/bridge: lontium-lt9611: declare supported
 infoframes
Precedence: bulk
X-Mailing-List: linux-sunxi@lists.linux.dev
List-Id: <linux-sunxi.lists.linux.dev>
List-Subscribe: <mailto:linux-sunxi+subscribe@lists.linux.dev>
List-Unsubscribe: <mailto:linux-sunxi+unsubscribe@lists.linux.dev>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: 7bit
Message-Id: <20250816-drm-limit-infoframes-v1-4-6dc17d5f07e9@oss.qualcomm.com>
References: <20250816-drm-limit-infoframes-v1-0-6dc17d5f07e9@oss.qualcomm.com>
In-Reply-To: <20250816-drm-limit-infoframes-v1-0-6dc17d5f07e9@oss.qualcomm.com>
To: Andrzej Hajda <andrzej.hajda@intel.com>,
        Neil Armstrong <neil.armstrong@linaro.org>,
        Robert Foss <rfoss@kernel.org>,
        Laurent Pinchart <Laurent.pinchart@ideasonboard.com>,
        Jonas Karlman <jonas@kwiboo.se>,
        Jernej Skrabec <jernej.skrabec@gmail.com>,
        Maarten Lankhorst <maarten.lankhorst@linux.intel.com>,
        Maxime Ripard <mripard@kernel.org>,
        Thomas Zimmermann <tzimmermann@suse.de>,
        David Airlie <airlied@gmail.com>, Simona Vetter <simona@ffwll.ch>,
        Sandy Huang <hjc@rock-chips.com>,
        =?utf-8?q?Heiko_St=C3=BCbner?= <heiko@sntech.de>,
        Andy Yan <andy.yan@rock-chips.com>, Chen-Yu Tsai <wens@csie.org>,
        Samuel Holland <samuel@sholland.org>,
        Dave Stevenson <dave.stevenson@raspberrypi.com>,
        =?utf-8?q?Ma=C3=ADra_Canal?= <mcanal@igalia.com>,
        Raspberry Pi Kernel Maintenance <kernel-list@raspberrypi.com>,
        Liu Ying <victor.liu@nxp.com>,
        Rob Clark <robin.clark@oss.qualcomm.com>,
        Dmitry Baryshkov <lumag@kernel.org>,
        Abhinav Kumar <abhinav.kumar@linux.dev>,
        Jessica Zhang <jessica.zhang@oss.qualcomm.com>,
        Sean Paul <sean@poorly.run>,
        Marijn Suijten <marijn.suijten@somainline.org>
Cc: dri-devel@lists.freedesktop.org, linux-kernel@vger.kernel.org,
        linux-arm-kernel@lists.infradead.org,
        linux-rockchip@lists.infradead.org, linux-sunxi@lists.linux.dev,
        linux-arm-msm@vger.kernel.org, freedreno@lists.freedesktop.org
X-Mailer: b4 0.14.2
X-Developer-Signature: v=1; a=openpgp-sha256; l=1071;
 i=dmitry.baryshkov@oss.qualcomm.com; h=from:subject:message-id;
 bh=6MDUGd2gCI/EsaEXrxZU0j17Xf9/Klm/EGghvRMYY3A=;
 b=owEBbQGS/pANAwAKAYs8ij4CKSjVAcsmYgBooHxfeZjvuIKMDxc3NNDqA14HuD3rogLXgG1/x
 40vIEmKjtmJATMEAAEKAB0WIQRMcISVXLJjVvC4lX+LPIo+Aiko1QUCaKB8XwAKCRCLPIo+Aiko
 1Vr7B/9KbGoKGY0G6Zbc0PFJqwOln6oTx3g2EnrCz9bTxS7nuNcHvo4V4hVcxg3JHEn9XLW0aBq
 rcL64poAiL+A/Tk7OSFz76/ZS28ruSlHbEBfJykODqDlllZ89HEWOPZeQbxzH/SHmsO3bwa6Vzs
 gl9U1/yEFKmMWqDrHZKk7wJ/k8s+PAu66cGZrI2IJVQWiV6Or4n6hKa9wvloaFF7hKJdMqEUi9B
 QDjr0YsT5PqjevpATnBWoALz9MsgAIXYPDNDAsg+k9oWjqPJj9FAQq5ZHbLj4bCTPqetj50s9NP
 5ynpi+G/iWc0A4DOc71d38M10F3TXnligAlbQthOBFCoGKJJ
X-Developer-Key: i=dmitry.baryshkov@oss.qualcomm.com; a=openpgp;
 fpr=8F88381DD5C873E4AE487DA5199BF1243632046A
X-Authority-Analysis: v=2.4 cv=Sdn3duRu c=1 sm=1 tr=0 ts=68a07c6b cx=c_pps
 a=EVbN6Ke/fEF3bsl7X48z0g==:117 a=xqWC_Br6kY4A:10 a=IkcTkHD0fZMA:10
 a=2OwXVqhp2XgA:10 a=EUspDBNiAAAA:8 a=AMvF8s34Jxw15HKoVo4A:9 a=QEXdDO2ut3YA:10
 a=a_PwQJl-kcHnX1M80qC6:22
X-Proofpoint-ORIG-GUID: wu1hdeq1DjvdK2ithj_swFQvwuSl-ERD
X-Proofpoint-GUID: wu1hdeq1DjvdK2ithj_swFQvwuSl-ERD
X-Proofpoint-Spam-Details-Enc: AW1haW4tMjUwODE2MDA0MiBTYWx0ZWRfX0qXZVMusQ94d
 lvhJDhJhAuDWLK5KCJxfJpewPzjNtpLwhV6EMJkWVOIsrVwPvYdZMxQZaEqVTVFvqHJOUz4ZRWi
 sEJZHvDN1aodxG/NTe24+qkb/BjosIu5VerEyJCMxg6Ym5TqMQmsBc3JFgvv/CLDMShHcHNmuHW
 4KBfpO5z/vfRi6VxWZRyCDFiE3t5m3R6SwIBsLTXD/l0I9DdCBFNVXxT896LBT3kSq5L7tMG16r
 8GQ5dyta5q0MbO9i72fd9mliUF0nIJ0QW3B1PXhOsTkXGMFf9hp7JqPcCNZvkOzOcD80H3YmB8a
 SR9vfopkhS5aYNKO9r+Pjb/ADOYAm0loJwAmg1Q1D/uCRRDSiSIblQKPE560xQpwb4kUKLx2xq4
 hEwBBvw+
X-Proofpoint-Virus-Version: vendor=baseguard
 engine=ICAP:2.0.293,Aquarius:18.0.1099,Hydra:6.1.9,FMLib:17.12.80.40
 definitions=2025-08-16_04,2025-08-14_01,2025-03-28_01
X-Proofpoint-Spam-Details: rule=outbound_notspam policy=outbound score=0
 impostorscore=0 clxscore=1011 suspectscore=0 priorityscore=1501 spamscore=0
 adultscore=0 malwarescore=0 bulkscore=0 phishscore=0 classifier=typeunknown
 authscore=0 authtc= authcc= route=outbound adjust=0 reason=mlx scancount=1
 engine=8.19.0-2507300000 definitions=main-2508160042

Declare which infoframes are supported via the .hdmi_write_infoframe()
interface.

Signed-off-by: Dmitry Baryshkov <dmitry.baryshkov@oss.qualcomm.com>
---
 drivers/gpu/drm/bridge/lontium-lt9611.c | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/drivers/gpu/drm/bridge/lontium-lt9611.c b/drivers/gpu/drm/bridge/lontium-lt9611.c
index a2d032ee4744715b88eb66883edf69bab4c274b0..08cb6958b9154dbc516aeb0623a8fb5e4af1df92 100644
--- a/drivers/gpu/drm/bridge/lontium-lt9611.c
+++ b/drivers/gpu/drm/bridge/lontium-lt9611.c
@@ -1136,6 +1136,10 @@ static int lt9611_probe(struct i2c_client *client)
 	lt9611->bridge.type = DRM_MODE_CONNECTOR_HDMIA;
 	lt9611->bridge.vendor = "Lontium";
 	lt9611->bridge.product = "LT9611";
+	lt9611->bridge.supported_infoframes = DRM_CONNECTOR_INFOFRAME_AUDIO |
+		DRM_CONNECTOR_INFOFRAME_AVI |
+		DRM_CONNECTOR_INFOFRAME_SPD |
+		DRM_CONNECTOR_INFOFRAME_VENDOR,
 	lt9611->bridge.hdmi_audio_dev = dev;
 	lt9611->bridge.hdmi_audio_max_i2s_playback_channels = 8;
 	lt9611->bridge.hdmi_audio_dai_port = 2;

-- 
2.47.2


From mboxrd@z Thu Jan  1 00:00:00 1970
Received: from mx0a-0031df01.pphosted.com (mx0a-0031df01.pphosted.com [205.220.168.131])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by smtp.subspace.kernel.org (Postfix) with ESMTPS id 5EB8931CA57
	for <linux-sunxi@lists.linux.dev>; Tue, 19 Aug 2025 11:03:15 +0000 (UTC)
Authentication-Results: smtp.subspace.kernel.org; arc=none smtp.client-ip=205.220.168.131
ARC-Seal: i=1; a=rsa-sha256; d=subspace.kernel.org; s=arc-20240116;
	t=1755601399; cv=none; b=JdunmstBWgweXvkCFey5DqW7ifYfU+ztOYtvCtZTz7FaXqpev879NfSmKesQbYmSfMNvviYzaYQrTpWkupn+Zg3mRhjNfTRb9eTWijXvCg+v2uE1D37o2ukhrEaKdNhbH7LjkZqRzpxGdSXu45LXvetBocvKwI7iPlNK25Tskjs=
ARC-Message-Signature: i=1; a=rsa-sha256; d=subspace.kernel.org;
	s=arc-20240116; t=1755601399; c=relaxed/simple;
	bh=Z/V/iyTTnPvELAJM/HgSdctd1tPg+1cqgkPRcvA7fDY=;
	h=Message-ID:Date:MIME-Version:Subject:To:Cc:References:From:
	 In-Reply-To:Content-Type; b=KD6CR1hSGaPg7ianpCTzKboiNS98PwcOzmXyld/8IOpH89AZPWsioEkcZ178s5lurpfDmlGCjIIo5zBRESWHV8QzGR7toiMhLgCZYzEsxFxDfv3LlaGiQetRjaVhZzLc2BQ0pXanDEi84Luc+nOopBCEDk9sgEZgRe0bt1ua4so=
ARC-Authentication-Results: i=1; smtp.subspace.kernel.org; dmarc=pass (p=reject dis=none) header.from=oss.qualcomm.com; spf=pass smtp.mailfrom=oss.qualcomm.com; dkim=pass (2048-bit key) header.d=qualcomm.com header.i=@qualcomm.com header.b=hkLSthcO; arc=none smtp.client-ip=205.220.168.131
Authentication-Results: smtp.subspace.kernel.org; dmarc=pass (p=reject dis=none) header.from=oss.qualcomm.com
Authentication-Results: smtp.subspace.kernel.org; spf=pass smtp.mailfrom=oss.qualcomm.com
Authentication-Results: smtp.subspace.kernel.org;
	dkim=pass (2048-bit key) header.d=qualcomm.com header.i=@qualcomm.com header.b="hkLSthcO"
Received: from pps.filterd (m0279867.ppops.net [127.0.0.1])
	by mx0a-0031df01.pphosted.com (8.18.1.2/8.18.1.2) with ESMTP id 57J90YlY021768
	for <linux-sunxi@lists.linux.dev>; Tue, 19 Aug 2025 11:03:14 GMT
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=qualcomm.com; h=
	cc:content-transfer-encoding:content-type:date:from:in-reply-to
	:message-id:mime-version:references:subject:to; s=qcppdkim1; bh=
	gwKBRdNGHVkugfe5xXkArXJpDEgU6rTcTO8+Bts+tYk=; b=hkLSthcOjTMFj5GL
	IkyvViVLBcp/DpDscjki6x7Y090YByJwjQaIxDaHMhEsrKGaCQfEgw0k3jMxvxpy
	z0kEU2hEJkO3j9pirrFGPf00UgCK5/f9gAe9sPKN2d8bgXtQtygRD+TH1+pLKlLJ
	pFaRRi2uy+JbSOeDsUvrZKoYN0/pcbXw2OK4AkuEsYPzTiqLnnVABTSRPQ9e7YLq
	S1R2YLGQTzxztVznmHpHWzz0qO6Wt/AhpyfhUb88lztK6rdFf8itxh9SZLl5M0Xc
	lwdi4mgNUGVv2MKhGRsgzHkCPZ4F7XDQG90Bq73JahuUJFYW7lUTB3nNBOcZnZ5/
	nKbfmw==
Received: from mail-qk1-f197.google.com (mail-qk1-f197.google.com [209.85.222.197])
	by mx0a-0031df01.pphosted.com (PPS) with ESMTPS id 48m71cjyh2-1
	(version=TLSv1.2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128 verify=NOT)
	for <linux-sunxi@lists.linux.dev>; Tue, 19 Aug 2025 11:03:14 +0000 (GMT)
Received: by mail-qk1-f197.google.com with SMTP id af79cd13be357-7e8704fad73so1419193585a.1
        for <linux-sunxi@lists.linux.dev>; Tue, 19 Aug 2025 04:03:14 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20230601; t=1755601390; x=1756206190;
        h=content-transfer-encoding:in-reply-to:from:content-language
         :references:cc:to:subject:user-agent:mime-version:date:message-id
         :x-gm-message-state:from:to:cc:subject:date:message-id:reply-to;
        bh=gwKBRdNGHVkugfe5xXkArXJpDEgU6rTcTO8+Bts+tYk=;
        b=IpnJgO/pGcxuARod/irlnbTVnpzDv2F5tgBfBubvtQCSbjoij9UJeM+QYrgoQr2QMD
         OMu/SivgrpG0mjrXODxCQY6mn2X+EjU9XJQoEIwE0iEGZPbI+gxr2RObBYha1uzg+IPH
         5oWOtv8da3v5HrGaoxYD4sxIxd67RnmvpHdDpCiyJGWnSwduUnmM8mX0HG0CMQPwnHsM
         /05GYtDz9vlxzkL//gqrQ6z9yitfhO8rEnNP34BFcPsH6Sf4zNGXgz/e+8pEVIifjrxW
         jCtIo2LKCpxAnZXAUv1+JuyzWU84972N5iro9sWnid9hSWKw/ebYWW7IqD5HhYPgdS9+
         p5sQ==
X-Forwarded-Encrypted: i=1; AJvYcCUoFFMHnkqX0oql+j6SbZQBu6XaHRBSd93RZQUq53tacKUyCZWfKgG6xhRHVQbbdCxl7AF8MyHMWcWhtg==@lists.linux.dev
X-Gm-Message-State: AOJu0YwHta/zd0ZxTu7T4f0h9iLJOgYV+PUQcOinJkSr2+EpIGbdrJpm
	rbqKzRUsK46iMQNRpFfuQKnvN+wlAffouu9XeVkex5xk8OXIrzzmFvi1T1wUfztTREwruxmoO+6
	KW1Mx8QWnA5GYbk9SvVFwi8+KmY6dxZ2WmFYqg0+/ZWW77/g087H9OXbd4Kht50aZzw==
X-Gm-Gg: ASbGncspV0gas+WJWMZYuOj7qk1JGjh8zwZgr9yglf28GjgbLV9CF9MvgO0TINL2hVS
	jUvd8Le3HFlfOSjWMDdHWgojfggutLM81yY9zEByDj73yN8YVAGFxwFrPd1nkIBrTqibM8B39+v
	mU9o71RJuaVkUpR0++LZ4wMh745LY2gXHz3JQQYqKKpYLgVVE5kKgh039QdHn7JM5sNxw1CNpJs
	YaanG07BHtrBy9Cb91OWkBYYU7eRUU48gVNvfymhfHm3buCB11Ro/xNh/V3V0U6W2F+4dt45yzW
	N6+9/35R7Q8B/sf4G84oXojZpTDZsYpqv524o2sOeTAB1RfyM7HgIr+QLkiSisP4rk7WT8uA51J
	fDH533m8it6L2CzEcBQ==
X-Received: by 2002:a05:6214:d0e:b0:70b:8a30:ecad with SMTP id 6a1803df08f44-70c2b6d83e6mr20531876d6.7.1755601388788;
        Tue, 19 Aug 2025 04:03:08 -0700 (PDT)
X-Google-Smtp-Source: AGHT+IEceijSPE9wsdNVyj+ClLJ7om4jjkcKUS38hEPJHJxuLe4wSFcBG210A5Klf/lWbJjEDmicFA==
X-Received: by 2002:a05:6214:d0e:b0:70b:8a30:ecad with SMTP id 6a1803df08f44-70c2b6d83e6mr20530806d6.7.1755601387799;
        Tue, 19 Aug 2025 04:03:07 -0700 (PDT)
Received: from [10.207.49.70] (84-253-220-51.bb.dnainternet.fi. [84.253.220.51])
        by smtp.gmail.com with ESMTPSA id 38308e7fff4ca-3340a63d860sm21886211fa.65.2025.08.19.04.03.05
        (version=TLS1_3 cipher=TLS_AES_128_GCM_SHA256 bits=128/128);
        Tue, 19 Aug 2025 04:03:06 -0700 (PDT)
Message-ID: <a4d51cd5-8b99-444a-8f31-e83102c65d14@oss.qualcomm.com>
Date: Tue, 19 Aug 2025 14:03:04 +0300
Precedence: bulk
X-Mailing-List: linux-sunxi@lists.linux.dev
List-Id: <linux-sunxi.lists.linux.dev>
List-Subscribe: <mailto:linux-sunxi+subscribe@lists.linux.dev>
List-Unsubscribe: <mailto:linux-sunxi+unsubscribe@lists.linux.dev>
MIME-Version: 1.0
User-Agent: Mozilla Thunderbird
Subject: Re: [PATCH 1/7] drm/connector: let drivers declare infoframes as
 unsupported
To: Liu Ying <victor.liu@nxp.com>, Andrzej Hajda <andrzej.hajda@intel.com>,
        Neil Armstrong <neil.armstrong@linaro.org>,
        Robert Foss <rfoss@kernel.org>,
        Laurent Pinchart <Laurent.pinchart@ideasonboard.com>,
        Jonas Karlman <jonas@kwiboo.se>,
        Jernej Skrabec <jernej.skrabec@gmail.com>,
        Maarten Lankhorst <maarten.lankhorst@linux.intel.com>,
        Maxime Ripard <mripard@kernel.org>,
        Thomas Zimmermann <tzimmermann@suse.de>,
        David Airlie <airlied@gmail.com>, Simona Vetter <simona@ffwll.ch>,
        Sandy Huang <hjc@rock-chips.com>,
        =?UTF-8?Q?Heiko_St=C3=BCbner?=
 <heiko@sntech.de>,
        Andy Yan <andy.yan@rock-chips.com>, Chen-Yu Tsai <wens@csie.org>,
        Samuel Holland <samuel@sholland.org>,
        Dave Stevenson <dave.stevenson@raspberrypi.com>,
        =?UTF-8?Q?Ma=C3=ADra_Canal?= <mcanal@igalia.com>,
        Raspberry Pi Kernel Maintenance <kernel-list@raspberrypi.com>,
        Rob Clark <robin.clark@oss.qualcomm.com>,
        Dmitry Baryshkov
 <lumag@kernel.org>,
        Abhinav Kumar <abhinav.kumar@linux.dev>,
        Jessica Zhang <jessica.zhang@oss.qualcomm.com>,
        Sean Paul <sean@poorly.run>,
        Marijn Suijten <marijn.suijten@somainline.org>
Cc: dri-devel@lists.freedesktop.org, linux-kernel@vger.kernel.org,
        linux-arm-kernel@lists.infradead.org,
        linux-rockchip@lists.infradead.org, linux-sunxi@lists.linux.dev,
        linux-arm-msm@vger.kernel.org, freedreno@lists.freedesktop.org
References: <20250816-drm-limit-infoframes-v1-0-6dc17d5f07e9@oss.qualcomm.com>
 <20250816-drm-limit-infoframes-v1-1-6dc17d5f07e9@oss.qualcomm.com>
 <e9f2c06d-07ee-4f69-887c-caf5efb59f7f@nxp.com>
Content-Language: en-US
From: Dmitry Baryshkov <dmitry.baryshkov@oss.qualcomm.com>
In-Reply-To: <e9f2c06d-07ee-4f69-887c-caf5efb59f7f@nxp.com>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Proofpoint-ORIG-GUID: kDapw_hru4q-IJUHmwUIUr22P21W8Ncs
X-Proofpoint-GUID: kDapw_hru4q-IJUHmwUIUr22P21W8Ncs
X-Authority-Analysis: v=2.4 cv=IvQecK/g c=1 sm=1 tr=0 ts=68a459f2 cx=c_pps
 a=50t2pK5VMbmlHzFWWp8p/g==:117 a=JdIsBVl79nXNK9flUcZCTw==:17
 a=IkcTkHD0fZMA:10 a=2OwXVqhp2XgA:10 a=EUspDBNiAAAA:8 a=FlTG0Dy22fcDEStDgbkA:9
 a=QEXdDO2ut3YA:10 a=IoWCM6iH3mJn3m4BftBB:22
X-Proofpoint-Spam-Details-Enc: AW1haW4tMjUwODE4MDE0NyBTYWx0ZWRfX9+ayqy0T0mRn
 chO6lDksjBq1Cs3WAKwWzXHpRP+K1wnXVSQ4mESsIIf5Zx6Wa5g/N7vh7GYPOuio6aoitELuUKF
 8gHJfqGM/RNZGkqGLKoyjRNQmJyrCyKkSuGWXVINJh3r8mxqCY0L7OV03C+L74SmW/3z4XhmIFu
 5HulDUC0Wvp0TE/f2e3cyuQhM9bMW9wjRXV5P+TnTO2xbi/ureHevXU5UvCOLQSKhSz8ovoU4Ao
 W8Ykan/vhzivSqysgh8Zcss30tG8a6KFj5ZxQsHywJEC/WBBo7DwQ6+/Fex7fjrEGaG+sDVuJmF
 vGUoNHLjAPt58QmWUAMMJSCho62XQ2MSetg4KUL9rirF0dmY6koG7BwFMw2h7+S8a6VoRd/Sqcx
 2Zyf/kRZ
X-Proofpoint-Virus-Version: vendor=baseguard
 engine=ICAP:2.0.293,Aquarius:18.0.1099,Hydra:6.1.9,FMLib:17.12.80.40
 definitions=2025-08-19_01,2025-08-14_01,2025-03-28_01
X-Proofpoint-Spam-Details: rule=outbound_notspam policy=outbound score=0
 impostorscore=0 adultscore=0 malwarescore=0 priorityscore=1501 clxscore=1015
 phishscore=0 bulkscore=0 spamscore=0 suspectscore=0 classifier=typeunknown
 authscore=0 authtc= authcc= route=outbound adjust=0 reason=mlx scancount=1
 engine=8.19.0-2507300000 definitions=main-2508180147

On 19/08/2025 12:42, Liu Ying wrote:
> Hi Dmitry,
> 
> On 08/16/2025, Dmitry Baryshkov wrote:
>> Currently DRM framework expects that the HDMI connector driver supports
>> all infoframe types: it generates the data as required and calls into
>> the driver to program all of them, letting the driver to soft-fail if
>> the infoframe is unsupported. This has a major drawback on userspace
>> API: the framework also registers debugfs files for all Infoframe types,
>> possibly surprising the users when infoframe is visible in the debugfs
>> file, but it is not visible on the wire.
>>
>> Let drivers declare that they support only a subset of infoframes,
>> creating a more consistent interface.
>>
>> Signed-off-by: Dmitry Baryshkov <dmitry.baryshkov@oss.qualcomm.com>
>> ---
>>   drivers/gpu/drm/display/drm_bridge_connector.c     |  6 +++
>>   drivers/gpu/drm/display/drm_hdmi_state_helper.c    | 43 +++++++++++++++++++++-
>>   drivers/gpu/drm/drm_connector.c                    |  4 ++
>>   drivers/gpu/drm/drm_debugfs.c                      | 16 +++++---
>>   drivers/gpu/drm/rockchip/inno_hdmi.c               |  1 +
>>   drivers/gpu/drm/sun4i/sun4i_hdmi_enc.c             |  1 +
>>   drivers/gpu/drm/tests/drm_connector_test.c         | 28 ++++++++++++++
>>   drivers/gpu/drm/tests/drm_hdmi_state_helper_test.c |  8 ++++
>>   drivers/gpu/drm/vc4/vc4_hdmi.c                     |  4 ++
>>   include/drm/drm_bridge.h                           |  7 ++++
>>   include/drm/drm_connector.h                        | 23 ++++++++++++
>>   11 files changed, 134 insertions(+), 7 deletions(-)
>>
>> diff --git a/drivers/gpu/drm/display/drm_bridge_connector.c b/drivers/gpu/drm/display/drm_bridge_connector.c
>> index 8c915427d0538435661d771940efe38b462027a1..b94458d5faa9ae283889fc79496ae323bb4dc88c 100644
>> --- a/drivers/gpu/drm/display/drm_bridge_connector.c
>> +++ b/drivers/gpu/drm/display/drm_bridge_connector.c
>> @@ -781,6 +781,12 @@ struct drm_connector *drm_bridge_connector_init(struct drm_device *drm,
>>   					       &drm_bridge_connector_hdmi_funcs,
>>   					       connector_type, ddc,
>>   					       supported_formats,
>> +					       bridge->supported_infoframes ? :
>> +					       DRM_CONNECTOR_INFOFRAME_AUDIO |
>> +					       DRM_CONNECTOR_INFOFRAME_AVI |
>> +					       DRM_CONNECTOR_INFOFRAME_DRM |
>> +					       DRM_CONNECTOR_INFOFRAME_SPD |
>> +					       DRM_CONNECTOR_INFOFRAME_VENDOR,
> 
> The mask is DRM_CONNECTOR_ALL_INFOFRAMES as defined in drm_connector_test.c
> and drm_hdmi_state_helper_test.c.  Can it be defined in drm_connector.h and
> used here?

I purposedly didn't define it in the top-level header. It would be too 
tempting to use that mask in the drivers, which will break if we add 
more infoframes in future. This one is a band-aid for the next patches. 
Maybe I should drop this chunk as a last patch.

> 
>>   					       max_bpc);
>>   		if (ret)
>>   			return ERR_PTR(ret);
>> diff --git a/drivers/gpu/drm/display/drm_hdmi_state_helper.c b/drivers/gpu/drm/display/drm_hdmi_state_helper.c
>> index a561f124be99a0cd4259dbacf5f5f6651ff8a0ea..fb8b9e3769cb74345f9c6ef6f6ca441a373141c1 100644
>> --- a/drivers/gpu/drm/display/drm_hdmi_state_helper.c
>> +++ b/drivers/gpu/drm/display/drm_hdmi_state_helper.c
>> @@ -687,6 +687,10 @@ static int hdmi_generate_avi_infoframe(const struct drm_connector *connector,
>>   
>>   	infoframe->set = false;
>>   
>> +	if (!drm_hdmi_connector_supports_infoframe(connector,
>> +						   HDMI_INFOFRAME_TYPE_AVI))
> 
> Nit: The above two lines fit into a single line.  The same applies to similar
> lines added in this file.
> 
>> +		return 0;
>> +
>>   	ret = drm_hdmi_avi_infoframe_from_display_mode(frame, connector, mode);
>>   	if (ret)
>>   		return ret;
>> @@ -718,6 +722,10 @@ static int hdmi_generate_spd_infoframe(const struct drm_connector *connector,
>>   
>>   	infoframe->set = false;
>>   
>> +	if (!drm_hdmi_connector_supports_infoframe(connector,
>> +						   HDMI_INFOFRAME_TYPE_SPD))
>> +		return 0;
>> +
>>   	ret = hdmi_spd_infoframe_init(frame,
>>   				      connector->hdmi.vendor,
>>   				      connector->hdmi.product);
>> @@ -742,6 +750,10 @@ static int hdmi_generate_hdr_infoframe(const struct drm_connector *connector,
>>   
>>   	infoframe->set = false;
>>   
>> +	if (!drm_hdmi_connector_supports_infoframe(connector,
>> +						   HDMI_INFOFRAME_TYPE_DRM))
>> +		return 0;
>> +
>>   	if (connector->max_bpc < 10)
>>   		return 0;
>>   
>> @@ -771,6 +783,10 @@ static int hdmi_generate_hdmi_vendor_infoframe(const struct drm_connector *conne
>>   
>>   	infoframe->set = false;
>>   
>> +	if (!drm_hdmi_connector_supports_infoframe(connector,
>> +						   HDMI_INFOFRAME_TYPE_VENDOR))
>> +		return 0;
>> +
>>   	if (!info->has_hdmi_infoframe)
>>   		return 0;
>>   
>> @@ -905,6 +921,11 @@ static int clear_device_infoframe(struct drm_connector *connector,
>>   		return 0;
>>   	}
>>   
>> +	if (!drm_hdmi_connector_supports_infoframe(connector, type)) {
>> +		drm_dbg_kms(dev, "Infoframe %d not supported, bailing.\n", type);
> 
> %d should be 0x%02x as type's value is 0x8*?

Good catch!

> 
>> +		return 0;
>> +	}
>> +
>>   	ret = funcs->clear_infoframe(connector, type);
>>   	if (ret) {
>>   		drm_dbg_kms(dev, "Call failed: %d\n", ret);
>> @@ -932,21 +953,27 @@ static int write_device_infoframe(struct drm_connector *connector,
>>   	const struct drm_connector_hdmi_funcs *funcs = connector->hdmi.funcs;
>>   	struct drm_device *dev = connector->dev;
>>   	u8 buffer[HDMI_INFOFRAME_SIZE(MAX)];
>> +	enum hdmi_infoframe_type type = frame->any.type;
> 
> Nit: follow reverse x'mas tree fashion.
> 
>>   	int ret;
>>   	int len;
>>   
>> -	drm_dbg_kms(dev, "Writing infoframe type %x\n", frame->any.type);
>> +	drm_dbg_kms(dev, "Writing infoframe type %x\n", type);
>>   
>>   	if (!funcs || !funcs->write_infoframe) {
>>   		drm_dbg_kms(dev, "Function not implemented, bailing.\n");
>>   		return -EINVAL;
>>   	}
>>   
>> +	if (!drm_hdmi_connector_supports_infoframe(connector, type)) {
>> +		drm_dbg_kms(dev, "Infoframe %d not supported, bailing.\n", type);
>> +		return 0;
>> +	}
>> +
>>   	len = hdmi_infoframe_pack(frame, buffer, sizeof(buffer));
>>   	if (len < 0)
>>   		return len;
>>   
>> -	ret = funcs->write_infoframe(connector, frame->any.type, buffer, len);
>> +	ret = funcs->write_infoframe(connector, type, buffer, len);
>>   	if (ret) {
>>   		drm_dbg_kms(dev, "Call failed: %d\n", ret);
>>   		return ret;
>> @@ -1067,6 +1094,12 @@ drm_atomic_helper_connector_hdmi_update_audio_infoframe(struct drm_connector *co
>>   	struct drm_display_info *info = &connector->display_info;
>>   	int ret;
>>   
>> +	if (!drm_hdmi_connector_supports_infoframe(connector,
>> +						   HDMI_INFOFRAME_TYPE_AUDIO)) {
>> +		drm_dbg_kms(connector->dev, "Audio Infoframe not supported, bailing.\n");
> 
> Maybe, print out error message instead of using drm_dbg_kms() since bridge
> should always set HDMI_INFOFRAME_TYPE_AUDIO if it calls this function?

drm_err_once() sounds logical, yes.

> 
>> +		return -EOPNOTSUPP;
>> +	}
>> +
>>   	if (!info->is_hdmi)
>>   		return 0;
>>   
>> @@ -1102,6 +1135,12 @@ drm_atomic_helper_connector_hdmi_clear_audio_infoframe(struct drm_connector *con
>>   	struct drm_display_info *info = &connector->display_info;
>>   	int ret;
>>   
>> +	if (!drm_hdmi_connector_supports_infoframe(connector,
>> +						   HDMI_INFOFRAME_TYPE_AUDIO)) {
>> +		drm_dbg_kms(connector->dev, "Audio Infoframe not supported, bailing.\n");
> 
> Ditto.
> 
>> +		return -EOPNOTSUPP;
>> +	}
>> +
>>   	if (!info->is_hdmi)
>>   		return 0;
>>   
>> diff --git a/drivers/gpu/drm/drm_connector.c b/drivers/gpu/drm/drm_connector.c
>> index 272d6254ea4784e97ca894ec4d463beebf9fdbf0..e753de9fc80a26c30b9674c96083328711f32960 100644
>> --- a/drivers/gpu/drm/drm_connector.c
>> +++ b/drivers/gpu/drm/drm_connector.c
>> @@ -553,6 +553,7 @@ EXPORT_SYMBOL(drmm_connector_init);
>>    * @connector_type: user visible type of the connector
>>    * @ddc: optional pointer to the associated ddc adapter
>>    * @supported_formats: Bitmask of @hdmi_colorspace listing supported output formats
>> + * @supported_infoframes: Bitmask of @DRM_CONNECTOR_INFOFRAME listing supported Infoframes
>>    * @max_bpc: Maximum bits per char the HDMI connector supports
>>    *
>>    * Initialises a preallocated HDMI connector. Connectors can be
>> @@ -576,6 +577,7 @@ int drmm_connector_hdmi_init(struct drm_device *dev,
>>   			     int connector_type,
>>   			     struct i2c_adapter *ddc,
>>   			     unsigned long supported_formats,
>> +			     unsigned long supported_infoframes,
>>   			     unsigned int max_bpc)
>>   {
>>   	int ret;
>> @@ -623,6 +625,8 @@ int drmm_connector_hdmi_init(struct drm_device *dev,
>>   
>>   	connector->hdmi.funcs = hdmi_funcs;
>>   
>> +	connector->hdmi.supported_infoframes = supported_infoframes;
>> +
>>   	return 0;
>>   }
>>   EXPORT_SYMBOL(drmm_connector_hdmi_init);
>> diff --git a/drivers/gpu/drm/drm_debugfs.c b/drivers/gpu/drm/drm_debugfs.c
>> index 365cf337529fa2a88b69516d57360d212419c126..248cb9ea1d8781674160cd8d454113c9422ec691 100644
>> --- a/drivers/gpu/drm/drm_debugfs.c
>> +++ b/drivers/gpu/drm/drm_debugfs.c
>> @@ -672,6 +672,9 @@ static int create_hdmi_audio_infoframe_file(struct drm_connector *connector,
>>   {
>>   	struct dentry *file;
>>   
>> +	if (!drm_hdmi_connector_supports_infoframe(connector, HDMI_INFOFRAME_TYPE_AUDIO))
>> +		return 0;
>> +
>>   	file = debugfs_create_file("audio", 0400, parent, connector, &audio_infoframe_fops);
>>   	if (IS_ERR(file))
>>   		return PTR_ERR(file);
>> @@ -679,7 +682,7 @@ static int create_hdmi_audio_infoframe_file(struct drm_connector *connector,
>>   	return 0;
>>   }
>>   
>> -#define DEFINE_INFOFRAME_FILE(_f) \
>> +#define DEFINE_INFOFRAME_FILE(_f, _F) \
>>   static ssize_t _f##_read_infoframe(struct file *filp, \
>>   				   char __user *ubuf, \
>>   				   size_t count,      \
>> @@ -726,6 +729,9 @@ static int create_hdmi_## _f ## _infoframe_file(struct drm_connector *connector,
>>   { \
>>   	struct dentry *file; \
>>   	\
>> +	if (!drm_hdmi_connector_supports_infoframe(connector, HDMI_INFOFRAME_TYPE_ ## _F)) \
>> +		return 0; \
>> +	\
>>   	file = debugfs_create_file(#_f, 0400, parent, connector, &_f ## _infoframe_fops); \
>>   	if (IS_ERR(file)) \
>>   		return PTR_ERR(file); \
>> @@ -733,10 +739,10 @@ static int create_hdmi_## _f ## _infoframe_file(struct drm_connector *connector,
>>   	return 0; \
>>   }
>>   
>> -DEFINE_INFOFRAME_FILE(avi);
>> -DEFINE_INFOFRAME_FILE(hdmi);
>> -DEFINE_INFOFRAME_FILE(hdr_drm);
>> -DEFINE_INFOFRAME_FILE(spd);
>> +DEFINE_INFOFRAME_FILE(avi, AVI);
>> +DEFINE_INFOFRAME_FILE(hdmi, VENDOR);
>> +DEFINE_INFOFRAME_FILE(hdr_drm, DRM);
>> +DEFINE_INFOFRAME_FILE(spd, SPD);
>>   
>>   static int create_hdmi_infoframe_files(struct drm_connector *connector,
>>   				       struct dentry *parent)
>> diff --git a/drivers/gpu/drm/rockchip/inno_hdmi.c b/drivers/gpu/drm/rockchip/inno_hdmi.c
>> index 1ab3ad4bde9ea7305021186ea221d2ff9057fdbb..65eed5ae23194200c145cb174acff4f252b3ef1f 100644
>> --- a/drivers/gpu/drm/rockchip/inno_hdmi.c
>> +++ b/drivers/gpu/drm/rockchip/inno_hdmi.c
>> @@ -1065,6 +1065,7 @@ static int inno_hdmi_register(struct drm_device *drm, struct inno_hdmi *hdmi)
>>   				 DRM_MODE_CONNECTOR_HDMIA,
>>   				 hdmi->ddc,
>>   				 BIT(HDMI_COLORSPACE_RGB),
>> +				 DRM_CONNECTOR_INFOFRAME_AVI,
>>   				 8);
>>   
>>   	drm_connector_attach_encoder(&hdmi->connector, encoder);
>> diff --git a/drivers/gpu/drm/sun4i/sun4i_hdmi_enc.c b/drivers/gpu/drm/sun4i/sun4i_hdmi_enc.c
>> index ab0938ba61f7d75dd0bec473807a04a20e1cffbd..0b931da4ea2d4eb58a6224476059b9205e8626b4 100644
>> --- a/drivers/gpu/drm/sun4i/sun4i_hdmi_enc.c
>> +++ b/drivers/gpu/drm/sun4i/sun4i_hdmi_enc.c
>> @@ -640,6 +640,7 @@ static int sun4i_hdmi_bind(struct device *dev, struct device *master,
>>   				       DRM_MODE_CONNECTOR_HDMIA,
>>   				       hdmi->ddc_i2c,
>>   				       BIT(HDMI_COLORSPACE_RGB),
>> +				       DRM_CONNECTOR_INFOFRAME_AVI,
>>   				       8);
>>   	if (ret) {
>>   		dev_err(dev,
>> diff --git a/drivers/gpu/drm/tests/drm_connector_test.c b/drivers/gpu/drm/tests/drm_connector_test.c
>> index 22e2d959eb31459f9981fef488228904d67cb6f9..fd28ed2bf8bcecabaabc67f2f8f5ccc1f42525d3 100644
>> --- a/drivers/gpu/drm/tests/drm_connector_test.c
>> +++ b/drivers/gpu/drm/tests/drm_connector_test.c
>> @@ -641,6 +641,13 @@ static struct kunit_suite drm_connector_dynamic_register_test_suite = {
>>   	.test_cases = drm_connector_dynamic_register_tests,
>>   };
>>   
>> +#define DRM_CONNECTOR_ALL_INFOFRAMES \
>> +	(DRM_CONNECTOR_INFOFRAME_AUDIO | \
>> +	 DRM_CONNECTOR_INFOFRAME_AVI | \
>> +	 DRM_CONNECTOR_INFOFRAME_DRM | \
>> +	 DRM_CONNECTOR_INFOFRAME_SPD | \
>> +	 DRM_CONNECTOR_INFOFRAME_VENDOR)
>> +
>>   /*
>>    * Test that the registration of a bog standard connector works as
>>    * expected and doesn't report any error.
>> @@ -657,6 +664,7 @@ static void drm_test_connector_hdmi_init_valid(struct kunit *test)
>>   				       DRM_MODE_CONNECTOR_HDMIA,
>>   				       &priv->ddc,
>>   				       BIT(HDMI_COLORSPACE_RGB),
>> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>>   				       8);
>>   	KUNIT_EXPECT_EQ(test, ret, 0);
>>   }
>> @@ -677,6 +685,7 @@ static void drm_test_connector_hdmi_init_null_ddc(struct kunit *test)
>>   				       DRM_MODE_CONNECTOR_HDMIA,
>>   				       NULL,
>>   				       BIT(HDMI_COLORSPACE_RGB),
>> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>>   				       8);
>>   	KUNIT_EXPECT_EQ(test, ret, 0);
>>   }
>> @@ -697,6 +706,7 @@ static void drm_test_connector_hdmi_init_null_vendor(struct kunit *test)
>>   				       DRM_MODE_CONNECTOR_HDMIA,
>>   				       &priv->ddc,
>>   				       BIT(HDMI_COLORSPACE_RGB),
>> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>>   				       8);
>>   	KUNIT_EXPECT_LT(test, ret, 0);
>>   }
>> @@ -717,6 +727,7 @@ static void drm_test_connector_hdmi_init_null_product(struct kunit *test)
>>   				       DRM_MODE_CONNECTOR_HDMIA,
>>   				       &priv->ddc,
>>   				       BIT(HDMI_COLORSPACE_RGB),
>> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>>   				       8);
>>   	KUNIT_EXPECT_LT(test, ret, 0);
>>   }
>> @@ -743,6 +754,7 @@ static void drm_test_connector_hdmi_init_product_valid(struct kunit *test)
>>   				       DRM_MODE_CONNECTOR_HDMIA,
>>   				       &priv->ddc,
>>   				       BIT(HDMI_COLORSPACE_RGB),
>> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>>   				       8);
>>   	KUNIT_EXPECT_EQ(test, ret, 0);
>>   	KUNIT_EXPECT_MEMEQ(test,
>> @@ -776,6 +788,7 @@ static void drm_test_connector_hdmi_init_product_length_exact(struct kunit *test
>>   				       DRM_MODE_CONNECTOR_HDMIA,
>>   				       &priv->ddc,
>>   				       BIT(HDMI_COLORSPACE_RGB),
>> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>>   				       8);
>>   	KUNIT_EXPECT_EQ(test, ret, 0);
>>   	KUNIT_EXPECT_MEMEQ(test,
>> @@ -803,6 +816,7 @@ static void drm_test_connector_hdmi_init_product_length_too_long(struct kunit *t
>>   				       DRM_MODE_CONNECTOR_HDMIA,
>>   				       &priv->ddc,
>>   				       BIT(HDMI_COLORSPACE_RGB),
>> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>>   				       8);
>>   	KUNIT_EXPECT_LT(test, ret, 0);
>>   }
>> @@ -829,6 +843,7 @@ static void drm_test_connector_hdmi_init_vendor_valid(struct kunit *test)
>>   				       DRM_MODE_CONNECTOR_HDMIA,
>>   				       &priv->ddc,
>>   				       BIT(HDMI_COLORSPACE_RGB),
>> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>>   				       8);
>>   	KUNIT_EXPECT_EQ(test, ret, 0);
>>   	KUNIT_EXPECT_MEMEQ(test,
>> @@ -861,6 +876,7 @@ static void drm_test_connector_hdmi_init_vendor_length_exact(struct kunit *test)
>>   				       DRM_MODE_CONNECTOR_HDMIA,
>>   				       &priv->ddc,
>>   				       BIT(HDMI_COLORSPACE_RGB),
>> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>>   				       8);
>>   	KUNIT_EXPECT_EQ(test, ret, 0);
>>   	KUNIT_EXPECT_MEMEQ(test,
>> @@ -888,6 +904,7 @@ static void drm_test_connector_hdmi_init_vendor_length_too_long(struct kunit *te
>>   				       DRM_MODE_CONNECTOR_HDMIA,
>>   				       &priv->ddc,
>>   				       BIT(HDMI_COLORSPACE_RGB),
>> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>>   				       8);
>>   	KUNIT_EXPECT_LT(test, ret, 0);
>>   }
>> @@ -908,6 +925,7 @@ static void drm_test_connector_hdmi_init_bpc_invalid(struct kunit *test)
>>   				       DRM_MODE_CONNECTOR_HDMIA,
>>   				       &priv->ddc,
>>   				       BIT(HDMI_COLORSPACE_RGB),
>> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>>   				       9);
>>   	KUNIT_EXPECT_LT(test, ret, 0);
>>   }
>> @@ -928,6 +946,7 @@ static void drm_test_connector_hdmi_init_bpc_null(struct kunit *test)
>>   				       DRM_MODE_CONNECTOR_HDMIA,
>>   				       &priv->ddc,
>>   				       BIT(HDMI_COLORSPACE_RGB),
>> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>>   				       0);
>>   	KUNIT_EXPECT_LT(test, ret, 0);
>>   }
>> @@ -953,6 +972,7 @@ static void drm_test_connector_hdmi_init_bpc_8(struct kunit *test)
>>   				       DRM_MODE_CONNECTOR_HDMIA,
>>   				       &priv->ddc,
>>   				       BIT(HDMI_COLORSPACE_RGB),
>> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>>   				       8);
>>   	KUNIT_EXPECT_EQ(test, ret, 0);
>>   
>> @@ -994,6 +1014,7 @@ static void drm_test_connector_hdmi_init_bpc_10(struct kunit *test)
>>   				       DRM_MODE_CONNECTOR_HDMIA,
>>   				       &priv->ddc,
>>   				       BIT(HDMI_COLORSPACE_RGB),
>> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>>   				       10);
>>   	KUNIT_EXPECT_EQ(test, ret, 0);
>>   
>> @@ -1035,6 +1056,7 @@ static void drm_test_connector_hdmi_init_bpc_12(struct kunit *test)
>>   				       DRM_MODE_CONNECTOR_HDMIA,
>>   				       &priv->ddc,
>>   				       BIT(HDMI_COLORSPACE_RGB),
>> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>>   				       12);
>>   	KUNIT_EXPECT_EQ(test, ret, 0);
>>   
>> @@ -1071,6 +1093,7 @@ static void drm_test_connector_hdmi_init_formats_empty(struct kunit *test)
>>   				       DRM_MODE_CONNECTOR_HDMIA,
>>   				       &priv->ddc,
>>   				       0,
>> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>>   				       8);
>>   	KUNIT_EXPECT_LT(test, ret, 0);
>>   }
>> @@ -1091,6 +1114,7 @@ static void drm_test_connector_hdmi_init_formats_no_rgb(struct kunit *test)
>>   				       DRM_MODE_CONNECTOR_HDMIA,
>>   				       &priv->ddc,
>>   				       BIT(HDMI_COLORSPACE_YUV422),
>> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>>   				       8);
>>   	KUNIT_EXPECT_LT(test, ret, 0);
>>   }
>> @@ -1149,6 +1173,7 @@ static void drm_test_connector_hdmi_init_formats_yuv420_allowed(struct kunit *te
>>   				       DRM_MODE_CONNECTOR_HDMIA,
>>   				       &priv->ddc,
>>   				       params->supported_formats,
>> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>>   				       8);
>>   	KUNIT_EXPECT_EQ(test, ret, params->expected_result);
>>   }
>> @@ -1170,6 +1195,7 @@ static void drm_test_connector_hdmi_init_type_valid(struct kunit *test)
>>   				       connector_type,
>>   				       &priv->ddc,
>>   				       BIT(HDMI_COLORSPACE_RGB),
>> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>>   				       8);
>>   	KUNIT_EXPECT_EQ(test, ret, 0);
>>   }
>> @@ -1205,6 +1231,7 @@ static void drm_test_connector_hdmi_init_type_invalid(struct kunit *test)
>>   				       connector_type,
>>   				       &priv->ddc,
>>   				       BIT(HDMI_COLORSPACE_RGB),
>> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>>   				       8);
>>   	KUNIT_EXPECT_LT(test, ret, 0);
>>   }
>> @@ -1482,6 +1509,7 @@ static void drm_test_drm_connector_attach_broadcast_rgb_property_hdmi_connector(
>>   				       DRM_MODE_CONNECTOR_HDMIA,
>>   				       &priv->ddc,
>>   				       BIT(HDMI_COLORSPACE_RGB),
>> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>>   				       8);
>>   	KUNIT_EXPECT_EQ(test, ret, 0);
>>   
>> diff --git a/drivers/gpu/drm/tests/drm_hdmi_state_helper_test.c b/drivers/gpu/drm/tests/drm_hdmi_state_helper_test.c
>> index 8bd412735000cb18e66aeca21433b2ebbefe2b44..2901fcb6b12ee318a4a9c727a62d5290d7c9aa84 100644
>> --- a/drivers/gpu/drm/tests/drm_hdmi_state_helper_test.c
>> +++ b/drivers/gpu/drm/tests/drm_hdmi_state_helper_test.c
>> @@ -138,6 +138,13 @@ static const struct drm_connector_funcs dummy_connector_funcs = {
>>   	.reset			= dummy_hdmi_connector_reset,
>>   };
>>   
>> +#define DRM_CONNECTOR_ALL_INFOFRAMES \
>> +	(DRM_CONNECTOR_INFOFRAME_AUDIO | \
>> +	 DRM_CONNECTOR_INFOFRAME_AVI | \
>> +	 DRM_CONNECTOR_INFOFRAME_DRM | \
>> +	 DRM_CONNECTOR_INFOFRAME_SPD | \
>> +	 DRM_CONNECTOR_INFOFRAME_VENDOR)
>> +
>>   static
>>   struct drm_atomic_helper_connector_hdmi_priv *
>>   __connector_hdmi_init(struct kunit *test,
>> @@ -192,6 +199,7 @@ __connector_hdmi_init(struct kunit *test,
>>   				       DRM_MODE_CONNECTOR_HDMIA,
>>   				       NULL,
>>   				       formats,
>> +				       DRM_CONNECTOR_ALL_INFOFRAMES,
>>   				       max_bpc);
>>   	KUNIT_ASSERT_EQ(test, ret, 0);
>>   
>> diff --git a/drivers/gpu/drm/vc4/vc4_hdmi.c b/drivers/gpu/drm/vc4/vc4_hdmi.c
>> index 07c91b450f93ab9e795d040d6f60f485ac71cfe8..f7024fd554e04dbfa38d24f775ec5993ac8db335 100644
>> --- a/drivers/gpu/drm/vc4/vc4_hdmi.c
>> +++ b/drivers/gpu/drm/vc4/vc4_hdmi.c
>> @@ -556,6 +556,10 @@ static int vc4_hdmi_connector_init(struct drm_device *dev,
>>   				       BIT(HDMI_COLORSPACE_RGB) |
>>   				       BIT(HDMI_COLORSPACE_YUV422) |
>>   				       BIT(HDMI_COLORSPACE_YUV444),
>> +				       DRM_CONNECTOR_INFOFRAME_AVI |
>> +				       DRM_CONNECTOR_INFOFRAME_DRM |
>> +				       DRM_CONNECTOR_INFOFRAME_SPD |
>> +				       DRM_CONNECTOR_INFOFRAME_VENDOR,
> 
> I see vc4_hdmi.c calls drm_connector_hdmi_audio_init() (though calls it
> twice...) and hence drm_atomic_helper_connector_hdmi_update_audio_infoframe(),
> so this mask should be DRM_CONNECTOR_ALL_INFOFRAMES as vc4 HDMI seems support
> audio infoframe?

Yes, thanks for the catch!

> 
> However, vc4_hdmi_audio_init() could return early with 0 before calling
> drm_connector_hdmi_audio_init().
> 
>>   				       max_bpc);
>>   	if (ret)
>>   		return ret;
>> diff --git a/include/drm/drm_bridge.h b/include/drm/drm_bridge.h
>> index 620e119cc24c3491c2be5f08efaf51dfa8f708b3..529dcaca1d7924da12d9587170f96ec6a00ad126 100644
>> --- a/include/drm/drm_bridge.h
>> +++ b/include/drm/drm_bridge.h
>> @@ -1153,6 +1153,13 @@ struct drm_bridge {
>>   	 */
>>   	unsigned int max_bpc;
>>   
>> +	/**
>> +	 * @supported_infoframes: Bitmask of DRM_CONNECTOR_INFOFRAME values,
>> +	 * listing supported infoframes. This is only relevant if
>> +	 * @DRM_BRIDGE_OP_HDMI is set.
>> +	 */
>> +	unsigned int supported_infoframes;
>> +
>>   	/**
>>   	 * @hdmi_cec_dev: device to be used as a containing device for CEC
>>   	 * functions.
>> diff --git a/include/drm/drm_connector.h b/include/drm/drm_connector.h
>> index 8f34f4b8183d83dccd3e820a444fbf74fb6c16f2..5b4bc1d7d566d28f90f0aa342a1258685dda6bd0 100644
>> --- a/include/drm/drm_connector.h
>> +++ b/include/drm/drm_connector.h
>> @@ -1839,6 +1839,12 @@ struct drm_connector_hdmi {
>>   	 */
>>   	unsigned long supported_formats;
>>   
>> +	/**
>> +	 * @supported_infoframes: Bitmask of infoframe types supported by the
>> +	 * controller. See @DRM_CONNECTOR_INFOFRAME.
>> +	 */
>> +	unsigned long supported_infoframes;
>> +
>>   	/**
>>   	 * @funcs: HDMI connector Control Functions
>>   	 */
>> @@ -2336,6 +2342,7 @@ int drmm_connector_hdmi_init(struct drm_device *dev,
>>   			     int connector_type,
>>   			     struct i2c_adapter *ddc,
>>   			     unsigned long supported_formats,
>> +			     unsigned long supported_infoframes,
>>   			     unsigned int max_bpc);
>>   void drm_connector_attach_edid_property(struct drm_connector *connector);
>>   int drm_connector_register(struct drm_connector *connector);
>> @@ -2488,6 +2495,22 @@ void drm_connector_attach_privacy_screen_provider(
>>   	struct drm_connector *connector, struct drm_privacy_screen *priv);
>>   void drm_connector_update_privacy_screen(const struct drm_connector_state *connector_state);
>>   
>> +#define DRM_CONNECTOR_INFOFRAME(type)	\
>> +	BIT(type - 0x80)
> 
> Nit: the above two lines fit into one single line.  I'd write:
> 
> #define DRM_CONNECTOR_INFOFRAME(type)  BIT((type) - 0x80)
> 
>> +
>> +#define DRM_CONNECTOR_INFOFRAME_AUDIO DRM_CONNECTOR_INFOFRAME(HDMI_INFOFRAME_TYPE_AUDIO)
>> +#define DRM_CONNECTOR_INFOFRAME_AVI DRM_CONNECTOR_INFOFRAME(HDMI_INFOFRAME_TYPE_AVI)
>> +#define DRM_CONNECTOR_INFOFRAME_DRM DRM_CONNECTOR_INFOFRAME(HDMI_INFOFRAME_TYPE_DRM)
>> +#define DRM_CONNECTOR_INFOFRAME_SPD DRM_CONNECTOR_INFOFRAME(HDMI_INFOFRAME_TYPE_SPD)
>> +#define DRM_CONNECTOR_INFOFRAME_VENDOR DRM_CONNECTOR_INFOFRAME(HDMI_INFOFRAME_TYPE_VENDOR)
> 
> Can you align the above macro definitions vertically?

Ack for the formatting suggestions

> 
>> +
>> +static inline bool
>> +drm_hdmi_connector_supports_infoframe(const struct drm_connector *connector,
>> +				      enum hdmi_infoframe_type type)
>> +{
>> +	return connector->hdmi.supported_infoframes & DRM_CONNECTOR_INFOFRAME(type);
>> +}
>> +
>>   /**
>>    * struct drm_tile_group - Tile group metadata
>>    * @refcount: reference count
>>
> 
> 


-- 
With best wishes
Dmitry

From mboxrd@z Thu Jan  1 00:00:00 1970
Received: from AS8PR04CU009.outbound.protection.outlook.com (mail-westeuropeazon11011007.outbound.protection.outlook.com [52.101.70.7])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by smtp.subspace.kernel.org (Postfix) with ESMTPS id 45781319864
	for <linux-sunxi@lists.linux.dev>; Tue, 19 Aug 2025 09:48:26 +0000 (UTC)
Authentication-Results: smtp.subspace.kernel.org; arc=fail smtp.client-ip=52.101.70.7
ARC-Seal: i=2; a=rsa-sha256; d=subspace.kernel.org; s=arc-20240116;
	t=1755596909; cv=fail; b=J35NGvD3Be8EXhdOvqVBxvpeQtBWvy/7vYvxO3fcQfMQo5hlX1JN5DxLmbNlxlwx4IB0asDjDS7I/4T3HD5wnTE0pJJFbpPAdkCGgvmzlf75VFtHAb1+Q3eo7RMgQyiihVMSm4KAO/h6iPl4L2ddFUCjHQtK+w0VRfBH2OVhjtY=
ARC-Message-Signature: i=2; a=rsa-sha256; d=subspace.kernel.org;
	s=arc-20240116; t=1755596909; c=relaxed/simple;
	bh=4c8UylYxUdqsKog66ftMJizYz/VOzMfyeqH1xxsEoas=;
	h=Message-ID:Date:Subject:To:Cc:References:From:In-Reply-To:
	 Content-Type:MIME-Version; b=Q6l1Tm+jGS2+IfFxYWoH+6CU1Kpw2qmWHQGSDgrRskOXqxsr8tdS6Hs47hcSQHDcuEDyK5ryaYRFKhzFXwfAuqOKPmQ/+mwiHXKQFY/E/FIdc4BbF1D83DL2jlA0fjyp3ooor9MpnsUyRRkb9S5wozy8ZCvZdMts6OxXrIRRqD4=
ARC-Authentication-Results: i=2; smtp.subspace.kernel.org; dmarc=pass (p=none dis=none) header.from=nxp.com; spf=pass smtp.mailfrom=nxp.com; dkim=pass (2048-bit key) header.d=nxp.com header.i=@nxp.com header.b=EVD+MD+M; arc=fail smtp.client-ip=52.101.70.7
Authentication-Results: smtp.subspace.kernel.org; dmarc=pass (p=none dis=none) header.from=nxp.com
Authentication-Results: smtp.subspace.kernel.org; spf=pass smtp.mailfrom=nxp.com
Authentication-Results: smtp.subspace.kernel.org;
	dkim=pass (2048-bit key) header.d=nxp.com header.i=@nxp.com header.b="EVD+MD+M"
ARC-Seal: i=1; a=rsa-sha256; s=arcselector10001; d=microsoft.com; cv=none;
 b=sT8p3ouFgMgqLnFAopXhvh+kflz34OdzjiEnz2iU37W6cEEFjlSMhaaak/KqY1rVnBcejF2lN157w9W7MzJ0D74pr5IpoMxoWbWGWlmmqCE9bmn/WIzDiRAGDfIBaJdVWf61My3wWTGowDvL5QefdMCxxqlG2OLAHiRHNsM8yrABMe2rE2t+Al9cOLmfesRbMMdtgIukeVygiIi2fOcktak3nWfMVa+eMqTDnGmTaQ1quWt0d8weXovJYzoa4zr+nFy6c11pO0IieUK8vujzBhBvfFYRgHYZgzzpZS0kn7neBFCZBv2TFc8Qg3AKNjA8hwMBhgfrCBwLJm0McLqVNQ==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com;
 s=arcselector10001;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-AntiSpam-MessageData-ChunkCount:X-MS-Exchange-AntiSpam-MessageData-0:X-MS-Exchange-AntiSpam-MessageData-1;
 bh=CH6+Os8I38BhAU5PE9v2zMQjGM3xP9/iQUuSjuOjWX8=;
 b=R+FDgbu8IAjfegqomc8EykIhRq4uOD+fQe6D3uk5ypqiFYmD7u3CchukQz8Bs3qN+V9GYHJ30HuMJZPhE/rBPOMx1/8bRE9PsAZ5xDSiclynQcwiyPeDYgYQpDc2I1UjLbq62DhIMNK5RyhJF+G1S7MdNvJM22ltUuEZ13YzbWahXqjDlnqBE6MSJNF9bH9loY1c0r8Lh03/VrmmX9VCJ9OkPjS1z4pyi+gaujGegXxNyuuh2aX0cnAFlMalhL8EJfBO+YD+0sDauqUxNonJ3NstfZp0wnHmhm5BFoG9i/W5pJWXvDy0p3i5by1zcfucbCYqUQIo2RpuolAG/zRqng==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=nxp.com; dmarc=pass action=none header.from=nxp.com; dkim=pass
 header.d=nxp.com; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=nxp.com; s=selector1;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=CH6+Os8I38BhAU5PE9v2zMQjGM3xP9/iQUuSjuOjWX8=;
 b=EVD+MD+Mqa8jTefM1oGoEcmbTTYNvOv9dNnB5pIz3GisRCNmDZTWutjX0VOt1QaBAkAztDdoXHRwVksvKpnVKqr8JOwCaVEIuDw2Z73SoXKDInAcxtPs3D4tU/WZIRrr5y/ATIyO40IC9EnxMLJIoTn+Db/At/c5yYLv75gdmJWj+WhwvyQicFT9koPUlexjL7O0kIhxhJOohVUH37It4hdPJfakmKnf3h+HPrGgurWVio7TJaNfYXUxvUX5xHWOqoqFi29Nwq7Pvtl+EBW0ypZT7ktmmQ0XPzgnovfsXZBJOr+odNTA5DD+YCMsyhFbFNg8EsDiZqHOfsCofjw9RQ==
Authentication-Results: dkim=none (message not signed)
 header.d=none;dmarc=none action=none header.from=nxp.com;
Received: from AM7PR04MB7046.eurprd04.prod.outlook.com (2603:10a6:20b:113::22)
 by AM9PR04MB8794.eurprd04.prod.outlook.com (2603:10a6:20b:409::10) with
 Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.9052.13; Tue, 19 Aug
 2025 09:48:24 +0000
Received: from AM7PR04MB7046.eurprd04.prod.outlook.com
 ([fe80::d1ce:ea15:6648:6f90]) by AM7PR04MB7046.eurprd04.prod.outlook.com
 ([fe80::d1ce:ea15:6648:6f90%5]) with mapi id 15.20.9052.011; Tue, 19 Aug 2025
 09:48:24 +0000
Message-ID: <9e77615a-9d5b-4971-b1db-74d6bed39533@nxp.com>
Date: Tue, 19 Aug 2025 17:49:54 +0800
User-Agent: Mozilla Thunderbird
Subject: Re: [PATCH 3/7] drm/bridge: ite-it6232: declare supported infoframes
To: Dmitry Baryshkov <dmitry.baryshkov@oss.qualcomm.com>,
 Andrzej Hajda <andrzej.hajda@intel.com>,
 Neil Armstrong <neil.armstrong@linaro.org>, Robert Foss <rfoss@kernel.org>,
 Laurent Pinchart <Laurent.pinchart@ideasonboard.com>,
 Jonas Karlman <jonas@kwiboo.se>, Jernej Skrabec <jernej.skrabec@gmail.com>,
 Maarten Lankhorst <maarten.lankhorst@linux.intel.com>,
 Maxime Ripard <mripard@kernel.org>, Thomas Zimmermann <tzimmermann@suse.de>,
 David Airlie <airlied@gmail.com>, Simona Vetter <simona@ffwll.ch>,
 Sandy Huang <hjc@rock-chips.com>, =?UTF-8?Q?Heiko_St=C3=BCbner?=
 <heiko@sntech.de>, Andy Yan <andy.yan@rock-chips.com>,
 Chen-Yu Tsai <wens@csie.org>, Samuel Holland <samuel@sholland.org>,
 Dave Stevenson <dave.stevenson@raspberrypi.com>,
 =?UTF-8?Q?Ma=C3=ADra_Canal?= <mcanal@igalia.com>,
 Raspberry Pi Kernel Maintenance <kernel-list@raspberrypi.com>,
 Rob Clark <robin.clark@oss.qualcomm.com>, Dmitry Baryshkov
 <lumag@kernel.org>, Abhinav Kumar <abhinav.kumar@linux.dev>,
 Jessica Zhang <jessica.zhang@oss.qualcomm.com>, Sean Paul <sean@poorly.run>,
 Marijn Suijten <marijn.suijten@somainline.org>
Cc: dri-devel@lists.freedesktop.org, linux-kernel@vger.kernel.org,
 linux-arm-kernel@lists.infradead.org, linux-rockchip@lists.infradead.org,
 linux-sunxi@lists.linux.dev, linux-arm-msm@vger.kernel.org,
 freedreno@lists.freedesktop.org
References: <20250816-drm-limit-infoframes-v1-0-6dc17d5f07e9@oss.qualcomm.com>
 <20250816-drm-limit-infoframes-v1-3-6dc17d5f07e9@oss.qualcomm.com>
From: Liu Ying <victor.liu@nxp.com>
Content-Language: en-US
In-Reply-To: <20250816-drm-limit-infoframes-v1-3-6dc17d5f07e9@oss.qualcomm.com>
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
X-ClientProxiedBy: SI2PR01CA0033.apcprd01.prod.exchangelabs.com
 (2603:1096:4:192::23) To AM7PR04MB7046.eurprd04.prod.outlook.com
 (2603:10a6:20b:113::22)
Precedence: bulk
X-Mailing-List: linux-sunxi@lists.linux.dev
List-Id: <linux-sunxi.lists.linux.dev>
List-Subscribe: <mailto:linux-sunxi+subscribe@lists.linux.dev>
List-Unsubscribe: <mailto:linux-sunxi+unsubscribe@lists.linux.dev>
MIME-Version: 1.0
X-MS-PublicTrafficType: Email
X-MS-TrafficTypeDiagnostic: AM7PR04MB7046:EE_|AM9PR04MB8794:EE_
X-MS-Office365-Filtering-Correlation-Id: 33719af9-7c8f-47f5-12c8-08dddf0589de
X-LD-Processed: 686ea1d3-bc2b-4c6f-a92c-d99c5c301635,ExtAddr
X-MS-Exchange-SenderADCheck: 1
X-MS-Exchange-AntiSpam-Relay: 0
X-Microsoft-Antispam: 
 BCL:0;ARA:13230040|19092799006|376014|7416014|1800799024|366016|7053199007|921020;
X-Microsoft-Antispam-Message-Info: 
 =?utf-8?B?MjhBSGRISU9IeS80OXkvaWphTHk0dGs4T1AxNlNxaGRMMlVxb2VtdWF0Nzhq?=
 =?utf-8?B?Z2JyN3FSYU11bjV1QitpdG1sZjg3QkFxcVNqQXl3THhhVElhT2RUMkwzRGNO?=
 =?utf-8?B?MXQrREJvL0NkMUZ5OC9ScXpXand1WGRSWG1UZjE2TnNPRmFCNDFzV3BELzkr?=
 =?utf-8?B?VW1QU3Z2b0dtOWp1aEhZY28vZVNOSWFpdk9GamJnQ1ZuRDhYeUtSRkJFOEx2?=
 =?utf-8?B?eVdRZ2ptYnd1TDFOZUZNT25DdUlJVG5mRGZxLytwWUNUM3k4M2Vpc1pSUVZj?=
 =?utf-8?B?U05HSXJoN05XdkNhRGo5WGNoVGFVdE9iMHN1bWl0SzVSMmhmVS9kVGp0cjR1?=
 =?utf-8?B?aHVUWTZOMG9kMi81NE5xL2M5Qy9PTGRrd1l3d1pWYm41RmJJaDMyUjFwODVE?=
 =?utf-8?B?Vmg4c3pSckVGSzhOcDlZUVJNT0dyZXYxSy9qbG5hWWdLckZid1JZSHNoL25o?=
 =?utf-8?B?enJaVlB1Vm9kVE1DRDlqNXdDQURzVjN3dDBtRzRSeTI1c05ybTlZZitDa2xu?=
 =?utf-8?B?M3JXYkJia1JaeWw3SVUxWWVoKzl4UDZxa2N5UytGVXZSS2NzWGRlY21aT2ZG?=
 =?utf-8?B?ZWlnV1hYVU9uQVFUd3hMbGtwb1FoOUc3cmQ2b0VtZEE3TTZTcWd3K3BwZU9r?=
 =?utf-8?B?K0NHbHErWnljNDJSRWNnUXEzS0svUWF6aWllR3ZiTmRFMUpxVk5MWmFDTkd0?=
 =?utf-8?B?d3F6TllJNmtJWVMzcldtY1V1Y3RqY0l0VmpML250UjFOVzNyeE9zZmhUZVgy?=
 =?utf-8?B?UTJCTzNQTXdrOVF3WVErbHpKWkNCVElMelRIYlpCbUZ4ZU9HNmlJN0dyVzlL?=
 =?utf-8?B?b1NYZHlWOEt6cERHaU5xNFRZUVpNd1paYmd2YnVNUmhhK2VTZlkxVDd5QTli?=
 =?utf-8?B?WkxKQVJqcUJURDNWcFNUMVBkZkphZktBYThRdkFpdEMweXY1ZGdSMmxnS2Z2?=
 =?utf-8?B?UjhGbms3NzVqQjNMbkNKcUllUUlEd2wzRFdxK05GMC9mYzhOa2NOSjlybkQv?=
 =?utf-8?B?dWp3MWdhOE5oZFkrNWtUZ1FkZ21uenVadXZpVzBCMENaYm40cXgyMFQxWkxx?=
 =?utf-8?B?RzFDNVhJeklHK3E3YTZEU0dHWExkRUlDdmpoSkxHTUVxVWU2QzhmK1Q3RnRD?=
 =?utf-8?B?QUpDTnA4RUJVeWViUk55OGFuRm1GN3BuMUxKbzVrbTBjNzdFdTY0SEt1WEE5?=
 =?utf-8?B?K0VDK2NZMmVhak95UnM3Q2RjbGt0NkJ5TXNuTDQzSE9MN1pOWHdQclREdWZQ?=
 =?utf-8?B?Kzc3cTBocGdYQW8zKzYwa2dGby9YQW81cTRXWGQ5bEFjaENiREwzVng5STFx?=
 =?utf-8?B?RklILy9NaU81emhvSFZlRnM1cmYzQWlqc082ZWhuWWlpUlU0dHNGM2NZcXhY?=
 =?utf-8?B?clZFOE50TnhyVDhsWERxcGdadnU3R3E4Sk92dFREVTM5K1BQRTl3MEZIWlVV?=
 =?utf-8?B?bldNZGtOc0dSWi84OEhubVNYdmxuVk85V1pCV29iSlpyaGNvU2RhZU94NUVk?=
 =?utf-8?B?SHlEUzFDMUFtenhVcWdaam1mUjdnblFOdWdGVzNFWDAxM28wZ3U4MkVFMWdJ?=
 =?utf-8?B?eEtyQm5nOFI5OG1kMjdEV0h0alNrWDhsLzZJZXV0TldOUXZlMnc0UXFpU2h6?=
 =?utf-8?B?UVlWdFRtUE1xeXVRc29vek15bXVBb3VtcXNLZDJ1RTA1REk1Ynk3bGlHR0Ux?=
 =?utf-8?B?WXZHS1hHVUpJdzQ3K3gyUzBKQkhNbmFGN0R6dG0vSi9lcUUzdFN2TEF5cmw1?=
 =?utf-8?B?Q1pISHpxSXBwZ0I4TXBiZEpMVWh2YTVLUjFWa2ZZZGZwbGZvNS9GMUoxd1pX?=
 =?utf-8?B?c2FBWWJlS1JhR3BiZWRKUHExeTBqbU1hTVBhSGc1K2xteWFodTJvVUkzdnE4?=
 =?utf-8?B?Sk9zTW5vMkZ2M1NzMVlvZnNoVjB5b0taMm5JMENMTURFVTl1SUl2RGRvU0d6?=
 =?utf-8?B?enBzSEwvSFViSHgvRS9NanQ0ejdtOGppSXIrUVpOcEpOa3hQR0lYNCtKUkxz?=
 =?utf-8?B?dnRVSzZKR0RBPT0=?=
X-Forefront-Antispam-Report: 
 CIP:255.255.255.255;CTRY:;LANG:en;SCL:1;SRV:;IPV:NLI;SFV:NSPM;H:AM7PR04MB7046.eurprd04.prod.outlook.com;PTR:;CAT:NONE;SFS:(13230040)(19092799006)(376014)(7416014)(1800799024)(366016)(7053199007)(921020);DIR:OUT;SFP:1101;
X-MS-Exchange-AntiSpam-MessageData-ChunkCount: 1
X-MS-Exchange-AntiSpam-MessageData-0: 
 =?utf-8?B?N1NSSGxDSDlya2FLeVJsWStaTFU2WUtGQTVMQjlEMmkxWTcxNE11WjNOS0Ns?=
 =?utf-8?B?OUNQaEhVQVpsSDBLWTNwZTUyYWpqU3lLMzhrbE1zQUdCb1pWSU9hSjhlNUM2?=
 =?utf-8?B?ZU5KdXFodUxKOE5WZk9HdHF6SUJWVmRhVkVrVkhCZ2xaenRxVUNhcFJsdE1M?=
 =?utf-8?B?RkZ3L3MzbDc0RExDemRnNlVsWTJwODJoUFVGbzg4Q3NrTnBTYURxT01UYWlj?=
 =?utf-8?B?UHNoVXZFUXFLcU9jODFqWkdLQTJTeWRvN1NkVGdSRDM5MGozanFGNUl6TStQ?=
 =?utf-8?B?OHhUODFKMVdsa1VJZzJMNC9wamdVNlA3Zk10c3dMVW5DN0pBVTlzQk43R3gw?=
 =?utf-8?B?bzR0b09DdU1ldDd2S2p1MW9nSlBCRldQSkcwUEM5OW13Q0cvUXY4YnVxdzhs?=
 =?utf-8?B?WUs2dCs1d2J1YnNZMmNXZjVxZTFaR1lFVTc0Qk0vU0VBNVVMNC9FOWg1cUhm?=
 =?utf-8?B?eVJJejRLTFY4MXlHVVRmSFR5UGJOdEdsYlhjOGNnYTd1R00rZDBHMCtTSFdu?=
 =?utf-8?B?b2RBamRpOWV1ajM4TlIzVGRtWTczMUhHZlBIVy9jbDVaVDEvMWo3dXZhcWx3?=
 =?utf-8?B?ZTg5OXJqSDVVN3RiRm4zSmZyQnhCSkdCWGdEdWMycHZod291QVFqWEx5LzhO?=
 =?utf-8?B?eTdDVnk0cUI5VFFZalBoTktzR3hXV3RPRkFvVjhkSGtueERJOUFLeXppdDlU?=
 =?utf-8?B?ZkFqUWltem52VFM4b25qeURuRnZsSmloa0xuMGdnc21ZTHRhWUQzQ080WmFj?=
 =?utf-8?B?eFVqa1RtcGFoelBJNmFqZHNEdTdrWHRmNzF4MVpySEpjWUJaN3g2U1NXaFFM?=
 =?utf-8?B?QXNSS2c0QS9oK2tmQVhlamlQYTBlNU9yL3dkd3NOdGxuUmFKRG03S1lNS2t3?=
 =?utf-8?B?NUlPdzNsQWlnekJRNjQraVc2M1JuUjZRM1hzRU5SWGRzUmpVQm4xRktGOFM4?=
 =?utf-8?B?eU05NGdsZGV0UU9TZjZmZS9ydWF5Q2ZnQmFnVm5OZ2xVbmFzaEMwQXZGUmtT?=
 =?utf-8?B?T1pib2VWcHh3MWh1VTRwMXo2L3NSbWZ1WlpWSktJcHBVL1htVzR1ZGIzT1BD?=
 =?utf-8?B?R0JiaWpqZkFQMVE1cmdDZHJxbDNSSE0wUk9oVUU1d1hyMi8xNGZVR0xtbjU3?=
 =?utf-8?B?Nm1OT0ZJd0RabjBlUWlJbnNRakNIdndWVkh5emZ6Vk9sdTJaWDRHV1ZUR2tM?=
 =?utf-8?B?V0oyaEUvcVdkUGlmVStIVDZFN1RlZWpDL3cyYU0yb244TVhBKy9pT0pOUTE2?=
 =?utf-8?B?U3Z0QjRqWFBlRzBDS2g1SkFwbWFUckhLb2dkcVB0THRpQVFDS0drSFMvOStw?=
 =?utf-8?B?SmFNemhLdzljK1AzOFkvc3laOGEyL1pOVVg1a1RlL1BvalNFL0VhWDQwcWVC?=
 =?utf-8?B?MXFDSWMzdG1tT1JSd21ScTBhdG1yYnFGdWZNbEJtSDdqalhqYlBQeUdPS24r?=
 =?utf-8?B?Si9LL3hGVncxcHljMXp4RmpwZnl6VWRySEZjOEplTml1S0oreUk2eXUyUllR?=
 =?utf-8?B?MFhnVmJFRU1HVERGZlp5WXhCVzBVSW9mWDg0eVhxQTUyTGJReCtIcjhDNXc2?=
 =?utf-8?B?MUhTc2d4NVA0NVVTak90VnRJYnA5dEk0SEx1ODk2aTNiQzRPczJCVFp1aGd1?=
 =?utf-8?B?YjZoZHRZM3M5TGVOQVJxejhZQTR0bGJIOVdZN0dpaHVFeW5YakdaSXZkV2x3?=
 =?utf-8?B?QnE2T1JXbUxjMm5CWllSK1h6VmdOOTF0T1RrMm1aaDI3Y3A3aTlNS2xzQUs1?=
 =?utf-8?B?cENoZnQzM2Q0QThrRlROQUFZbmJxOG9ZUEpmME9kMGVWejZELzVDTnl5VGM1?=
 =?utf-8?B?RnlEQm14KzJKa0dIQTRwN0hRL0dmR3F0K09md3hLbEJoVnlSZ1NCTmcrMTRh?=
 =?utf-8?B?aElUVC81RUorbVRRT3dERzJ6c2ZGYURCVU5kUUpiQ0xMNDFDMEpHUFMwQlVh?=
 =?utf-8?B?S25ld3ZsM2UrUmtRV0pneDlla0NNQ0dhVENuMm13SUpwWG5keTBjd1lrUXlk?=
 =?utf-8?B?TkY0eGoxTVBvSFhmSHI0SUE1eEFNOTF3bzl6TEszOUNuUm53TE9SM281SGZp?=
 =?utf-8?B?WUpjeU1ZdEt3dVJGZnpjUmpsUnk4cXc3M0UvYldsQ2Exa1l5OFc5eDdZYzdi?=
 =?utf-8?Q?dScwScERM5l2U8dcPiT9rvKl6?=
X-OriginatorOrg: nxp.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 33719af9-7c8f-47f5-12c8-08dddf0589de
X-MS-Exchange-CrossTenant-AuthSource: AM7PR04MB7046.eurprd04.prod.outlook.com
X-MS-Exchange-CrossTenant-AuthAs: Internal
X-MS-Exchange-CrossTenant-OriginalArrivalTime: 19 Aug 2025 09:48:24.0044
 (UTC)
X-MS-Exchange-CrossTenant-FromEntityHeader: Hosted
X-MS-Exchange-CrossTenant-Id: 686ea1d3-bc2b-4c6f-a92c-d99c5c301635
X-MS-Exchange-CrossTenant-MailboxType: HOSTED
X-MS-Exchange-CrossTenant-UserPrincipalName: DBgq77hd5ybYR8UbHbHMDQF1+5h8Brx1tmZETQriI2feH9DY6DZ19aeqeSnjsv8zeZBeuy8SOxb5L6qFyO2img==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: AM9PR04MB8794

Hi Dmitry,

On 08/16/2025, Dmitry Baryshkov wrote:
> Declare which infoframes are supported via the .hdmi_write_infoframe()
> interface.
> 
> Signed-off-by: Dmitry Baryshkov <dmitry.baryshkov@oss.qualcomm.com>
> ---
>  drivers/gpu/drm/bridge/ite-it6263.c | 1 +
>  1 file changed, 1 insertion(+)

For subject, s/it6232/it6263.

> 
> diff --git a/drivers/gpu/drm/bridge/ite-it6263.c b/drivers/gpu/drm/bridge/ite-it6263.c
> index cf813672b4ffb8ab5c524c6414ee7b414cebc018..b1956891a8388401c13cd2fc5c78f0779063adf4 100644
> --- a/drivers/gpu/drm/bridge/ite-it6263.c
> +++ b/drivers/gpu/drm/bridge/ite-it6263.c
> @@ -875,6 +875,7 @@ static int it6263_probe(struct i2c_client *client)
>  	it->bridge.type = DRM_MODE_CONNECTOR_HDMIA;
>  	it->bridge.vendor = "ITE";
>  	it->bridge.product = "IT6263";
> +	it->bridge.supported_infoframes = DRM_CONNECTOR_INFOFRAME_AVI;

With supported_infoframes set, the two lines setting vendor and product
are dead code.  I think it's worth dropping them and updating kerneldoc
for vendor and product members because they don't have to be required if
DRM_BRIDGE_OP_HDMI is set.  But, this could be done with future patch(not
in this patch series).

Reviewed-by: Liu Ying <victor.liu@nxp.com>

>  
>  	return devm_drm_bridge_add(dev, &it->bridge);
>  }
> 


-- 
Regards,
Liu Ying

From mboxrd@z Thu Jan  1 00:00:00 1970
Received: from mx0a-0031df01.pphosted.com (mx0a-0031df01.pphosted.com [205.220.168.131])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by smtp.subspace.kernel.org (Postfix) with ESMTPS id 344732E54A0
	for <linux-sunxi@lists.linux.dev>; Sat, 16 Aug 2025 12:41:17 +0000 (UTC)
Authentication-Results: smtp.subspace.kernel.org; arc=none smtp.client-ip=205.220.168.131
ARC-Seal: i=1; a=rsa-sha256; d=subspace.kernel.org; s=arc-20240116;
	t=1755348079; cv=none; b=aYie/V2DsSCvCbeyjp43YSigzIpeMwrg/6TrjF+YIK9CTxdmV2zwzQIHbHQo9p12HrSpuaPDAUmCeqWWKn8FOkm7VKL0p8ZAp3avgJqQ1mvRETKUyThvKibY03WpQJIoxSCj04J0WiTk3n4w4r/iivpCphYqOCxTzXlIFuRcTGE=
ARC-Message-Signature: i=1; a=rsa-sha256; d=subspace.kernel.org;
	s=arc-20240116; t=1755348079; c=relaxed/simple;
	bh=+Dfr1zh3DlBnrvVAtXMJg6eNn5T47Wh0MW2ToSAF+Qw=;
	h=From:Date:Subject:MIME-Version:Content-Type:Message-Id:References:
	 In-Reply-To:To:Cc; b=m3T0xvDokV+AtsPU+7Rg7EGqWsuJ2fKVfIs5HxLorqSMeWcD5aJtA9cWxgathfOihi62VUF+tWjnFD4NlF1254aTwMKwqceMERjXijytAqg9+FGmnyZgjihE0juabhP5sRqYYGycN60sKlQMIEpT+uLO5hiQZxlt1NuSO3fh2SY=
ARC-Authentication-Results: i=1; smtp.subspace.kernel.org; dmarc=pass (p=reject dis=none) header.from=oss.qualcomm.com; spf=pass smtp.mailfrom=oss.qualcomm.com; dkim=pass (2048-bit key) header.d=qualcomm.com header.i=@qualcomm.com header.b=ghy7ow3I; arc=none smtp.client-ip=205.220.168.131
Authentication-Results: smtp.subspace.kernel.org; dmarc=pass (p=reject dis=none) header.from=oss.qualcomm.com
Authentication-Results: smtp.subspace.kernel.org; spf=pass smtp.mailfrom=oss.qualcomm.com
Authentication-Results: smtp.subspace.kernel.org;
	dkim=pass (2048-bit key) header.d=qualcomm.com header.i=@qualcomm.com header.b="ghy7ow3I"
Received: from pps.filterd (m0279867.ppops.net [127.0.0.1])
	by mx0a-0031df01.pphosted.com (8.18.1.2/8.18.1.2) with ESMTP id 57G3FE0t016439
	for <linux-sunxi@lists.linux.dev>; Sat, 16 Aug 2025 12:41:17 GMT
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=qualcomm.com; h=
	cc:content-transfer-encoding:content-type:date:from:in-reply-to
	:message-id:mime-version:references:subject:to; s=qcppdkim1; bh=
	WheBIbMm8jmW4YxKN53JoUfaF7MiVG3M+ZhDR9++pK4=; b=ghy7ow3IhXPGTqxh
	rU4w33RBBu9X2DhL/a3zk5EKlCbeZqSqXPiDZgI+ZOqS+s/MpP9WCKD7YeKnB+N/
	NbgE/2btK/ESkOEbf+ABvy2OU8zm4qLvgDMwh2Up6tJpZlgZPcpnP1slSbCv4zTF
	IL6OiD80boGZjmdAZ51B+0tpfRVdyJNyvRuFQZHD/2EOyHaWlodp7Z69InLwRg0C
	+I2jjjAoauJeGmyy3hmJI8vJjoqWoCw9RQOxrToalLnQlO3R00jW1Bd4SBd1lY2N
	gxc6uYuBbls3UEoMtXdNXhBIDmfwpHCLedeIVi2hE+nO4WlpVwP+LOkoWoDnnGZE
	MEt89w==
Received: from mail-qv1-f72.google.com (mail-qv1-f72.google.com [209.85.219.72])
	by mx0a-0031df01.pphosted.com (PPS) with ESMTPS id 48jfpf0udm-1
	(version=TLSv1.2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128 verify=NOT)
	for <linux-sunxi@lists.linux.dev>; Sat, 16 Aug 2025 12:41:17 +0000 (GMT)
Received: by mail-qv1-f72.google.com with SMTP id 6a1803df08f44-70a88dd1408so59617356d6.0
        for <linux-sunxi@lists.linux.dev>; Sat, 16 Aug 2025 05:41:17 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20230601; t=1755348076; x=1755952876;
        h=cc:to:in-reply-to:references:message-id:content-transfer-encoding
         :mime-version:subject:date:from:x-gm-message-state:from:to:cc
         :subject:date:message-id:reply-to;
        bh=WheBIbMm8jmW4YxKN53JoUfaF7MiVG3M+ZhDR9++pK4=;
        b=gatabrN7K8QZm+iBWLK5I7ZnEQrRuZDaRVtes+p7WnPHzbzsjwWiIfs/End41/jsF5
         bi9YTGyLnU5q+ymrKfiQlxgkGl0bOqxG3XQHhexVdXTXschglue4dsfJcI6wcrM3LSuO
         IS0j294zut1i+KPOqGsJjwe2b70rwwkArdnMuyf8GWt4HTueEeB+TfcEtmq5WYycZVez
         prb4knsta1cie39cUw6VikKmyHJIFGfqMpe8ozdT0z5e/EgqXv4opy6cGUuLWillD90m
         UqL4SO7nHFSDFVJnuGf5+rZcMMtqR/1tMsorpK4qm8b+6DRZyOmwRDlD5Sx3FfAeUzLt
         tIyw==
X-Forwarded-Encrypted: i=1; AJvYcCVfjAQrodLzKkQfzn4jux9vGdywHn6zsu+UugulT4a+rwbgMSoX5rD/O+HzhKBc+Gry5iig7Eti7UmsqA==@lists.linux.dev
X-Gm-Message-State: AOJu0Yw9oXENnknPeOEeFlwqpXI0GK+SvGG0xhghPD4MZxK+gC1oJwaV
	m2PXvBJQ+QVeUi8WpZ9i81AJkGtU+FQC69Xwdju8RGkl56Ev3RX4Yb3l/M6TBhIZDHpHEcGkUMn
	bJXV/nQ+QunVQHOytVeFUrinbsvu2J/5aWd+Amsl0TCbxf8t893yBfEkzgtMrAt+Hww==
X-Gm-Gg: ASbGncti5nHf3MUZDKOj9uI3Ceq0WXCzWyE4Ga2gK3sYRMDVDWQj6sArYRToiLYWfKY
	l7H4gQYI7Rhr0gPZhLK8jnsGBAEmBIYqD3VVNkmJymQZ9IsqjDKAc3xxkzVduTrBPjZ8yA1NR3D
	DeAg9fXh3hS4rcnLFJUeSvUxm77sQHVHW9tU++2vS980MEd9aNs5yiTHXMHzDsBEO0jlLpdb8uu
	HwTVD4kXD32zA2NZNnIpGpXXpUzI0wWm/gN2gdFjIb+YnyX9VWUf8kc2pOQf68cguAYiW0jbZpP
	52Y3u+FrbdclhKAwdkEfJrWI/bKN/vf3Pt/zDMH3zDxIXUs3aET4ftNP36Qw62VlwiWRx/7/uL1
	TXY864AJuwAKkKKfUsJi5f/FUHANpswLbr7hFI23Gn0i2O45DuFng
X-Received: by 2002:ad4:5fce:0:b0:702:b805:276b with SMTP id 6a1803df08f44-70ba7b0fb72mr68628316d6.20.1755348075999;
        Sat, 16 Aug 2025 05:41:15 -0700 (PDT)
X-Google-Smtp-Source: AGHT+IG3UdiNBmKcbNBSZ74rRqQydXtIbuAXtAkdOOj4dUPQcZFQgwFXOOSXEuXuI37B1EPLUu9GHg==
X-Received: by 2002:ad4:5fce:0:b0:702:b805:276b with SMTP id 6a1803df08f44-70ba7b0fb72mr68627786d6.20.1755348075573;
        Sat, 16 Aug 2025 05:41:15 -0700 (PDT)
Received: from umbar.lan (2001-14ba-a0c3-3a00-264b-feff-fe8b-be8a.rev.dnainternet.fi. [2001:14ba:a0c3:3a00:264b:feff:fe8b:be8a])
        by smtp.gmail.com with ESMTPSA id 2adb3069b0e04-55cef3cca21sm856554e87.104.2025.08.16.05.41.14
        (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
        Sat, 16 Aug 2025 05:41:14 -0700 (PDT)
From: Dmitry Baryshkov <dmitry.baryshkov@oss.qualcomm.com>
Date: Sat, 16 Aug 2025 15:41:05 +0300
Subject: [PATCH 5/7] drm/bridge: synopsys/dw-hdmi-qp: declare supported
 infoframes
Precedence: bulk
X-Mailing-List: linux-sunxi@lists.linux.dev
List-Id: <linux-sunxi.lists.linux.dev>
List-Subscribe: <mailto:linux-sunxi+subscribe@lists.linux.dev>
List-Unsubscribe: <mailto:linux-sunxi+unsubscribe@lists.linux.dev>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: 7bit
Message-Id: <20250816-drm-limit-infoframes-v1-5-6dc17d5f07e9@oss.qualcomm.com>
References: <20250816-drm-limit-infoframes-v1-0-6dc17d5f07e9@oss.qualcomm.com>
In-Reply-To: <20250816-drm-limit-infoframes-v1-0-6dc17d5f07e9@oss.qualcomm.com>
To: Andrzej Hajda <andrzej.hajda@intel.com>,
        Neil Armstrong <neil.armstrong@linaro.org>,
        Robert Foss <rfoss@kernel.org>,
        Laurent Pinchart <Laurent.pinchart@ideasonboard.com>,
        Jonas Karlman <jonas@kwiboo.se>,
        Jernej Skrabec <jernej.skrabec@gmail.com>,
        Maarten Lankhorst <maarten.lankhorst@linux.intel.com>,
        Maxime Ripard <mripard@kernel.org>,
        Thomas Zimmermann <tzimmermann@suse.de>,
        David Airlie <airlied@gmail.com>, Simona Vetter <simona@ffwll.ch>,
        Sandy Huang <hjc@rock-chips.com>,
        =?utf-8?q?Heiko_St=C3=BCbner?= <heiko@sntech.de>,
        Andy Yan <andy.yan@rock-chips.com>, Chen-Yu Tsai <wens@csie.org>,
        Samuel Holland <samuel@sholland.org>,
        Dave Stevenson <dave.stevenson@raspberrypi.com>,
        =?utf-8?q?Ma=C3=ADra_Canal?= <mcanal@igalia.com>,
        Raspberry Pi Kernel Maintenance <kernel-list@raspberrypi.com>,
        Liu Ying <victor.liu@nxp.com>,
        Rob Clark <robin.clark@oss.qualcomm.com>,
        Dmitry Baryshkov <lumag@kernel.org>,
        Abhinav Kumar <abhinav.kumar@linux.dev>,
        Jessica Zhang <jessica.zhang@oss.qualcomm.com>,
        Sean Paul <sean@poorly.run>,
        Marijn Suijten <marijn.suijten@somainline.org>
Cc: dri-devel@lists.freedesktop.org, linux-kernel@vger.kernel.org,
        linux-arm-kernel@lists.infradead.org,
        linux-rockchip@lists.infradead.org, linux-sunxi@lists.linux.dev,
        linux-arm-msm@vger.kernel.org, freedreno@lists.freedesktop.org
X-Mailer: b4 0.14.2
X-Developer-Signature: v=1; a=openpgp-sha256; l=1016;
 i=dmitry.baryshkov@oss.qualcomm.com; h=from:subject:message-id;
 bh=+Dfr1zh3DlBnrvVAtXMJg6eNn5T47Wh0MW2ToSAF+Qw=;
 b=owEBbQGS/pANAwAKAYs8ij4CKSjVAcsmYgBooHxfF817cuWm0x9Ld7mSI9y3aEDv6yVOAaz6B
 PUV1yKfX8eJATMEAAEKAB0WIQRMcISVXLJjVvC4lX+LPIo+Aiko1QUCaKB8XwAKCRCLPIo+Aiko
 1YeJCACinc5gTz7egfGIB6yk437KFDLl0hTcWhDnfZD9zWOokKCZsuwjgqgvP++oHdIB/be2QcT
 Zp52KAZ10Legd6GZihS8hapT4SrGoW7JbJeeaLydKZcWSQiqGGw8cj0ORAXsTvnFGhql41oNCAu
 AyHGwl+aAB38jVvd75yA/n7qZRM6iKDKeQMJbQm8Xo4EEXg0Vu66iCDPWSojU6TBTNeJPB8qk6+
 SUZJhUXTFUN48tRXFM7oHP/Rp/1AvxRedsNDY/trIp57DbbpxwgD7NVyWe+Y1LmlDm91m+TTX0/
 158PCZIFuFMCsoNY810tLXPPkT1IJScS1Xraf8Nuc82coAtx
X-Developer-Key: i=dmitry.baryshkov@oss.qualcomm.com; a=openpgp;
 fpr=8F88381DD5C873E4AE487DA5199BF1243632046A
X-Proofpoint-ORIG-GUID: qgL0q1BLKDdE2GMWTsyAtrllKFVJy1rn
X-Proofpoint-GUID: qgL0q1BLKDdE2GMWTsyAtrllKFVJy1rn
X-Authority-Analysis: v=2.4 cv=X9tSKHTe c=1 sm=1 tr=0 ts=68a07c6d cx=c_pps
 a=7E5Bxpl4vBhpaufnMqZlrw==:117 a=xqWC_Br6kY4A:10 a=IkcTkHD0fZMA:10
 a=2OwXVqhp2XgA:10 a=EUspDBNiAAAA:8 a=oy62-DSxHemnvxnUzX8A:9 a=QEXdDO2ut3YA:10
 a=pJ04lnu7RYOZP9TFuWaZ:22
X-Proofpoint-Spam-Details-Enc: AW1haW4tMjUwODE2MDAwNSBTYWx0ZWRfX2FZY4dHyLWNC
 LKvOqk4YtsDXM6j6ik/litPCZ2Ha4Sn8b9VKPFR2EocGifvsXQeiaq4YJ78IAnQ0sEGX/1TV5M7
 beIgCeDsJ+iRbVSCwgP4Dw73VQsKZ2V3H48j39XMlekF4N8iTdL2Dwl1PNcMvy53uaQiuJPTluS
 8Ac5RZd3lFdRn/iFEX7+U97S5FlgdbXRbpsKKaQVA/LvWnQ0G+Vq9wwpfJUWnx3tB/5CSksGyNz
 9krrK5YdEluqmjXW/54zUr/CiXpHIaKWcQtMWCVT78M+57PrwgNSbUKQbxxl+GyQuMN+YzrnYyc
 4FpSVre01cWi9f//I6K2CfI9uUeTQ0VQtUQ6Hn1AVOrQMk/qitUv57Ls2ZXZLDFKA9umr+dE3Hd
 /cATLZux
X-Proofpoint-Virus-Version: vendor=baseguard
 engine=ICAP:2.0.293,Aquarius:18.0.1099,Hydra:6.1.9,FMLib:17.12.80.40
 definitions=2025-08-16_04,2025-08-14_01,2025-03-28_01
X-Proofpoint-Spam-Details: rule=outbound_notspam policy=outbound score=0
 priorityscore=1501 malwarescore=0 bulkscore=0 phishscore=0 spamscore=0
 suspectscore=0 adultscore=0 clxscore=1015 impostorscore=0
 classifier=typeunknown authscore=0 authtc= authcc= route=outbound adjust=0
 reason=mlx scancount=1 engine=8.19.0-2507300000 definitions=main-2508160005

Declare which infoframes are supported via the .hdmi_write_infoframe()
interface.

Signed-off-by: Dmitry Baryshkov <dmitry.baryshkov@oss.qualcomm.com>
---
 drivers/gpu/drm/bridge/synopsys/dw-hdmi-qp.c | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/drivers/gpu/drm/bridge/synopsys/dw-hdmi-qp.c b/drivers/gpu/drm/bridge/synopsys/dw-hdmi-qp.c
index 39332c57f2c54296f39e27612544f4fbf923863f..b982c2504a3112a77fbc8df9a39236cb8e625ea4 100644
--- a/drivers/gpu/drm/bridge/synopsys/dw-hdmi-qp.c
+++ b/drivers/gpu/drm/bridge/synopsys/dw-hdmi-qp.c
@@ -1084,6 +1084,9 @@ struct dw_hdmi_qp *dw_hdmi_qp_bind(struct platform_device *pdev,
 	hdmi->bridge.type = DRM_MODE_CONNECTOR_HDMIA;
 	hdmi->bridge.vendor = "Synopsys";
 	hdmi->bridge.product = "DW HDMI QP TX";
+	hdmi->bridge.supported_infoframes = DRM_CONNECTOR_INFOFRAME_AUDIO |
+		DRM_CONNECTOR_INFOFRAME_AVI |
+		DRM_CONNECTOR_INFOFRAME_DRM,
 
 	hdmi->bridge.ddc = dw_hdmi_qp_i2c_adapter(hdmi);
 	if (IS_ERR(hdmi->bridge.ddc))

-- 
2.47.2


From mboxrd@z Thu Jan  1 00:00:00 1970
Received: from mx0a-0031df01.pphosted.com (mx0a-0031df01.pphosted.com [205.220.168.131])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by smtp.subspace.kernel.org (Postfix) with ESMTPS id 2D8232E7F37
	for <linux-sunxi@lists.linux.dev>; Sat, 16 Aug 2025 12:41:21 +0000 (UTC)
Authentication-Results: smtp.subspace.kernel.org; arc=none smtp.client-ip=205.220.168.131
ARC-Seal: i=1; a=rsa-sha256; d=subspace.kernel.org; s=arc-20240116;
	t=1755348083; cv=none; b=tOTqvuOwfsTm4hxnHC4hCML26iJfx77ZJA08mRT988RltDEo+8tCl8L+0Nx2vKUgivvS92c3KbZZL2O2LOQtDeSg/N1904pTFiJWQr3MagqZ523G2kdXDvNwO834aZXYGI5HWOfF6elGtVoqQ0a8yRarreOvzJGDTbK7WXsPrQA=
ARC-Message-Signature: i=1; a=rsa-sha256; d=subspace.kernel.org;
	s=arc-20240116; t=1755348083; c=relaxed/simple;
	bh=7eaknZdIIVgkzyGpeqyWY92kXnNZwGkNmo13tFbwgVk=;
	h=From:Date:Subject:MIME-Version:Content-Type:Message-Id:References:
	 In-Reply-To:To:Cc; b=lwWlwQXFBVXlFty+JRJ+mVABHlSRZvDNntQ4WSEl7L0fYduSr0Rg41IrhBlm4JZc5VtLkIg6rYhFvgd61LdrekR5GcpLm3K25LQmAwNqEM22DhBfaurMn/k4naQGWmNnggzurYFTudGtXYobW1/L/bQfmLeVVYwLDVx0yWdtPhA=
ARC-Authentication-Results: i=1; smtp.subspace.kernel.org; dmarc=pass (p=reject dis=none) header.from=oss.qualcomm.com; spf=pass smtp.mailfrom=oss.qualcomm.com; dkim=pass (2048-bit key) header.d=qualcomm.com header.i=@qualcomm.com header.b=pgn1liOc; arc=none smtp.client-ip=205.220.168.131
Authentication-Results: smtp.subspace.kernel.org; dmarc=pass (p=reject dis=none) header.from=oss.qualcomm.com
Authentication-Results: smtp.subspace.kernel.org; spf=pass smtp.mailfrom=oss.qualcomm.com
Authentication-Results: smtp.subspace.kernel.org;
	dkim=pass (2048-bit key) header.d=qualcomm.com header.i=@qualcomm.com header.b="pgn1liOc"
Received: from pps.filterd (m0279863.ppops.net [127.0.0.1])
	by mx0a-0031df01.pphosted.com (8.18.1.2/8.18.1.2) with ESMTP id 57GBRCDZ001797
	for <linux-sunxi@lists.linux.dev>; Sat, 16 Aug 2025 12:41:20 GMT
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=qualcomm.com; h=
	cc:content-transfer-encoding:content-type:date:from:in-reply-to
	:message-id:mime-version:references:subject:to; s=qcppdkim1; bh=
	g+KCHHTqRR+QvQr7TO6S5/RPZnrNqLEy6fhDbfe+NhQ=; b=pgn1liOc6Kjt3D+7
	tK3LPtR0cFhpN/7UXzrPO256Xo+Iq6k0LLE03rje0GKKYeZBZKTxh2VG8xNXmaTy
	Sn6XScwZs6acyk1pWW/4zVXFg7zdAtJ5dEU37hrpZzIafYiunQNvSjgXkrkVR0JO
	eZwv7UYpWnkTTjrduGBf/1Ojg88LzHiOMisKsjjgNZDDoFulaDUm7BdzaQYF+EU5
	CT5DOv56rPRULdo8RuNx4I+p7pXc3RGffS8h0vgC+Hzh0JrcStyjuaY6kR7JubDY
	ExBTRhgfDiseTsXlx8X8n11pc5+A8GTh0u01mvJr9/k6xSwdd4jjxruWWUk4gGWX
	2tbqeA==
Received: from mail-qv1-f69.google.com (mail-qv1-f69.google.com [209.85.219.69])
	by mx0a-0031df01.pphosted.com (PPS) with ESMTPS id 48jj740mar-1
	(version=TLSv1.2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128 verify=NOT)
	for <linux-sunxi@lists.linux.dev>; Sat, 16 Aug 2025 12:41:20 +0000 (GMT)
Received: by mail-qv1-f69.google.com with SMTP id 6a1803df08f44-70a92827a70so60796696d6.1
        for <linux-sunxi@lists.linux.dev>; Sat, 16 Aug 2025 05:41:20 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20230601; t=1755348079; x=1755952879;
        h=cc:to:in-reply-to:references:message-id:content-transfer-encoding
         :mime-version:subject:date:from:x-gm-message-state:from:to:cc
         :subject:date:message-id:reply-to;
        bh=g+KCHHTqRR+QvQr7TO6S5/RPZnrNqLEy6fhDbfe+NhQ=;
        b=sHb62A18qxaopuuWG7GkbdO5/FJELtXBw2Mt9fovdAFeE59rILBaviO/4QWuvYBCUI
         8PcPHjNlofouZkmEDq6judLmmH6BFrJg/J+FKfAvTQ1jXFT4F3oeNQjDcToKqKd0uMjG
         MgPRqbYAxaf5CerCkKYCGE9maBIDIIXFzaWo48pCTRfI6qYi67B8pGkK8EH4o36JxCTs
         FC9nHEV6aVRUBBxmdV7JLP3/7HjEGHHkyDxalmP5gHUuU8+TBru9J1+LZeUl6ku6x2+l
         1hTcSkQBsSwfX37BhIkaIjxOSKWi7ZieC5y0ZvYyr3SezgnNrPPResP1h9TV2N5YCBV9
         kSag==
X-Forwarded-Encrypted: i=1; AJvYcCU3XHGNIwFdNl8z51eXtvOXnTbGNCfuuKqsaerWScqHY9qvdLhvFImkOmrPxdOzLWSRc3seAIXKrU/j6Q==@lists.linux.dev
X-Gm-Message-State: AOJu0YySlN4h7VoB7GLQb70kYKym1HIifyOcS6c4xLV6z2iU5H2NQr18
	W7wZ5OrBF1UeXspuX+fCmFjVuKrJVr36GFrN5nT4Dhvcuu4HSvQ7WorQRcgoXQJyeU/dJZJO0QO
	t6EnrpOKthgw6Er6+W1Kokj/em5ZjulLyL1Oe8BQj/zeS3b9ew4m2KoSwgt6QzPiRCg==
X-Gm-Gg: ASbGncvObMJTbN3SddJRMlALSBouSWYWHjhZbBkZU67WJQ+QXHWDrca6763u/B7WfdP
	5T1khB6Smz3a7a56+QtgaO0La6z6af1tLto35SOyp57WggW+du7tlUxJCyq9h/SsWM6f/+RpW0U
	8xCA9UHmryrE5diShQ6f5wkjse8uvDFvGY/5hc2ZjPfw2IExRo47j8VMQDfTjieedP4XCKWcpqH
	JpiarYqtf2UHhinrky4AF608qszNc/mhFcDOlK4hluNl3OmpxV26EGk/PZF3mXfNuRxXDT/c3Sc
	1blmzkfxQZTnSXVuU/7qDvxz6AFaJCARkHlNJpLKfCyuvMGy5/BQGNGw2qL7fTcUrVfVyutWBMk
	rYYgwjUe4PohqfEuo73D0kS4KSXSu2TDp0JbXxC39N9gP10m4Grv4
X-Received: by 2002:a05:6214:1d22:b0:709:3d8d:5c2c with SMTP id 6a1803df08f44-70bb0618468mr24915106d6.32.1755348079218;
        Sat, 16 Aug 2025 05:41:19 -0700 (PDT)
X-Google-Smtp-Source: AGHT+IEOQL6onlKjHcTQTSZYwcPj2qboHayn8rKRBdtJHr/kNyKMVVa+u6QH81eKHnsSjAYM+ZfZeA==
X-Received: by 2002:a05:6214:1d22:b0:709:3d8d:5c2c with SMTP id 6a1803df08f44-70bb0618468mr24914666d6.32.1755348078746;
        Sat, 16 Aug 2025 05:41:18 -0700 (PDT)
Received: from umbar.lan (2001-14ba-a0c3-3a00-264b-feff-fe8b-be8a.rev.dnainternet.fi. [2001:14ba:a0c3:3a00:264b:feff:fe8b:be8a])
        by smtp.gmail.com with ESMTPSA id 2adb3069b0e04-55cef3cca21sm856554e87.104.2025.08.16.05.41.17
        (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
        Sat, 16 Aug 2025 05:41:17 -0700 (PDT)
From: Dmitry Baryshkov <dmitry.baryshkov@oss.qualcomm.com>
Date: Sat, 16 Aug 2025 15:41:07 +0300
Subject: [PATCH 7/7] drm/rockchip: rk3066: declare supported infoframes
Precedence: bulk
X-Mailing-List: linux-sunxi@lists.linux.dev
List-Id: <linux-sunxi.lists.linux.dev>
List-Subscribe: <mailto:linux-sunxi+subscribe@lists.linux.dev>
List-Unsubscribe: <mailto:linux-sunxi+unsubscribe@lists.linux.dev>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: 7bit
Message-Id: <20250816-drm-limit-infoframes-v1-7-6dc17d5f07e9@oss.qualcomm.com>
References: <20250816-drm-limit-infoframes-v1-0-6dc17d5f07e9@oss.qualcomm.com>
In-Reply-To: <20250816-drm-limit-infoframes-v1-0-6dc17d5f07e9@oss.qualcomm.com>
To: Andrzej Hajda <andrzej.hajda@intel.com>,
        Neil Armstrong <neil.armstrong@linaro.org>,
        Robert Foss <rfoss@kernel.org>,
        Laurent Pinchart <Laurent.pinchart@ideasonboard.com>,
        Jonas Karlman <jonas@kwiboo.se>,
        Jernej Skrabec <jernej.skrabec@gmail.com>,
        Maarten Lankhorst <maarten.lankhorst@linux.intel.com>,
        Maxime Ripard <mripard@kernel.org>,
        Thomas Zimmermann <tzimmermann@suse.de>,
        David Airlie <airlied@gmail.com>, Simona Vetter <simona@ffwll.ch>,
        Sandy Huang <hjc@rock-chips.com>,
        =?utf-8?q?Heiko_St=C3=BCbner?= <heiko@sntech.de>,
        Andy Yan <andy.yan@rock-chips.com>, Chen-Yu Tsai <wens@csie.org>,
        Samuel Holland <samuel@sholland.org>,
        Dave Stevenson <dave.stevenson@raspberrypi.com>,
        =?utf-8?q?Ma=C3=ADra_Canal?= <mcanal@igalia.com>,
        Raspberry Pi Kernel Maintenance <kernel-list@raspberrypi.com>,
        Liu Ying <victor.liu@nxp.com>,
        Rob Clark <robin.clark@oss.qualcomm.com>,
        Dmitry Baryshkov <lumag@kernel.org>,
        Abhinav Kumar <abhinav.kumar@linux.dev>,
        Jessica Zhang <jessica.zhang@oss.qualcomm.com>,
        Sean Paul <sean@poorly.run>,
        Marijn Suijten <marijn.suijten@somainline.org>
Cc: dri-devel@lists.freedesktop.org, linux-kernel@vger.kernel.org,
        linux-arm-kernel@lists.infradead.org,
        linux-rockchip@lists.infradead.org, linux-sunxi@lists.linux.dev,
        linux-arm-msm@vger.kernel.org, freedreno@lists.freedesktop.org
X-Mailer: b4 0.14.2
X-Developer-Signature: v=1; a=openpgp-sha256; l=916;
 i=dmitry.baryshkov@oss.qualcomm.com; h=from:subject:message-id;
 bh=7eaknZdIIVgkzyGpeqyWY92kXnNZwGkNmo13tFbwgVk=;
 b=owEBbQGS/pANAwAKAYs8ij4CKSjVAcsmYgBooHxgMHi4qTkGU45yB+UntdRBVmKZr+x/UsM25
 LEGEgGfYbmJATMEAAEKAB0WIQRMcISVXLJjVvC4lX+LPIo+Aiko1QUCaKB8YAAKCRCLPIo+Aiko
 1djgB/4wOmA1OtnxVdCPZ8Z4di39PIjrPkMG0uQmJI/t0Zc1l8LN6lav06X+zI2KDVDqJtxF2NO
 g8QqOU8UNZeo/kURELWxqyJZzOrWgG4qXXEA/4nBe57GtgK/uBOASm5cvxECJmXXrAsl4xFlcdr
 84IRMNS5lpy+y6HeswpNMDsppcEqals/0nvB0xhbIFKM0VHF2eqBD3sWZiaR0h84BPiU6vcvvbD
 lBsE0lzCSfEp0EC2XQvwDi2OJBLUdr6oBSvcad90o7e6CMWks5r49JFQ3pSoeHlLXx9875g9neu
 Me/+6Idd77ROmdlT+vKnBkOG3AAYvWoynfGMjwl6WnS6TzXc
X-Developer-Key: i=dmitry.baryshkov@oss.qualcomm.com; a=openpgp;
 fpr=8F88381DD5C873E4AE487DA5199BF1243632046A
X-Proofpoint-GUID: amTkAXr_NQjKzXNWJ7BhZSFOk9GDlcvS
X-Proofpoint-ORIG-GUID: amTkAXr_NQjKzXNWJ7BhZSFOk9GDlcvS
X-Proofpoint-Spam-Details-Enc: AW1haW4tMjUwODE2MDAzMyBTYWx0ZWRfX/Uh6kxz761sm
 0FfylMyEebyeuMFdZ79ngqxvcaYnfnnNqVZLeNJ6ysUfdliAnIpPX7WVNE7Nm94OAz39kWHCt/Z
 DVde+iM8kPsxQM1j84r3/qFCOux2i9nnjzitV0YmwD8wshzktnTf9ZinklJIB56H5vWJvZIBikF
 5z0T4c5yo4nJzFCjhdK4Pd9mmccusrm5TfezfvMLptUDPJN2FFwE0NvAdsIoB0Fpeb9gZNga/A6
 5ItCWTNuQf9Un15igxWtutG5IoIfh+0/OuMXoKkh4EbfeHUl5pVHBsFK88Ie56r+b4c16nNjuIG
 FJjvMS6Qf5LswY+NsgizL1R1xtxhScBttMr5h7O8vopRQTsZ5mW59qiY0KolVd0W1kzLluXG5Yg
 ma+wFgCW
X-Authority-Analysis: v=2.4 cv=MJtgmNZl c=1 sm=1 tr=0 ts=68a07c70 cx=c_pps
 a=wEM5vcRIz55oU/E2lInRtA==:117 a=xqWC_Br6kY4A:10 a=IkcTkHD0fZMA:10
 a=2OwXVqhp2XgA:10 a=EUspDBNiAAAA:8 a=iNCKscWTIkh_2y45CzQA:9 a=QEXdDO2ut3YA:10
 a=OIgjcC2v60KrkQgK7BGD:22
X-Proofpoint-Virus-Version: vendor=baseguard
 engine=ICAP:2.0.293,Aquarius:18.0.1099,Hydra:6.1.9,FMLib:17.12.80.40
 definitions=2025-08-16_04,2025-08-14_01,2025-03-28_01
X-Proofpoint-Spam-Details: rule=outbound_notspam policy=outbound score=0
 malwarescore=0 spamscore=0 bulkscore=0 adultscore=0 suspectscore=0
 phishscore=0 clxscore=1015 impostorscore=0 priorityscore=1501
 classifier=typeunknown authscore=0 authtc= authcc= route=outbound adjust=0
 reason=mlx scancount=1 engine=8.19.0-2507300000 definitions=main-2508160033

Declare which infoframes are supported via the .hdmi_write_infoframe()
interface.

Signed-off-by: Dmitry Baryshkov <dmitry.baryshkov@oss.qualcomm.com>
---
 drivers/gpu/drm/rockchip/rk3066_hdmi.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/drivers/gpu/drm/rockchip/rk3066_hdmi.c b/drivers/gpu/drm/rockchip/rk3066_hdmi.c
index ae4a5ac2299a93a49f87df7604752f6b651c839c..75bf9a13d8cde1471e8b7e8a8f5f4c0457dd0a14 100644
--- a/drivers/gpu/drm/rockchip/rk3066_hdmi.c
+++ b/drivers/gpu/drm/rockchip/rk3066_hdmi.c
@@ -696,6 +696,7 @@ rk3066_hdmi_register(struct drm_device *drm, struct rk3066_hdmi *hdmi)
 	hdmi->bridge.type = DRM_MODE_CONNECTOR_HDMIA;
 	hdmi->bridge.vendor = "Rockchip";
 	hdmi->bridge.product = "RK3066 HDMI";
+	hdmi->bridge.supported_infoframes = DRM_CONNECTOR_INFOFRAME_AVI;
 
 	hdmi->bridge.ddc = rk3066_hdmi_i2c_adapter(hdmi);
 	if (IS_ERR(hdmi->bridge.ddc))

-- 
2.47.2


From mboxrd@z Thu Jan  1 00:00:00 1970
Received: from mx0a-0031df01.pphosted.com (mx0a-0031df01.pphosted.com [205.220.168.131])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by smtp.subspace.kernel.org (Postfix) with ESMTPS id 6E73B2D3725
	for <linux-sunxi@lists.linux.dev>; Sat, 16 Aug 2025 12:41:14 +0000 (UTC)
Authentication-Results: smtp.subspace.kernel.org; arc=none smtp.client-ip=205.220.168.131
ARC-Seal: i=1; a=rsa-sha256; d=subspace.kernel.org; s=arc-20240116;
	t=1755348075; cv=none; b=TAS0rfobN42vRnFtAwDFolrumI4lc9FooTvc2QZVH0P4xAzIehRKaux5B9ur2pLR0r3SziDGaedBHeNdYWhT1UqfKSxvomgMihsvxUWzEl+KG9dagsTpqeV03X78ZK/Kyxip0wqETnFIhAH2mJbeMcS/KWHCD+ACxDOXsjqJdXI=
ARC-Message-Signature: i=1; a=rsa-sha256; d=subspace.kernel.org;
	s=arc-20240116; t=1755348075; c=relaxed/simple;
	bh=rdcPrfCA8M3yJ02gdAYNdSPeQnvEBJT/WVjtw9rGblA=;
	h=From:Subject:Date:Message-Id:MIME-Version:Content-Type:To:Cc; b=OJbxHWezATqMKWT+ink+xIwr7Jjj8mzQYnXtlrLouhc/sQ7jOw5JN7VJgeTRBo4Q/YZEKiWYaCCpGGcpPxiuHv/SSxl3UxxEIQQOuOQnqMtkQR7KlwBSrFjVmU0d9Xylu/XJq507qOaSrOe8RVj3bmtkh9H4CmK8ZNdh6zf0l3w=
ARC-Authentication-Results: i=1; smtp.subspace.kernel.org; dmarc=pass (p=reject dis=none) header.from=oss.qualcomm.com; spf=pass smtp.mailfrom=oss.qualcomm.com; dkim=pass (2048-bit key) header.d=qualcomm.com header.i=@qualcomm.com header.b=TYAQaqdL; arc=none smtp.client-ip=205.220.168.131
Authentication-Results: smtp.subspace.kernel.org; dmarc=pass (p=reject dis=none) header.from=oss.qualcomm.com
Authentication-Results: smtp.subspace.kernel.org; spf=pass smtp.mailfrom=oss.qualcomm.com
Authentication-Results: smtp.subspace.kernel.org;
	dkim=pass (2048-bit key) header.d=qualcomm.com header.i=@qualcomm.com header.b="TYAQaqdL"
Received: from pps.filterd (m0279864.ppops.net [127.0.0.1])
	by mx0a-0031df01.pphosted.com (8.18.1.2/8.18.1.2) with ESMTP id 57G4e26O030638
	for <linux-sunxi@lists.linux.dev>; Sat, 16 Aug 2025 12:41:07 GMT
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=qualcomm.com; h=
	cc:content-transfer-encoding:content-type:date:from:message-id
	:mime-version:subject:to; s=qcppdkim1; bh=DJa7R2QHaJhhfx1abJv+FW
	4NHkh9fI+yxSQ5uteT5y0=; b=TYAQaqdLTrxEbLSRC85k4O+GgU0kii/k12kbpM
	j9Ad4msHSHl1HaZrZUmg4NdOwSx01AkfeA1ZEKnIgDJ1vLFiLAJoXdxSvJRFo2D1
	38C6IFsp72fjP8eGc0cBLoobWIXnCh+wZtNWCE+bQis+zrPco24nE9vO9faV6piP
	p+eNVcxzYTaEYUri7fu81LmZSbD/aLS1X1NtPAo9Q8bLG1COM9iGF069/5or2gEJ
	C6q8XG7Szu6XKREScdJ9MFSyb6cRyjKrvpMb2CDJVy0GFarIOk3U52SwuzVVH4Hy
	VysuPJ+0cri59lAwWdogBmH5S2gRO2KOPyPXY4fmdE5psMLg==
Received: from mail-qt1-f198.google.com (mail-qt1-f198.google.com [209.85.160.198])
	by mx0a-0031df01.pphosted.com (PPS) with ESMTPS id 48jk5m8hvm-1
	(version=TLSv1.2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128 verify=NOT)
	for <linux-sunxi@lists.linux.dev>; Sat, 16 Aug 2025 12:41:07 +0000 (GMT)
Received: by mail-qt1-f198.google.com with SMTP id d75a77b69052e-4b109bc103bso74046821cf.2
        for <linux-sunxi@lists.linux.dev>; Sat, 16 Aug 2025 05:41:07 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20230601; t=1755348066; x=1755952866;
        h=cc:to:content-transfer-encoding:mime-version:message-id:date
         :subject:from:x-gm-message-state:from:to:cc:subject:date:message-id
         :reply-to;
        bh=DJa7R2QHaJhhfx1abJv+FW4NHkh9fI+yxSQ5uteT5y0=;
        b=lH8Y+I8xWs487AIBEJQL9nlIEgZsn4zu2Ba/xQ3K78g/9o5w040Ju0laGxiMRfykm4
         uxrdgoqcbJ4ZaiQ21034vE3V0wN8P7FCbt9LYCzzWleDwMa79I/hBnx4tPLDb5jNGAvc
         GEJJKMJdq46HHBFhVT6P6kdPLm4b0lC4mKNs/M46gRdwv36ifDjwOLQ442RKLQ/S/0m6
         51MX7oV1qRsM8l5ZPunVM4avUOqCVbYl+5eUAz9rWLMwRnxuzPo5aaApCznrXJafnYGp
         pO6v9Lc2uTyn1vLNm2xI84YXPe1XUNTCUQXOZn1HFnKW/5GmoSGrdVxCNqd6ZaZFEDUQ
         3SYQ==
X-Forwarded-Encrypted: i=1; AJvYcCVqa0007+Vq3e3THSOvP/uxZG2JswAxXs1zotO0BBw2mQzRbT9swsDJ6XCAPH7N5fdSbAs7SHF7I6WOsQ==@lists.linux.dev
X-Gm-Message-State: AOJu0YyXZvGC6q173lTmwiBw9rI26Um/BKh3YOphDjrflOOwrpTA3uQ/
	OuJhOE/UCXvuWVwRHlMkAzR0u/Bbid6PruihYVaifHRlzFJ3jbbFy4j0Ef1IHX0gLJO4uVqV4Hb
	x3SjbnOMp2nLzOBytTmzTw/6sE9+XgBycXR2F3RQT2pRZzLvBAMVtAOgdTvwPEKVQCg==
X-Gm-Gg: ASbGncukf+hKzM7b58ELI1w5hFW4uEYC5jOepfv8+rKQdgAu2xNMb3rVpzayox8BvYx
	oGVjpLbieAp5rhlOAggjt0V3bFvVE3PO9W2KR20d0G/OYrl9Yvt6ndgQwRD+Lwq1XO/+FgpNXto
	hruehZOnZfwpX4/SjSk63OhSyftcF8GPZpfNo5GKTUEnOWMvQtoswQst1DuYClq7zxq3aVYunTf
	I/wlC1DeirEXUa9aiiR1+PuG5uKGceT48b1w7kVa2H8ua7EOaskfU3YBB24RGyOM8XXVBUlTIBi
	Iop5JQ+gy+7bC9uDDrqRR/XoUN07FgHDCyrRjTFKdKDoblyg2gAnI91LS/iZyxzI1Sa5GpEZr8x
	KEFIIS11zG2+pTW22ts1g5kLfWww96cxnq6/kZCACJN1WXIt7HIR1
X-Received: by 2002:a05:622a:1445:b0:4a7:18aa:121b with SMTP id d75a77b69052e-4b11e11fadcmr70445001cf.20.1755348066165;
        Sat, 16 Aug 2025 05:41:06 -0700 (PDT)
X-Google-Smtp-Source: AGHT+IEDu/rhFRVUxM6MMA7J2l6dXYr4ZCedu/K1PSwVZjoSHNuoLvoUjgkhh/mHkUAxjnQKCA+q9A==
X-Received: by 2002:a05:622a:1445:b0:4a7:18aa:121b with SMTP id d75a77b69052e-4b11e11fadcmr70444611cf.20.1755348065731;
        Sat, 16 Aug 2025 05:41:05 -0700 (PDT)
Received: from umbar.lan (2001-14ba-a0c3-3a00-264b-feff-fe8b-be8a.rev.dnainternet.fi. [2001:14ba:a0c3:3a00:264b:feff:fe8b:be8a])
        by smtp.gmail.com with ESMTPSA id 2adb3069b0e04-55cef3cca21sm856554e87.104.2025.08.16.05.41.04
        (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
        Sat, 16 Aug 2025 05:41:04 -0700 (PDT)
From: Dmitry Baryshkov <dmitry.baryshkov@oss.qualcomm.com>
Subject: [PATCH 0/7] drm/connector: hdmi: limit infoframes per driver
 capabilities
Date: Sat, 16 Aug 2025 15:41:00 +0300
Message-Id: <20250816-drm-limit-infoframes-v1-0-6dc17d5f07e9@oss.qualcomm.com>
Precedence: bulk
X-Mailing-List: linux-sunxi@lists.linux.dev
List-Id: <linux-sunxi.lists.linux.dev>
List-Subscribe: <mailto:linux-sunxi+subscribe@lists.linux.dev>
List-Unsubscribe: <mailto:linux-sunxi+unsubscribe@lists.linux.dev>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: 7bit
X-B4-Tracking: v=1; b=H4sIAF18oGgC/x3MSwqAMAwA0atI1gZqix+8irgommjAVklFBPHuF
 pdvMfNAIhVK0BcPKF2SZI8ZVVnAtPq4EMqcDdbY2nRVjbMG3CTIiRJ5Z/WBElLbWfYtO9cYyOm
 hxHL/22F83w++h3ZyZgAAAA==
X-Change-ID: 20250815-drm-limit-infoframes-e782fa7f3360
To: Andrzej Hajda <andrzej.hajda@intel.com>,
        Neil Armstrong <neil.armstrong@linaro.org>,
        Robert Foss <rfoss@kernel.org>,
        Laurent Pinchart <Laurent.pinchart@ideasonboard.com>,
        Jonas Karlman <jonas@kwiboo.se>,
        Jernej Skrabec <jernej.skrabec@gmail.com>,
        Maarten Lankhorst <maarten.lankhorst@linux.intel.com>,
        Maxime Ripard <mripard@kernel.org>,
        Thomas Zimmermann <tzimmermann@suse.de>,
        David Airlie <airlied@gmail.com>, Simona Vetter <simona@ffwll.ch>,
        Sandy Huang <hjc@rock-chips.com>,
        =?utf-8?q?Heiko_St=C3=BCbner?= <heiko@sntech.de>,
        Andy Yan <andy.yan@rock-chips.com>, Chen-Yu Tsai <wens@csie.org>,
        Samuel Holland <samuel@sholland.org>,
        Dave Stevenson <dave.stevenson@raspberrypi.com>,
        =?utf-8?q?Ma=C3=ADra_Canal?= <mcanal@igalia.com>,
        Raspberry Pi Kernel Maintenance <kernel-list@raspberrypi.com>,
        Liu Ying <victor.liu@nxp.com>,
        Rob Clark <robin.clark@oss.qualcomm.com>,
        Dmitry Baryshkov <lumag@kernel.org>,
        Abhinav Kumar <abhinav.kumar@linux.dev>,
        Jessica Zhang <jessica.zhang@oss.qualcomm.com>,
        Sean Paul <sean@poorly.run>,
        Marijn Suijten <marijn.suijten@somainline.org>
Cc: dri-devel@lists.freedesktop.org, linux-kernel@vger.kernel.org,
        linux-arm-kernel@lists.infradead.org,
        linux-rockchip@lists.infradead.org, linux-sunxi@lists.linux.dev,
        linux-arm-msm@vger.kernel.org, freedreno@lists.freedesktop.org
X-Mailer: b4 0.14.2
X-Developer-Signature: v=1; a=openpgp-sha256; l=2224;
 i=dmitry.baryshkov@oss.qualcomm.com; h=from:subject:message-id;
 bh=rdcPrfCA8M3yJ02gdAYNdSPeQnvEBJT/WVjtw9rGblA=;
 b=owEBbQGS/pANAwAKAYs8ij4CKSjVAcsmYgBooHxel4gzygfQobSNeCeCVgeypJ9lKzy5dsSVX
 uc9QkQAbKiJATMEAAEKAB0WIQRMcISVXLJjVvC4lX+LPIo+Aiko1QUCaKB8XgAKCRCLPIo+Aiko
 1YxCCACOim4bCjHIWqX1M1bZiVMLzRI3Y8QTdbuiNgrmLKiOaXRYiFmSpaZRI5eGf0CarO1iNUi
 IQjq0N0dSpJFtGKIfadH9PJ8064ZG7NIpU68xmKG1OFzxevGRyfeNJZ7i4GhEi/tV6G96JOSs8H
 iwPRsqFRQrzhwp8qORn+7d2WO/i9IRJf/2vrpu6496ztu9HTv0ZNQjECzwcE8yDWeZttI0+4gR5
 LzTcTBEjoqQ/4IYz9y6hTrl+OeWEdnWvuOJ3FPXWNrBp/wJ3O5D8k/YbUSYRsDcSwrd/5CllFgA
 XVjiF+Q3Rz/QlzANj6UXQ7V7QH3pQwvw9ipP0T0b3jfjVNWw
X-Developer-Key: i=dmitry.baryshkov@oss.qualcomm.com; a=openpgp;
 fpr=8F88381DD5C873E4AE487DA5199BF1243632046A
X-Authority-Analysis: v=2.4 cv=Sdn3duRu c=1 sm=1 tr=0 ts=68a07c63 cx=c_pps
 a=mPf7EqFMSY9/WdsSgAYMbA==:117 a=xqWC_Br6kY4A:10 a=IkcTkHD0fZMA:10
 a=2OwXVqhp2XgA:10 a=EUspDBNiAAAA:8 a=lTUuHy-DAZNZ5WD40gMA:9 a=QEXdDO2ut3YA:10
 a=dawVfQjAaf238kedN5IG:22
X-Proofpoint-ORIG-GUID: KS6B3sOl4m2RyupSC01BSQG3S-ydAPCj
X-Proofpoint-GUID: KS6B3sOl4m2RyupSC01BSQG3S-ydAPCj
X-Proofpoint-Spam-Details-Enc: AW1haW4tMjUwODE2MDA0MiBTYWx0ZWRfX+ckxpE0/9FcA
 yoXdGJo2/jz57rAr2HLq0F9MVKm3La/NO1svpsefsSmybaS2ri0VRb87JR5osAJCxrMSq+y12bw
 cugJxz6i6nyDBY3dzw1bGAKN3UW3IvaOJBKy/r+ewiR6faNTl5qGZzI3arYuycBJstm2iBT0PFh
 MM4vife7WP8MwLVg2LgHFdshTZoLrAOEu1uQa1A5immIak8ycS7HWEkzYpB9E1ZurH3F14m4Iht
 bLcFNuIt9/Zw1swLzmw8Fi9HoFbninHemeTC8KmW2SjRcN0LK9Nwo5aEvmKyw3VLFPLoiOR0h5p
 mLnNbi4XoHxEklbZNYiifKI1uww2qnTDLPPVFi9N5LeK6g7uu2kXLspCFRAwnGOqYSm+cv83Tg+
 OiLY7R21
X-Proofpoint-Virus-Version: vendor=baseguard
 engine=ICAP:2.0.293,Aquarius:18.0.1099,Hydra:6.1.9,FMLib:17.12.80.40
 definitions=2025-08-16_04,2025-08-14_01,2025-03-28_01
X-Proofpoint-Spam-Details: rule=outbound_notspam policy=outbound score=0
 impostorscore=0 clxscore=1015 suspectscore=0 priorityscore=1501 spamscore=0
 adultscore=0 malwarescore=0 bulkscore=0 phishscore=0 classifier=typeunknown
 authscore=0 authtc= authcc= route=outbound adjust=0 reason=mlx scancount=1
 engine=8.19.0-2507300000 definitions=main-2508160042

It's not uncommon for the particular device to support only a subset of
HDMI InfoFrames. It's not a big problem for the kernel, since we adopted
a model of ignoring the unsupported Infoframes, but it's a bigger
problem for the userspace: we end up having files in debugfs which do
mot match what is being sent on the wire.

Sort that out, making sure that all interfaces are consistent.

Signed-off-by: Dmitry Baryshkov <dmitry.baryshkov@oss.qualcomm.com>
---
Dmitry Baryshkov (7):
      drm/connector: let drivers declare infoframes as unsupported
      drm/bridge: adv7511: declare supported infoframes
      drm/bridge: ite-it6232: declare supported infoframes
      drm/bridge: lontium-lt9611: declare supported infoframes
      drm/bridge: synopsys/dw-hdmi-qp: declare supported infoframes
      drm/msm: hdmi: declare supported infoframes
      drm/rockchip: rk3066: declare supported infoframes

 drivers/gpu/drm/bridge/adv7511/adv7511_drv.c       |  1 +
 drivers/gpu/drm/bridge/ite-it6263.c                |  1 +
 drivers/gpu/drm/bridge/lontium-lt9611.c            |  4 ++
 drivers/gpu/drm/bridge/synopsys/dw-hdmi-qp.c       |  3 ++
 drivers/gpu/drm/display/drm_bridge_connector.c     |  6 +++
 drivers/gpu/drm/display/drm_hdmi_state_helper.c    | 43 +++++++++++++++++++++-
 drivers/gpu/drm/drm_connector.c                    |  4 ++
 drivers/gpu/drm/drm_debugfs.c                      | 16 +++++---
 drivers/gpu/drm/msm/hdmi/hdmi_bridge.c             |  4 ++
 drivers/gpu/drm/rockchip/inno_hdmi.c               |  1 +
 drivers/gpu/drm/rockchip/rk3066_hdmi.c             |  1 +
 drivers/gpu/drm/sun4i/sun4i_hdmi_enc.c             |  1 +
 drivers/gpu/drm/tests/drm_connector_test.c         | 28 ++++++++++++++
 drivers/gpu/drm/tests/drm_hdmi_state_helper_test.c |  8 ++++
 drivers/gpu/drm/vc4/vc4_hdmi.c                     |  4 ++
 include/drm/drm_bridge.h                           |  7 ++++
 include/drm/drm_connector.h                        | 23 ++++++++++++
 17 files changed, 148 insertions(+), 7 deletions(-)
---
base-commit: cb640b2ca54617f4a9d4d6efd5ff2afd6be11f19
change-id: 20250815-drm-limit-infoframes-e782fa7f3360

Best regards,
-- 
With best wishes
Dmitry


From mboxrd@z Thu Jan  1 00:00:00 1970
Received: from AM0PR83CU005.outbound.protection.outlook.com (mail-westeuropeazon11010003.outbound.protection.outlook.com [52.101.69.3])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by smtp.subspace.kernel.org (Postfix) with ESMTPS id DDEA7257AC7
	for <linux-sunxi@lists.linux.dev>; Wed, 20 Aug 2025 03:26:46 +0000 (UTC)
Authentication-Results: smtp.subspace.kernel.org; arc=fail smtp.client-ip=52.101.69.3
ARC-Seal: i=2; a=rsa-sha256; d=subspace.kernel.org; s=arc-20240116;
	t=1755660408; cv=fail; b=aaFo7OJiYcUBHzmlsbiPxQuBTeZMmTkaAsWsxYz56jTBgFtH+hPCTQ/YaDi1mSeEYTHO0K1otCDDk34GPiIFB2lfxSuA8cQaG1TB8dNHfjHe0A0fJGy3Rw91m5WvyOdekqQWST3gWw0FXIoWT1vT7z/Q4/tfH/bFEVOoN7qW5Rg=
ARC-Message-Signature: i=2; a=rsa-sha256; d=subspace.kernel.org;
	s=arc-20240116; t=1755660408; c=relaxed/simple;
	bh=S8gEhCaSVM6ewMQzF/ggZITS5j9VW+PhY2+RLSdB0Gc=;
	h=Message-ID:Date:Subject:To:Cc:References:From:In-Reply-To:
	 Content-Type:MIME-Version; b=OHFPUF18Dlk6rLR2RraD1RImSLr5p2kWaifS4RW9u5zBKDTjjxYjjJF9+tMjQMiOTg97T4qD7tSAZASW0Ho60MG9ZBRUx0KgIwDDqv84d/EM+PuHNDecDFKM0QlFkS5qx94z87pAtluIsgn3lmpqQmNdKzTMqCoatyMVLB6y2tI=
ARC-Authentication-Results: i=2; smtp.subspace.kernel.org; dmarc=pass (p=none dis=none) header.from=nxp.com; spf=pass smtp.mailfrom=nxp.com; dkim=pass (2048-bit key) header.d=nxp.com header.i=@nxp.com header.b=WEVgsAbS; arc=fail smtp.client-ip=52.101.69.3
Authentication-Results: smtp.subspace.kernel.org; dmarc=pass (p=none dis=none) header.from=nxp.com
Authentication-Results: smtp.subspace.kernel.org; spf=pass smtp.mailfrom=nxp.com
Authentication-Results: smtp.subspace.kernel.org;
	dkim=pass (2048-bit key) header.d=nxp.com header.i=@nxp.com header.b="WEVgsAbS"
ARC-Seal: i=1; a=rsa-sha256; s=arcselector10001; d=microsoft.com; cv=none;
 b=rSM6iPE15TsJAPpiP6pxd+pOPZeIDya8crWsKGN5LMEnrJhkFKJUStdFBZIrChNT1ISLCIcnyYKQ0/7/0HDGl1SHoIGqkvxtYQtrU1Ki7bB9oz0mcS+rfHHmSn8mD/SQPVS0t8E1QGJNaewgMz4iFPGgZtRabqxa4mp2SUXFH6U9tuMmaC4Z5GzI6bOYxgp60iUJsLL1Wop9kKwv/V+a/VWs/IC5g+HbUfxI2OtX/Zpu5IlO82kb9yCi6WQZiD/Wq9FbkPO/z+OJOUSe4PcLgv9vnFADLzFz4yjRNYlIb8DnWZeAxsYqU2883/znF1xYWRmOXEfpTQ14SCCQEpe/gw==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com;
 s=arcselector10001;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-AntiSpam-MessageData-ChunkCount:X-MS-Exchange-AntiSpam-MessageData-0:X-MS-Exchange-AntiSpam-MessageData-1;
 bh=odRY6BcYZ+8QVhNaKNFyX2Y8DrKA/CHzt8DcPqI5UoM=;
 b=ErNRavjxEhF8cCtPQy1elvsDrSYReH+FvKMqr1OOP5phvr2cYXfoHucRIQe6Wxg+TGwECZqvG4+pqo3FZknzVzKkz1mdI+Fga8pHB1hEAtVc70gzIP8QLwZlhZiwz3pIqtauTYMN8QQjWOlSSTrVKyF4RMKblV9HARjgAraLNtvtRRS3gsdYhPLt9biiIkooA23MXM7P+CQZWo97zUHikJrNawBZC2uDIW4DnsqLB6mnLih9X+Ub8Q8tSc26cdqjAn9tzXAReL6qMZd1NRxAUaHf0AU0gmSadZhLeWdYjEbCbWlTpH7nosW1w7IFK1XmXtg21kAoRrm1Qy7ZJSiMKA==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=nxp.com; dmarc=pass action=none header.from=nxp.com; dkim=pass
 header.d=nxp.com; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=nxp.com; s=selector1;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=odRY6BcYZ+8QVhNaKNFyX2Y8DrKA/CHzt8DcPqI5UoM=;
 b=WEVgsAbSFRV+cjPtNNRf8PuCDUF1L/CUuJ0d+dJWQjDCXzTuPYaQOgrwVkikMlFD1vzVvkxZaTD5RkF7MI2c921+T77tCUg18dXuPuvFmSDgpPyrqixrHIl417tQYN485/pAsTXJBmzYarLN+UkAYqOFXKLU3szzEUZKZFdtgGyKK7tZzgNzhI6usPN6L3lo7j7u6L3095mhrlhOpPsVp8cu/rUvqmHfOEs5D845VobD79L3K/GZAKThXbIB5C4pWC/rbSmmowL14VjrO9zghwobgpfX9REQxplb4CaqChIsT5jsbqg3TNyBUvx+28NgDcCVawWiFRp6sITp8K5DYw==
Authentication-Results: dkim=none (message not signed)
 header.d=none;dmarc=none action=none header.from=nxp.com;
Received: from AM7PR04MB7046.eurprd04.prod.outlook.com (2603:10a6:20b:113::22)
 by PA1PR04MB11384.eurprd04.prod.outlook.com (2603:10a6:102:4f5::14) with
 Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.9052.12; Wed, 20 Aug
 2025 03:26:44 +0000
Received: from AM7PR04MB7046.eurprd04.prod.outlook.com
 ([fe80::d1ce:ea15:6648:6f90]) by AM7PR04MB7046.eurprd04.prod.outlook.com
 ([fe80::d1ce:ea15:6648:6f90%5]) with mapi id 15.20.9052.012; Wed, 20 Aug 2025
 03:26:43 +0000
Message-ID: <185e3a1f-0d84-460f-a9b3-bc4bdc13e543@nxp.com>
Date: Wed, 20 Aug 2025 11:28:14 +0800
User-Agent: Mozilla Thunderbird
Subject: Re: [PATCH 3/7] drm/bridge: ite-it6232: declare supported infoframes
To: Dmitry Baryshkov <dmitry.baryshkov@oss.qualcomm.com>,
 Andrzej Hajda <andrzej.hajda@intel.com>,
 Neil Armstrong <neil.armstrong@linaro.org>, Robert Foss <rfoss@kernel.org>,
 Laurent Pinchart <Laurent.pinchart@ideasonboard.com>,
 Jonas Karlman <jonas@kwiboo.se>, Jernej Skrabec <jernej.skrabec@gmail.com>,
 Maarten Lankhorst <maarten.lankhorst@linux.intel.com>,
 Maxime Ripard <mripard@kernel.org>, Thomas Zimmermann <tzimmermann@suse.de>,
 David Airlie <airlied@gmail.com>, Simona Vetter <simona@ffwll.ch>,
 Sandy Huang <hjc@rock-chips.com>, =?UTF-8?Q?Heiko_St=C3=BCbner?=
 <heiko@sntech.de>, Andy Yan <andy.yan@rock-chips.com>,
 Chen-Yu Tsai <wens@csie.org>, Samuel Holland <samuel@sholland.org>,
 Dave Stevenson <dave.stevenson@raspberrypi.com>,
 =?UTF-8?Q?Ma=C3=ADra_Canal?= <mcanal@igalia.com>,
 Raspberry Pi Kernel Maintenance <kernel-list@raspberrypi.com>,
 Rob Clark <robin.clark@oss.qualcomm.com>, Dmitry Baryshkov
 <lumag@kernel.org>, Abhinav Kumar <abhinav.kumar@linux.dev>,
 Jessica Zhang <jessica.zhang@oss.qualcomm.com>, Sean Paul <sean@poorly.run>,
 Marijn Suijten <marijn.suijten@somainline.org>
Cc: dri-devel@lists.freedesktop.org, linux-kernel@vger.kernel.org,
 linux-arm-kernel@lists.infradead.org, linux-rockchip@lists.infradead.org,
 linux-sunxi@lists.linux.dev, linux-arm-msm@vger.kernel.org,
 freedreno@lists.freedesktop.org
References: <20250816-drm-limit-infoframes-v1-0-6dc17d5f07e9@oss.qualcomm.com>
 <20250816-drm-limit-infoframes-v1-3-6dc17d5f07e9@oss.qualcomm.com>
 <9e77615a-9d5b-4971-b1db-74d6bed39533@nxp.com>
 <24392da1-02f4-4d57-a145-6285d46d3bad@oss.qualcomm.com>
From: Liu Ying <victor.liu@nxp.com>
Content-Language: en-US
In-Reply-To: <24392da1-02f4-4d57-a145-6285d46d3bad@oss.qualcomm.com>
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
X-ClientProxiedBy: SG2PR01CA0197.apcprd01.prod.exchangelabs.com
 (2603:1096:4:189::8) To AM7PR04MB7046.eurprd04.prod.outlook.com
 (2603:10a6:20b:113::22)
Precedence: bulk
X-Mailing-List: linux-sunxi@lists.linux.dev
List-Id: <linux-sunxi.lists.linux.dev>
List-Subscribe: <mailto:linux-sunxi+subscribe@lists.linux.dev>
List-Unsubscribe: <mailto:linux-sunxi+unsubscribe@lists.linux.dev>
MIME-Version: 1.0
X-MS-PublicTrafficType: Email
X-MS-TrafficTypeDiagnostic: AM7PR04MB7046:EE_|PA1PR04MB11384:EE_
X-MS-Office365-Filtering-Correlation-Id: 8d67fbb1-cff5-46f2-d518-08dddf9962bd
X-LD-Processed: 686ea1d3-bc2b-4c6f-a92c-d99c5c301635,ExtAddr
X-MS-Exchange-SenderADCheck: 1
X-MS-Exchange-AntiSpam-Relay: 0
X-Microsoft-Antispam: 
 BCL:0;ARA:13230040|1800799024|366016|19092799006|7416014|376014|921020|7053199007;
X-Microsoft-Antispam-Message-Info: 
 =?utf-8?B?TzlnR2ptVFlLR2tVc1VuYTd0OXkyb284dXlGZDVxbUlEWDFqemlJQnUrYWkw?=
 =?utf-8?B?QjZmRHAxb3NiVklML01JZjBLVVBuQXNCWFI0bG5GZ1pXenpVWldWZFRmd3pR?=
 =?utf-8?B?RS8weEp2VXpOUDNYci9YQ294QjNxZ0dxZFVlYUxKbktUeExrYVdPWThhV0xL?=
 =?utf-8?B?Z3l1NnlJWVpWL2VSTXA3VHlXbHRsNVJhWjFTclFRdFBFYWJZNmxOaVZCUGJo?=
 =?utf-8?B?dHVSaFBZNWlCQjdQTDZXWmdNWE9hajdDWE83ZDVHVGtxL1d1ZDZQYlZhaFA3?=
 =?utf-8?B?M3Bkd2l3NkFIVUhSdEpYZDJ1NG9hQzFtTS9aNjlTbVBXblBHSERROUMxV0pz?=
 =?utf-8?B?SlhCY0o2UnVKa0wrWUFBNFpZbVkzVzB5OVh6bS9DaWF4VG1WRW5rd1dRR09Q?=
 =?utf-8?B?Qlp1RDVscENFRnVzT3dTVy9aellRcStvcjhpT1k1TVNUYkl5V2MybVZSeVk0?=
 =?utf-8?B?VFVzdVZiaElXZE81bjRnYzZ3SlJxL29ncFZQM1Q3RlZXREl6akk4bTZiQ2Nh?=
 =?utf-8?B?T1lvMWJjM1lVRFA2azBHVW5oTnQ4Vk1CdnkxcmgzaWVWMHZFcHNzYWY1Mk5D?=
 =?utf-8?B?SW1TZFB4bEdYTlNzUmh1T2MxT1Q1SEI1cktWck5DZWEvNjJ2Z2Zwd3llZGxa?=
 =?utf-8?B?Ym9OdWNIYWVkdmd1ZnhzWm5LRkhDYUVaRmc1TS9WaUFsb1FwRVhlV3hHTXFG?=
 =?utf-8?B?QncyYnEyVFhVZEFmSk5qMmo3R0RoKzV3YjlvcnFJdEttZkdUaDkwYXhKQnRJ?=
 =?utf-8?B?V3BBUk1Bb2crMkJBbzVQcWVsQ1ZyTE1LNHFMZmc1RDdzRXYwK0FsVUlQWXZT?=
 =?utf-8?B?YTJVcmtVeXJ5Y3FOTUVBM1dyb3RKZkpKeEhFTTZKUFh1UnFPYnk4eUUwK1Iz?=
 =?utf-8?B?REFMMWtaMDc1ZlZ4OVVJR3dkS3h1aGFoSmJ6OExKTjRrN0x3OWgvbmpyRUJY?=
 =?utf-8?B?Sjg2Q210WEQ3UHVBR3E2c3V6ZFdQa0NCZUFFci8wL3lRTiswNDAwUGYyOVl2?=
 =?utf-8?B?akU3Qnl4VHNuTXZUdUN2N1VEYjJiZnZTa01LSTlOMFRhU2QwcGZ5VlZYRXR4?=
 =?utf-8?B?OWd3cTg5cHlkQWFIOVVYRHFMZklDYVk3OXlhb3owOUVYUnl6NWhDK0ZEZjVn?=
 =?utf-8?B?YjF5d0J3Y0IwcUJEY3hNdHppbThVRGtkdUt6OUhKbldTNGFVSjgxN3RRNGZU?=
 =?utf-8?B?dk1oMjZlTTlJdGRGTVJ1WktrcEJFWmN6emdJMDQ1TDlKNXZGeFovb3ZpUTBy?=
 =?utf-8?B?SWQ4dTU5elNEd0Y0WlhMUFZZb0ZPK3VWNkZVdUVCc0RPRzdIOWtmV01SeHJ2?=
 =?utf-8?B?bjNZNEp3NWt6R3NOQ2JvUzZjbEtGYmpJTUpwRVVsQVpCcW53Q3NaL29CaHlX?=
 =?utf-8?B?eG1SRVlQeXlBZkcxSWV4aHJ6K0NvM3RIOHdrZnAvR200NFZzWXNrNURrWjdC?=
 =?utf-8?B?RGFSR1JUNGJLdVpjdUJQOCtLWnZiTWE2Q3duM0FOcnkrZjVoOGZnSjBNc2t3?=
 =?utf-8?B?WVkrbmN2TzZXQm1IaDh3SzFyUjU1Rm9DRGs4UjdyWUpKZXVJMDF1ZGdmQTZq?=
 =?utf-8?B?eHUrNlVUZGlUUEtnK3V6VG42dEltMWU0ZGZHNHAwbUwvME5xWmhlRFRHTWpj?=
 =?utf-8?B?WjlHVVBxOGpEakZJdWVsZGRUbmRQL1g5UVRUY3ROaHRGMXJtMVpyOGtxd3Mw?=
 =?utf-8?B?bU8zR3VrU3VFbFhrYUNpYTgyeG9yWE9mZVBiZkdOdVBDdW51UldwaHg5cEly?=
 =?utf-8?B?NHlLVHdkQXVlU0RJdjJvTld6N0RFZDJUREdlNEhMYmlxanhzUktUWnVmNTBu?=
 =?utf-8?B?ZmkvaUg4Y21RZ1NyUkQvREdrTURZNjZVK3gyWC9vbWtueEdaMWhiQ1FFK2py?=
 =?utf-8?B?OVZqdXpMVEU2eFNBekI2S2diTHV6cVUxUG1VeDNwaytSelJzRUU3emZBQ3RT?=
 =?utf-8?B?RVRSbzVWMU1oY0E1SmhSUVM1eDUwdkxOcXZyTm5qOUxwOVdtOFFTQmIrQWc3?=
 =?utf-8?B?NlNOemFWVjVnPT0=?=
X-Forefront-Antispam-Report: 
 CIP:255.255.255.255;CTRY:;LANG:en;SCL:1;SRV:;IPV:NLI;SFV:NSPM;H:AM7PR04MB7046.eurprd04.prod.outlook.com;PTR:;CAT:NONE;SFS:(13230040)(1800799024)(366016)(19092799006)(7416014)(376014)(921020)(7053199007);DIR:OUT;SFP:1101;
X-MS-Exchange-AntiSpam-MessageData-ChunkCount: 1
X-MS-Exchange-AntiSpam-MessageData-0: 
 =?utf-8?B?ZE9EUURGUFhCMnQ1cDdCR3hGTGRVU0N5YlZjNVY3Rkh3MHNDN1d0KzRWUFdv?=
 =?utf-8?B?MzRhV3g2RVlrY3ZtdXVZaGd5bkVuc3o0Ykw1SWhYZFc0WWtPRUJOTEtjbUZX?=
 =?utf-8?B?Z1E2M0Qwc1NQdXp2WVVub0pnMnIvdnhuakx3VStlemhiM1lOL3VQcy9vMEtW?=
 =?utf-8?B?UmR3ZjArNjlueVVCbmRGRklBck0vZWVnYUt6bzR1ZDB5QTQ3SHlXdGg0dU5q?=
 =?utf-8?B?Nmxrd3RWTkVkNWd3NFJ6VFlwVHFYK3ZNSXFET01mS0pMcTNxMDhTbnB2emZT?=
 =?utf-8?B?WjdpTVU2blZ4cm9OMkVNNUhtREEvaXBWSUdnMHllSGdPUVBHQ01maW5UQ3BX?=
 =?utf-8?B?RHNybEsybHRLeGI0clp3blV1NTd3M3gxQ3FaaGxONjlQVEFlcnFKckx6ZTZr?=
 =?utf-8?B?UDEzU3ZhamgrQ0FyUzZpN2F6N0dNNnRGYm8rSHgzRitwYjUyb2g4K0gvWi9X?=
 =?utf-8?B?NXBRMkZOeUIyZDdSTVY5eDBOTTNxenA0c0taUFhWNXBRMHpxQU5vRjB0d1Vy?=
 =?utf-8?B?cUROM3RzZmI1RGpBVGpQelZZQ3lPTlFHTnQwdTVML21LN0FDdHROMWdQaUdN?=
 =?utf-8?B?amZBbm8yTXF5WHc0b2tPYmVZRGhqSlh0bWRxOVkxSkR3d3NMMlpGY3hKZEdN?=
 =?utf-8?B?aWpMVDAycmRtM0lqRWRrb0dGV05HVldkbG9uOUVTTTBFQkVkalk1cm1MTzJi?=
 =?utf-8?B?RVBZQXk5czRHbUNYc052ejVtM2RsV0hYbEJkOFNtdHpZaUE4emQ1blNwSnMx?=
 =?utf-8?B?OXlhWDdUMTVRUEpqVVNVUFNORDFoSXU4WWNmUGdqbEhFVlZadEtGelZEbm5w?=
 =?utf-8?B?UisxbGs4dVpxQnkxdDdTOGhJMEZlMFRtTG5YTXpIUHQ0TG5aZEZxdDNHMW5q?=
 =?utf-8?B?Y21XQnZTb1VQQUFyUXZyUG9tVDFqUGZFMFpqOVJyTlVLME5ESGN6RFhmWFlO?=
 =?utf-8?B?ZWt0Y2JZOW1wZUNkZFlSQTlMaGxtQVRXK3kwTnZsV2hNc3FITUVlZzFZRjNF?=
 =?utf-8?B?WUd6SitvOHNjTSt0VGJaaC9uS2YzMkZhQjFUT1RsbHJpZm5RYkEzeFdkelFH?=
 =?utf-8?B?VXg3bEx4WXNoaHp6OTdGZFBqUmIvRVB3ZGMyeUFocG1lbjVWL0JuZGlNUGV0?=
 =?utf-8?B?YXdHN3dsUU10cTgxYzlKNyt6R2lUMHJyMzN1SnNzeld0NDFzbCtMcFk0dE5k?=
 =?utf-8?B?YTNrSVFNMXRPQWxlWVF3N01aUUIyRVcwakc0Y1ZjNjh5UHFZT1FjWGlDUUJy?=
 =?utf-8?B?UGhEbnBKK1BFcGwxOWVZWW0rYkxTQUJ2ODJwcTI3NC8zSmo4ZGFDY2xqcEdB?=
 =?utf-8?B?SEExdEpTVm5kRXF2VlEzanJGWGlqVitNWCt3cXluWEJlYXNsUEp2VWxEdDYz?=
 =?utf-8?B?WCtRQnVXZm1LTVRYNUFnem5nU1BUZ0Rhc3hGUEpLb1dCTUZwbDB4QTJ0VkxC?=
 =?utf-8?B?c1VVVGp0a1pBQlo0L2tubzV0MFJaa1UyMnlLTVFNdWtPUnR1b0llQU4xckVU?=
 =?utf-8?B?YXE3SHoxNlprc2trdjNtK0phTnlhRFh2bmdZcnpwMU5wOGQrcGNxWmF2cU1P?=
 =?utf-8?B?V21sdVdpU1Jjb3p2S1NDTHJZN0Vtb1RveEZxbUFCYUJlZW9CeVpyMDMvamYz?=
 =?utf-8?B?RzBEaDk5VFZFa3ZVT0Z3dWRuRm1mejRuSEpNdjZoMG54SGdWMEFrQ3FDMkYx?=
 =?utf-8?B?RW5ZWm03Y3p5WWxhY0dBdHdNVjNpR3JGcFVScjhpS3EwY1RnTUV3UlQwYXY3?=
 =?utf-8?B?T0pzSGFVS01nMkFRNmF3SHAwQXRUS0gyN1ZsaGllRjU1dU5wZmJBOG9reHdp?=
 =?utf-8?B?WkEwVXFXeWdmTktRUllCN1dUcFNnWlFFYjhpLzNSTjRsdmJtNWtkajZQcnpa?=
 =?utf-8?B?by91M0xCbldWNkRDMThMejFwSEVxLzA1b2Naam9laHlXVXFBRUFtdGR6RFNV?=
 =?utf-8?B?RmJVUVlYQ2JiV0xsQ00xNUJlclNPK0REQ2xQQ3JHdkpKd09sTnBFQlRUMSsx?=
 =?utf-8?B?alN6MnI2ekpMMldpMzFWb3NFUTUzU2F1dCtzcHRqKy9wMVNyRmNScG1YR1o4?=
 =?utf-8?B?YXAvRFJKdzlHM1JnUVM5Zk1FUmNaN040aFNTTHhwMjJkaENXeHZDZFU4QlRo?=
 =?utf-8?Q?Ltt0GnM8CDIUPU3fdZIgRKfzc?=
X-OriginatorOrg: nxp.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 8d67fbb1-cff5-46f2-d518-08dddf9962bd
X-MS-Exchange-CrossTenant-AuthSource: AM7PR04MB7046.eurprd04.prod.outlook.com
X-MS-Exchange-CrossTenant-AuthAs: Internal
X-MS-Exchange-CrossTenant-OriginalArrivalTime: 20 Aug 2025 03:26:43.8346
 (UTC)
X-MS-Exchange-CrossTenant-FromEntityHeader: Hosted
X-MS-Exchange-CrossTenant-Id: 686ea1d3-bc2b-4c6f-a92c-d99c5c301635
X-MS-Exchange-CrossTenant-MailboxType: HOSTED
X-MS-Exchange-CrossTenant-UserPrincipalName: qYBBkyvJ42WqfGFdFzXhdp+XKW0hdXFj+kQa5iP9VjXLiKAoDXuA7NLbaQ2t0LyzLMtsswtMBFSuY5hFmx3vqA==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: PA1PR04MB11384

On 08/19/2025, Dmitry Baryshkov wrote:
> On 19/08/2025 12:49, Liu Ying wrote:
>> Hi Dmitry,
>>
>> On 08/16/2025, Dmitry Baryshkov wrote:
>>> Declare which infoframes are supported via the .hdmi_write_infoframe()
>>> interface.
>>>
>>> Signed-off-by: Dmitry Baryshkov <dmitry.baryshkov@oss.qualcomm.com>
>>> ---
>>>   drivers/gpu/drm/bridge/ite-it6263.c | 1 +
>>>   1 file changed, 1 insertion(+)
>>
>> For subject, s/it6232/it6263.
> 
> Ack
> 
>>
>>>
>>> diff --git a/drivers/gpu/drm/bridge/ite-it6263.c b/drivers/gpu/drm/bridge/ite-it6263.c
>>> index cf813672b4ffb8ab5c524c6414ee7b414cebc018..b1956891a8388401c13cd2fc5c78f0779063adf4 100644
>>> --- a/drivers/gpu/drm/bridge/ite-it6263.c
>>> +++ b/drivers/gpu/drm/bridge/ite-it6263.c
>>> @@ -875,6 +875,7 @@ static int it6263_probe(struct i2c_client *client)
>>>       it->bridge.type = DRM_MODE_CONNECTOR_HDMIA;
>>>       it->bridge.vendor = "ITE";
>>>       it->bridge.product = "IT6263";
>>> +    it->bridge.supported_infoframes = DRM_CONNECTOR_INFOFRAME_AVI;
>>
>> With supported_infoframes set, the two lines setting vendor and product
>> are dead code.  I think it's worth dropping them and updating kerneldoc
>> for vendor and product members because they don't have to be required if
>> DRM_BRIDGE_OP_HDMI is set.  But, this could be done with future patch(not
>> in this patch series).
> 
> They are still required by the framework itself, see drmm_connector_hdmi_init().

Yes.  But it's a bit too strict since SPD infoframe is optional according
to CTA standard documentation.

> 
> BTW: I don't have ITE datasheet. Do you know if it really supports only the AVI frame?

AFAICS, it seems that ITE6263 supports inforframes from 0x81 to 0x85, so
including SPD inforframe.  Maybe, just keep those dead vendor&product
settings for now and add SPD inforframe in future.

> 
> 
>>
>> Reviewed-by: Liu Ying <victor.liu@nxp.com>
>>
>>>         return devm_drm_bridge_add(dev, &it->bridge);
>>>   }
>>>
>>
>>
> 
> 


-- 
Regards,
Liu Ying

From mboxrd@z Thu Jan  1 00:00:00 1970
Received: from mx0a-0031df01.pphosted.com (mx0a-0031df01.pphosted.com [205.220.168.131])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by smtp.subspace.kernel.org (Postfix) with ESMTPS id 85D07322A39
	for <linux-sunxi@lists.linux.dev>; Tue, 19 Aug 2025 10:56:08 +0000 (UTC)
Authentication-Results: smtp.subspace.kernel.org; arc=none smtp.client-ip=205.220.168.131
ARC-Seal: i=1; a=rsa-sha256; d=subspace.kernel.org; s=arc-20240116;
	t=1755600969; cv=none; b=EYKESEoXInMNmNnsuUhTEc5X6WKp6B5HL0JOrewvG853rcnQ0CwQ0E5nDS4sjKDzXZCA+FOEkYo2f9scjK2Wof3DiYZWWLSau77+lxNhF/xVLTBLw2QizkGcC7pYK6T5uICbHgzopOcKS5e201r4EBdEadPCvTRIRUzraGO8rno=
ARC-Message-Signature: i=1; a=rsa-sha256; d=subspace.kernel.org;
	s=arc-20240116; t=1755600969; c=relaxed/simple;
	bh=QwGOkV1bx4gYciZu9ZTwqCJFEP0Q063FTqp8q8Rpzt8=;
	h=Message-ID:Date:MIME-Version:Subject:To:Cc:References:From:
	 In-Reply-To:Content-Type; b=n1cB3Qs39j9n+bVbtg0WW9nXUxoQc/bBVZ9nwWDYcWtSRNfaSY+WamuKgxGZPbazpfvhVQcYyN7yoPtnSE/WQ6KR6XVIr37X8bJqZYQDNxpqNdw3OHtixWU+ayqodKtUiAnMUvL5XzlBuqhBP/eMRJkHCG9Sl9GaPc1vUK1fKB0=
ARC-Authentication-Results: i=1; smtp.subspace.kernel.org; dmarc=pass (p=reject dis=none) header.from=oss.qualcomm.com; spf=pass smtp.mailfrom=oss.qualcomm.com; dkim=pass (2048-bit key) header.d=qualcomm.com header.i=@qualcomm.com header.b=lKzL53i4; arc=none smtp.client-ip=205.220.168.131
Authentication-Results: smtp.subspace.kernel.org; dmarc=pass (p=reject dis=none) header.from=oss.qualcomm.com
Authentication-Results: smtp.subspace.kernel.org; spf=pass smtp.mailfrom=oss.qualcomm.com
Authentication-Results: smtp.subspace.kernel.org;
	dkim=pass (2048-bit key) header.d=qualcomm.com header.i=@qualcomm.com header.b="lKzL53i4"
Received: from pps.filterd (m0279864.ppops.net [127.0.0.1])
	by mx0a-0031df01.pphosted.com (8.18.1.2/8.18.1.2) with ESMTP id 57J90egw029860
	for <linux-sunxi@lists.linux.dev>; Tue, 19 Aug 2025 10:56:07 GMT
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=qualcomm.com; h=
	cc:content-transfer-encoding:content-type:date:from:in-reply-to
	:message-id:mime-version:references:subject:to; s=qcppdkim1; bh=
	7ghZKUm2aSWn//5Tci+9wfrDSWfLO9oHcOcQ8IQR6Q4=; b=lKzL53i4X+RI5ARV
	H6dGQrFJ5FDOsQfKbKoJAdcIu+/8dkobyoybJx1JjkFSzIC6f+Xwv8DMNGhEEJ0d
	fnYhCiEyndv/Ktj0OVZOFXa3J3Lh5njFVhfyuaqIQghosZIm/YW6pweyW7vnNQCl
	HO7hJ80aHk/ulVaRuPMikMrakI7cYzhPoLeG2pSbHEgVG6196wUZmYBYDZeW2mLR
	fq5WH/v4wsCNoFduSYa2Al6DbUv7xQCShvFy5qAVHdkX+0MUWlgHRvHF0znA/B0V
	T37O/Q1kBZh8Ueju6ywf7DrqxyEKcQgUl1FwmSgS4jNl7m9Fx3+aFC2Q42EjPuPB
	yUDEtg==
Received: from mail-qv1-f72.google.com (mail-qv1-f72.google.com [209.85.219.72])
	by mx0a-0031df01.pphosted.com (PPS) with ESMTPS id 48jk5mg4p8-1
	(version=TLSv1.2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128 verify=NOT)
	for <linux-sunxi@lists.linux.dev>; Tue, 19 Aug 2025 10:56:07 +0000 (GMT)
Received: by mail-qv1-f72.google.com with SMTP id 6a1803df08f44-70a88de16c0so119070706d6.0
        for <linux-sunxi@lists.linux.dev>; Tue, 19 Aug 2025 03:56:07 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20230601; t=1755600966; x=1756205766;
        h=content-transfer-encoding:in-reply-to:from:content-language
         :references:cc:to:subject:user-agent:mime-version:date:message-id
         :x-gm-message-state:from:to:cc:subject:date:message-id:reply-to;
        bh=7ghZKUm2aSWn//5Tci+9wfrDSWfLO9oHcOcQ8IQR6Q4=;
        b=K/4FFtBokyOelqKbqYL0uCuUzD9p1rK8aCCNtQluGuY/6LdAgOzWeAIpM9f96S14Mz
         bISe08eQj5MKGqHaNPvWrkwUgwamUsR1ZS62XZKSqTTtfa6gsj+wiCbwBB/GDksy2bxu
         zLXfbQF407e3BwdKjB6gC3OkIB475bm0NQJI//k876FidpPZHcrkK5bcwAIP5ntgPprP
         rd8q137NNL3vBJT2LZsBZQiq0dPsdkutqqs5tkGs80JGE1sEGIpjIz8y3FaD4l+X/vc9
         G8GUT9GRxhwpAPWHUFYCfUsgu43ZxQQDzpxLoSGA4mTDkKwkAM7yRarxkcU1UqSz5O1c
         7A4A==
X-Forwarded-Encrypted: i=1; AJvYcCWrxq/qdM1GRv/yDLfYMVyIecEMX+6xK0+eSv6hZtUcsjWm9ynX7CZ0+bRNqokDCkLBFe7V3INiOiFARA==@lists.linux.dev
X-Gm-Message-State: AOJu0Yy4ZIJjg9caZjBwLI6uZaJ57cteqIuMB5Q4zGGgw8S9+WCoz2J8
	AxU/ws1sby8OY62p2aChz6GuBDkKqEjjQZSmYdePKAPU9tPHLjyEeyQnzdV48EqqpHPgbCZ9vLf
	b5R6M71Nfi071zd71zh21T6AZZBQYmfi1WGvBqdDmlMxBbNC0oDqk2y05355hjiFXlg==
X-Gm-Gg: ASbGncvnvqX54DZ+VxQiMLRyu81zdZkmq1qR457gT/+tygsP5Hx5PrIuHUVTssY80VJ
	+VaBdedvoU9oYo5Ru4SommA9bXG/TlQwowoKZI0BWn6jqqxLbnkyI/tPsXRlSSpf7p3c4m59sMi
	hMXmow6EyumFGLCRF3CF1o0S+Z+lyVlnkeo5rLmbqMWoYEGAgZZArfUphuHaYFk03ZlumBAJbFZ
	ks/wPNeWJN9A6cI0+6IKyO8FS4GjEM+EWFx+fInPAcD/a6FXFnTQYzkzsuNd/mFzd9Gr9AgcQqS
	b4+4/h0YekO83oynOOwH71dTMmtddsUWssFT7R8D6Lt9ulH4JbWJS38kIz/ZwjVDLzpe8iuw2hc
	ipmRdasp2GXRq6skiNg==
X-Received: by 2002:a05:6214:c28:b0:70b:c900:c554 with SMTP id 6a1803df08f44-70c35d70672mr17885246d6.51.1755600966220;
        Tue, 19 Aug 2025 03:56:06 -0700 (PDT)
X-Google-Smtp-Source: AGHT+IEGUxbouQ23f5n9Nb/Ax/PRMhBNA4fuV1P2n23CV0Mrc7Iqs7S7DSWRnZn8F0Lk+cpHItsHnA==
X-Received: by 2002:a05:6214:c28:b0:70b:c900:c554 with SMTP id 6a1803df08f44-70c35d70672mr17884996d6.51.1755600965717;
        Tue, 19 Aug 2025 03:56:05 -0700 (PDT)
Received: from [10.207.49.70] (84-253-220-51.bb.dnainternet.fi. [84.253.220.51])
        by smtp.gmail.com with ESMTPSA id 38308e7fff4ca-3340a41d325sm21592351fa.5.2025.08.19.03.56.03
        (version=TLS1_3 cipher=TLS_AES_128_GCM_SHA256 bits=128/128);
        Tue, 19 Aug 2025 03:56:04 -0700 (PDT)
Message-ID: <24392da1-02f4-4d57-a145-6285d46d3bad@oss.qualcomm.com>
Date: Tue, 19 Aug 2025 13:56:02 +0300
Precedence: bulk
X-Mailing-List: linux-sunxi@lists.linux.dev
List-Id: <linux-sunxi.lists.linux.dev>
List-Subscribe: <mailto:linux-sunxi+subscribe@lists.linux.dev>
List-Unsubscribe: <mailto:linux-sunxi+unsubscribe@lists.linux.dev>
MIME-Version: 1.0
User-Agent: Mozilla Thunderbird
Subject: Re: [PATCH 3/7] drm/bridge: ite-it6232: declare supported infoframes
To: Liu Ying <victor.liu@nxp.com>, Andrzej Hajda <andrzej.hajda@intel.com>,
        Neil Armstrong <neil.armstrong@linaro.org>,
        Robert Foss <rfoss@kernel.org>,
        Laurent Pinchart <Laurent.pinchart@ideasonboard.com>,
        Jonas Karlman <jonas@kwiboo.se>,
        Jernej Skrabec <jernej.skrabec@gmail.com>,
        Maarten Lankhorst <maarten.lankhorst@linux.intel.com>,
        Maxime Ripard <mripard@kernel.org>,
        Thomas Zimmermann <tzimmermann@suse.de>,
        David Airlie <airlied@gmail.com>, Simona Vetter <simona@ffwll.ch>,
        Sandy Huang <hjc@rock-chips.com>,
        =?UTF-8?Q?Heiko_St=C3=BCbner?=
 <heiko@sntech.de>,
        Andy Yan <andy.yan@rock-chips.com>, Chen-Yu Tsai <wens@csie.org>,
        Samuel Holland <samuel@sholland.org>,
        Dave Stevenson <dave.stevenson@raspberrypi.com>,
        =?UTF-8?Q?Ma=C3=ADra_Canal?= <mcanal@igalia.com>,
        Raspberry Pi Kernel Maintenance <kernel-list@raspberrypi.com>,
        Rob Clark <robin.clark@oss.qualcomm.com>,
        Dmitry Baryshkov
 <lumag@kernel.org>,
        Abhinav Kumar <abhinav.kumar@linux.dev>,
        Jessica Zhang <jessica.zhang@oss.qualcomm.com>,
        Sean Paul <sean@poorly.run>,
        Marijn Suijten <marijn.suijten@somainline.org>
Cc: dri-devel@lists.freedesktop.org, linux-kernel@vger.kernel.org,
        linux-arm-kernel@lists.infradead.org,
        linux-rockchip@lists.infradead.org, linux-sunxi@lists.linux.dev,
        linux-arm-msm@vger.kernel.org, freedreno@lists.freedesktop.org
References: <20250816-drm-limit-infoframes-v1-0-6dc17d5f07e9@oss.qualcomm.com>
 <20250816-drm-limit-infoframes-v1-3-6dc17d5f07e9@oss.qualcomm.com>
 <9e77615a-9d5b-4971-b1db-74d6bed39533@nxp.com>
Content-Language: en-US
From: Dmitry Baryshkov <dmitry.baryshkov@oss.qualcomm.com>
In-Reply-To: <9e77615a-9d5b-4971-b1db-74d6bed39533@nxp.com>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Authority-Analysis: v=2.4 cv=Sdn3duRu c=1 sm=1 tr=0 ts=68a45847 cx=c_pps
 a=7E5Bxpl4vBhpaufnMqZlrw==:117 a=JdIsBVl79nXNK9flUcZCTw==:17
 a=IkcTkHD0fZMA:10 a=2OwXVqhp2XgA:10 a=EUspDBNiAAAA:8 a=8AirrxEcAAAA:8
 a=y4d4D-FnMFCReEbV-5EA:9 a=QEXdDO2ut3YA:10 a=pJ04lnu7RYOZP9TFuWaZ:22
 a=ST-jHhOKWsTCqRlWije3:22
X-Proofpoint-ORIG-GUID: jtsJEqL1vbKaa7pW_kONDYXP9sQP8iDc
X-Proofpoint-GUID: jtsJEqL1vbKaa7pW_kONDYXP9sQP8iDc
X-Proofpoint-Spam-Details-Enc: AW1haW4tMjUwODE2MDA0MiBTYWx0ZWRfX9zD/jq6xbTo1
 uFv/TF8vIZAzQnzFGt1w9ODGIuCmcB2AfmlvfSfStlrW03X2YqoEsL+Ll/hFFKGaJGII3r888pP
 Hqtz/aOv/arhZSe3jo9ik3rJJAsBBy7Rvg5UHMZEPc6y899CRcOASvbwSKQx33B45mzm1BXBNNt
 IY44wcrjCJFp6zDTPphjQuuUgCjOk9ifi/2j3t/rQ4clmr/FzHp9xf9FAwHEDVCfIqBFzlH2TjR
 acitWLaGeWxoD4LtCJaTcdas6tCVwgDPKODkkeE1Fps+OJMKFjW/JD10t8287cNO4OGlHarSdbA
 QMpZMfVZVfbBz1KTYVAI0rcgsOUymnEQw14lTDhAPaCg5lngjTphn3nSt9TIqB20mQdrjZCtrMn
 oRaGrtnR
X-Proofpoint-Virus-Version: vendor=baseguard
 engine=ICAP:2.0.293,Aquarius:18.0.1099,Hydra:6.1.9,FMLib:17.12.80.40
 definitions=2025-08-19_01,2025-08-14_01,2025-03-28_01
X-Proofpoint-Spam-Details: rule=outbound_notspam policy=outbound score=0
 impostorscore=0 clxscore=1015 suspectscore=0 priorityscore=1501 spamscore=0
 adultscore=0 malwarescore=0 bulkscore=0 phishscore=0 classifier=typeunknown
 authscore=0 authtc= authcc= route=outbound adjust=0 reason=mlx scancount=1
 engine=8.19.0-2507300000 definitions=main-2508160042

On 19/08/2025 12:49, Liu Ying wrote:
> Hi Dmitry,
> 
> On 08/16/2025, Dmitry Baryshkov wrote:
>> Declare which infoframes are supported via the .hdmi_write_infoframe()
>> interface.
>>
>> Signed-off-by: Dmitry Baryshkov <dmitry.baryshkov@oss.qualcomm.com>
>> ---
>>   drivers/gpu/drm/bridge/ite-it6263.c | 1 +
>>   1 file changed, 1 insertion(+)
> 
> For subject, s/it6232/it6263.

Ack

> 
>>
>> diff --git a/drivers/gpu/drm/bridge/ite-it6263.c b/drivers/gpu/drm/bridge/ite-it6263.c
>> index cf813672b4ffb8ab5c524c6414ee7b414cebc018..b1956891a8388401c13cd2fc5c78f0779063adf4 100644
>> --- a/drivers/gpu/drm/bridge/ite-it6263.c
>> +++ b/drivers/gpu/drm/bridge/ite-it6263.c
>> @@ -875,6 +875,7 @@ static int it6263_probe(struct i2c_client *client)
>>   	it->bridge.type = DRM_MODE_CONNECTOR_HDMIA;
>>   	it->bridge.vendor = "ITE";
>>   	it->bridge.product = "IT6263";
>> +	it->bridge.supported_infoframes = DRM_CONNECTOR_INFOFRAME_AVI;
> 
> With supported_infoframes set, the two lines setting vendor and product
> are dead code.  I think it's worth dropping them and updating kerneldoc
> for vendor and product members because they don't have to be required if
> DRM_BRIDGE_OP_HDMI is set.  But, this could be done with future patch(not
> in this patch series).

They are still required by the framework itself, see 
drmm_connector_hdmi_init().

BTW: I don't have ITE datasheet. Do you know if it really supports only 
the AVI frame?


> 
> Reviewed-by: Liu Ying <victor.liu@nxp.com>
> 
>>   
>>   	return devm_drm_bridge_add(dev, &it->bridge);
>>   }
>>
> 
> 


-- 
With best wishes
Dmitry

From mboxrd@z Thu Jan  1 00:00:00 1970
Received: from mx0b-0031df01.pphosted.com (mx0b-0031df01.pphosted.com [205.220.180.131])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by smtp.subspace.kernel.org (Postfix) with ESMTPS id AEF452E4272
	for <linux-sunxi@lists.linux.dev>; Wed, 20 Aug 2025 11:15:23 +0000 (UTC)
Authentication-Results: smtp.subspace.kernel.org; arc=none smtp.client-ip=205.220.180.131
ARC-Seal: i=1; a=rsa-sha256; d=subspace.kernel.org; s=arc-20240116;
	t=1755688525; cv=none; b=PQ0r3nWV8rVBi2aN6BpK6hYuSlq83Kqz+4yquRoEMPyFgsquhr6+ZH8JYVO6ECHmBSdHhFfFOZzgkirP53hY5oKFoFa9VPP1BZi3wvA3//V0z+XMEV9V4oO2DPChsaOb1TRPsaMlEmSGWHZyMQfOmbL6brwolMMlfgyiqb0cJYk=
ARC-Message-Signature: i=1; a=rsa-sha256; d=subspace.kernel.org;
	s=arc-20240116; t=1755688525; c=relaxed/simple;
	bh=N3jVviVUVIkGA2UsqTc0aDKqppWgjdo0JZeoRGhttoE=;
	h=Message-ID:Date:MIME-Version:Subject:To:Cc:References:From:
	 In-Reply-To:Content-Type; b=itT/zyy+o0chu1h2nlLjWEThgjWvpaffM72z0SMpq3Icr0N7sY8ceB5sPqMBGoswWEsgeb42xrFYKtS7aYlOc/7DFcHtZLg7JZuPGSAWqONIx/Q9bWMwHsoZcNlo0Vctf/fLhRjnZpLQLT/jkq2AjQ+l5wfsyTTPM3/7NzQ//xw=
ARC-Authentication-Results: i=1; smtp.subspace.kernel.org; dmarc=pass (p=reject dis=none) header.from=oss.qualcomm.com; spf=pass smtp.mailfrom=oss.qualcomm.com; dkim=pass (2048-bit key) header.d=qualcomm.com header.i=@qualcomm.com header.b=HDBz9s0P; arc=none smtp.client-ip=205.220.180.131
Authentication-Results: smtp.subspace.kernel.org; dmarc=pass (p=reject dis=none) header.from=oss.qualcomm.com
Authentication-Results: smtp.subspace.kernel.org; spf=pass smtp.mailfrom=oss.qualcomm.com
Authentication-Results: smtp.subspace.kernel.org;
	dkim=pass (2048-bit key) header.d=qualcomm.com header.i=@qualcomm.com header.b="HDBz9s0P"
Received: from pps.filterd (m0279870.ppops.net [127.0.0.1])
	by mx0a-0031df01.pphosted.com (8.18.1.2/8.18.1.2) with ESMTP id 57K9fSwe010404
	for <linux-sunxi@lists.linux.dev>; Wed, 20 Aug 2025 11:15:22 GMT
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=qualcomm.com; h=
	cc:content-transfer-encoding:content-type:date:from:in-reply-to
	:message-id:mime-version:references:subject:to; s=qcppdkim1; bh=
	0qOyFSkF1mdae5iDRyH3LBmMdqCqXxN25f67C6/GSMc=; b=HDBz9s0P0s4Kh+ni
	az8k8TI4qABStThkA0Z8IgzaEkIiqLLaLc+IRdUfQyQku2yvyoxsIqTFMyqs15td
	xcEZYPBY0X/a8SIOmUduYv0Y+VXWdamebto9yAlJkQau3IwMiTx2h0GUJFpDAVGp
	rhPlY4h3VHVsvD8cBsbcp4HGygJ9JTu/V8tOP2KhAf5kWsOAombcYXcP47NDPRZI
	XaPpInAx0kROt9ItCDG/ZaddcQedMrPW/P45zw4O0H1Sl4LAkOCG9wpGByXiOzn/
	Y9a+xebCg7AnpO15RT7LC4NcFfAeclEXTgYopfYmGCr8AHZiofnC+5Lp7V8/7RvL
	DsSRmg==
Received: from mail-qv1-f70.google.com (mail-qv1-f70.google.com [209.85.219.70])
	by mx0a-0031df01.pphosted.com (PPS) with ESMTPS id 48n528sg46-1
	(version=TLSv1.2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128 verify=NOT)
	for <linux-sunxi@lists.linux.dev>; Wed, 20 Aug 2025 11:15:22 +0000 (GMT)
Received: by mail-qv1-f70.google.com with SMTP id 6a1803df08f44-70a88dd0193so142384876d6.0
        for <linux-sunxi@lists.linux.dev>; Wed, 20 Aug 2025 04:15:22 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20230601; t=1755688522; x=1756293322;
        h=content-transfer-encoding:in-reply-to:from:content-language
         :references:cc:to:subject:user-agent:mime-version:date:message-id
         :x-gm-message-state:from:to:cc:subject:date:message-id:reply-to;
        bh=0qOyFSkF1mdae5iDRyH3LBmMdqCqXxN25f67C6/GSMc=;
        b=eVelJk1s2FLHDbEcRfE0AIgFosBC4fuwG1gnv0mTS7jSKjeWkU5RFZP641Zd1R7Xy0
         Ss3HLtgddp16taCnRAQSu4XvEDmOZpIZhMnGlrxI1SvbjYBvEF1h9r2GKcUB64+2ZGn1
         7Bq/we4sM+jyiu0WdZ117a6iXRxgrzALIWryrwOZhd4EZtc8KTfCbL3xhrFM3FvrTQIo
         LRzmpU9fVeQuq/oJe1kuJtEvZX8h1jzOTAgC/Hkd/jAyHV8vH4oAWadGbRHY7bBP48Ki
         HRiaKN20uMx+bc+yq7vJhhP3daKgwriYeNTal8HOfoFQ33CYFyPOx4D+QhSvZkH3eyBu
         rxFQ==
X-Forwarded-Encrypted: i=1; AJvYcCXFAVa+cl420lJco5dOeMsLtS5K1ehA6FwYmI0zY7qEdut4OIuypqv8LAVfldilas4Ets6a2HCiyf1Vlw==@lists.linux.dev
X-Gm-Message-State: AOJu0YxhbCPCCw+VKUSDNjSbfj73eJ6VfExdkNn4z+2L42O3JFu0vTeI
	ujtZfL8wliC2b8XAt3cylBbJkwfijhhpL4V3vijy1xwaXrOsP4jP9uPRjQ1O7QPUvLfEUWUVaIm
	pcIKdnaeH6qCIGjXdzXRq76bGz7gGf0YU4RmjGsksDB28kqovKcnKulkJ2P38V+8exA==
X-Gm-Gg: ASbGncs+5cQ3WrloiGBpuzgz2pkN++hnCaTuNQR968HsqBKMNpoi8B1vdsnE7a6xgIB
	qsnmhfnR/rMU3AfwD0EoaphoOmqBRbMY25SQYukYMz3Ngv8rUMYuurPS4zAnhqbSM7ly/Qx+1jZ
	LA9R0bF+EtBtRWQqVjlHOkKAp1y54AO9QDVndw8f9kalKok2tjOuXpHxSYb/wFW9359WAyWZ/so
	pQgMUaArc3B6NQu0ZFRT+hQVqKzldccVSSYMsE7nwiI8rmV48iUUkhc5cLXsGnOJutxxUjYkM7l
	tCAzptVOo0r8PJEH5pYlsY1r1w+lusZf97LNVS/rAQQT4Cg6HLeppkGmReFBt6/YQsQ2IS+X1ac
	3yDAWiXR9wXbKv5OGsw==
X-Received: by 2002:a05:6214:1c47:b0:709:50b8:cb85 with SMTP id 6a1803df08f44-70d76fb14a1mr20921966d6.20.1755688521415;
        Wed, 20 Aug 2025 04:15:21 -0700 (PDT)
X-Google-Smtp-Source: AGHT+IH80qwENBGa8LZaS2l/vsPkoG89K8rwgcpZkHUFmG54urW6WuO247zB8LpY8iq/8kq4fh5zOA==
X-Received: by 2002:a05:6214:1c47:b0:709:50b8:cb85 with SMTP id 6a1803df08f44-70d76fb14a1mr20921616d6.20.1755688520930;
        Wed, 20 Aug 2025 04:15:20 -0700 (PDT)
Received: from [10.207.49.70] (84-253-220-51.bb.dnainternet.fi. [84.253.220.51])
        by smtp.gmail.com with ESMTPSA id 38308e7fff4ca-3340a489f49sm26715321fa.35.2025.08.20.04.15.19
        (version=TLS1_3 cipher=TLS_AES_128_GCM_SHA256 bits=128/128);
        Wed, 20 Aug 2025 04:15:20 -0700 (PDT)
Message-ID: <db09dded-deff-4233-bacc-90d41346f52d@oss.qualcomm.com>
Date: Wed, 20 Aug 2025 14:15:18 +0300
Precedence: bulk
X-Mailing-List: linux-sunxi@lists.linux.dev
List-Id: <linux-sunxi.lists.linux.dev>
List-Subscribe: <mailto:linux-sunxi+subscribe@lists.linux.dev>
List-Unsubscribe: <mailto:linux-sunxi+unsubscribe@lists.linux.dev>
MIME-Version: 1.0
User-Agent: Mozilla Thunderbird
Subject: Re: [PATCH 3/7] drm/bridge: ite-it6232: declare supported infoframes
To: Liu Ying <victor.liu@nxp.com>, Andrzej Hajda <andrzej.hajda@intel.com>,
        Neil Armstrong <neil.armstrong@linaro.org>,
        Robert Foss <rfoss@kernel.org>,
        Laurent Pinchart <Laurent.pinchart@ideasonboard.com>,
        Jonas Karlman <jonas@kwiboo.se>,
        Jernej Skrabec <jernej.skrabec@gmail.com>,
        Maarten Lankhorst <maarten.lankhorst@linux.intel.com>,
        Maxime Ripard <mripard@kernel.org>,
        Thomas Zimmermann <tzimmermann@suse.de>,
        David Airlie <airlied@gmail.com>, Simona Vetter <simona@ffwll.ch>,
        Sandy Huang <hjc@rock-chips.com>,
        =?UTF-8?Q?Heiko_St=C3=BCbner?=
 <heiko@sntech.de>,
        Andy Yan <andy.yan@rock-chips.com>, Chen-Yu Tsai <wens@csie.org>,
        Samuel Holland <samuel@sholland.org>,
        Dave Stevenson <dave.stevenson@raspberrypi.com>,
        =?UTF-8?Q?Ma=C3=ADra_Canal?= <mcanal@igalia.com>,
        Raspberry Pi Kernel Maintenance <kernel-list@raspberrypi.com>,
        Rob Clark <robin.clark@oss.qualcomm.com>,
        Dmitry Baryshkov
 <lumag@kernel.org>,
        Abhinav Kumar <abhinav.kumar@linux.dev>,
        Jessica Zhang <jessica.zhang@oss.qualcomm.com>,
        Sean Paul <sean@poorly.run>,
        Marijn Suijten <marijn.suijten@somainline.org>
Cc: dri-devel@lists.freedesktop.org, linux-kernel@vger.kernel.org,
        linux-arm-kernel@lists.infradead.org,
        linux-rockchip@lists.infradead.org, linux-sunxi@lists.linux.dev,
        linux-arm-msm@vger.kernel.org, freedreno@lists.freedesktop.org
References: <20250816-drm-limit-infoframes-v1-0-6dc17d5f07e9@oss.qualcomm.com>
 <20250816-drm-limit-infoframes-v1-3-6dc17d5f07e9@oss.qualcomm.com>
 <9e77615a-9d5b-4971-b1db-74d6bed39533@nxp.com>
 <24392da1-02f4-4d57-a145-6285d46d3bad@oss.qualcomm.com>
 <185e3a1f-0d84-460f-a9b3-bc4bdc13e543@nxp.com>
Content-Language: en-US
From: Dmitry Baryshkov <dmitry.baryshkov@oss.qualcomm.com>
In-Reply-To: <185e3a1f-0d84-460f-a9b3-bc4bdc13e543@nxp.com>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Authority-Analysis: v=2.4 cv=I4c8hNgg c=1 sm=1 tr=0 ts=68a5ae4a cx=c_pps
 a=oc9J++0uMp73DTRD5QyR2A==:117 a=JdIsBVl79nXNK9flUcZCTw==:17
 a=IkcTkHD0fZMA:10 a=2OwXVqhp2XgA:10 a=EUspDBNiAAAA:8 a=8AirrxEcAAAA:8
 a=5lv965NAfe5egn04DU8A:9 a=QEXdDO2ut3YA:10 a=iYH6xdkBrDN1Jqds4HTS:22
 a=ST-jHhOKWsTCqRlWije3:22
X-Proofpoint-GUID: pAoZvHGjSAMP5fM99NqtScG7vDmNNcpo
X-Proofpoint-ORIG-GUID: pAoZvHGjSAMP5fM99NqtScG7vDmNNcpo
X-Proofpoint-Spam-Details-Enc: AW1haW4tMjUwODIwMDAxMyBTYWx0ZWRfXyKwWbT3SWfZ5
 U8wIwmek7qQHOi5MzL2fJYNHngZkMUldlWTGc5wY7OVeB3Oi6Wi10bUBZFjMz9A7A37igNtlA6F
 Cu+DbfLJ72QIbl3hvck7WGAi/R7FqZjb1cDpQuata95maE573Bv0R1NHZ8WFborbZDCFFQLqAba
 jt0zf+TQ5EKincMeULJI0kH3ioIdPiEj0eXLPVZAYNuKNoP0B2Od/rvEkcEOo4oPCWlmi4JjfU8
 gxzBJ6kCIZUGCHtoyGEPH+uxShLmDZ+S/IgG+Sgv/7Y0pePK7MLD65mTkGRsZMDR+2HH5/P+Ek9
 YpidB0wjeSojjvL6r14HMgJWAa+AkIg0JiXtxri1saITUq/NzkFhBli7I3qCPLsdEbB3CSuQVBs
 80NBL4UtSbt3azQHRC5X5sYIpaFBhA==
X-Proofpoint-Virus-Version: vendor=baseguard
 engine=ICAP:2.0.293,Aquarius:18.0.1099,Hydra:6.1.9,FMLib:17.12.80.40
 definitions=2025-08-20_03,2025-08-20_02,2025-03-28_01
X-Proofpoint-Spam-Details: rule=outbound_notspam policy=outbound score=0
 adultscore=0 clxscore=1015 malwarescore=0 spamscore=0 priorityscore=1501
 lowpriorityscore=0 phishscore=0 impostorscore=0 bulkscore=0 suspectscore=0
 classifier=typeunknown authscore=0 authtc= authcc= route=outbound adjust=0
 reason=mlx scancount=1 engine=8.19.0-2508110000 definitions=main-2508200013

On 20/08/2025 06:28, Liu Ying wrote:
> On 08/19/2025, Dmitry Baryshkov wrote:
>> On 19/08/2025 12:49, Liu Ying wrote:
>>> Hi Dmitry,
>>>
>>> On 08/16/2025, Dmitry Baryshkov wrote:
>>>> Declare which infoframes are supported via the .hdmi_write_infoframe()
>>>> interface.
>>>>
>>>> Signed-off-by: Dmitry Baryshkov <dmitry.baryshkov@oss.qualcomm.com>
>>>> ---
>>>>    drivers/gpu/drm/bridge/ite-it6263.c | 1 +
>>>>    1 file changed, 1 insertion(+)
>>>
>>> For subject, s/it6232/it6263.
>>
>> Ack
>>
>>>
>>>>
>>>> diff --git a/drivers/gpu/drm/bridge/ite-it6263.c b/drivers/gpu/drm/bridge/ite-it6263.c
>>>> index cf813672b4ffb8ab5c524c6414ee7b414cebc018..b1956891a8388401c13cd2fc5c78f0779063adf4 100644
>>>> --- a/drivers/gpu/drm/bridge/ite-it6263.c
>>>> +++ b/drivers/gpu/drm/bridge/ite-it6263.c
>>>> @@ -875,6 +875,7 @@ static int it6263_probe(struct i2c_client *client)
>>>>        it->bridge.type = DRM_MODE_CONNECTOR_HDMIA;
>>>>        it->bridge.vendor = "ITE";
>>>>        it->bridge.product = "IT6263";
>>>> +    it->bridge.supported_infoframes = DRM_CONNECTOR_INFOFRAME_AVI;
>>>
>>> With supported_infoframes set, the two lines setting vendor and product
>>> are dead code.  I think it's worth dropping them and updating kerneldoc
>>> for vendor and product members because they don't have to be required if
>>> DRM_BRIDGE_OP_HDMI is set.  But, this could be done with future patch(not
>>> in this patch series).
>>
>> They are still required by the framework itself, see drmm_connector_hdmi_init().
> 
> Yes.  But it's a bit too strict since SPD infoframe is optional according
> to CTA standard documentation.
> 
>>
>> BTW: I don't have ITE datasheet. Do you know if it really supports only the AVI frame?
> 
> AFAICS, it seems that ITE6263 supports inforframes from 0x81 to 0x85, so
> including SPD inforframe.  Maybe, just keep those dead vendor&product
> settings for now and add SPD inforframe in future.

I don't have necessary hardware (nor programming manual). If you can 
extend support for those frames, a patch would be really appreciated.

> 
>>
>>
>>>
>>> Reviewed-by: Liu Ying <victor.liu@nxp.com>
>>>
>>>>          return devm_drm_bridge_add(dev, &it->bridge);
>>>>    }
>>>>
>>>
>>>
>>
>>
> 
> 


-- 
With best wishes
Dmitry

